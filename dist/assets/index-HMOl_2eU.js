(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();function Xi(t){const e=Object.create(null);for(const r of t.split(","))e[r]=1;return r=>r in e}const pt={},xs=[],_r=()=>{},Ca=()=>!1,Wn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Zi=t=>t.startsWith("onUpdate:"),Mt=Object.assign,Qi=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},tc=Object.prototype.hasOwnProperty,at=(t,e)=>tc.call(t,e),$e=Array.isArray,Ss=t=>fn(t)==="[object Map]",Ra=t=>fn(t)==="[object Set]",go=t=>fn(t)==="[object Date]",Ue=t=>typeof t=="function",$t=t=>typeof t=="string",Sr=t=>typeof t=="symbol",ct=t=>t!==null&&typeof t=="object",Oa=t=>(ct(t)||Ue(t))&&Ue(t.then)&&Ue(t.catch),$a=Object.prototype.toString,fn=t=>$a.call(t),rc=t=>fn(t).slice(8,-1),Pa=t=>fn(t)==="[object Object]",Vn=t=>$t(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Ms=Xi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),zn=t=>{const e=Object.create(null);return(r=>e[r]||(e[r]=t(r)))},sc=/-\w/g,zr=zn(t=>t.replace(sc,e=>e.slice(1).toUpperCase())),nc=/\B([A-Z])/g,Gr=zn(t=>t.replace(nc,"-$1").toLowerCase()),Ia=zn(t=>t.charAt(0).toUpperCase()+t.slice(1)),li=zn(t=>t?`on${Ia(t)}`:""),Vr=(t,e)=>!Object.is(t,e),Rn=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},ja=(t,e,r,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:r})},eo=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let yo;const Jn=()=>yo||(yo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Es(t){if($e(t)){const e={};for(let r=0;r<t.length;r++){const s=t[r],n=$t(s)?lc(s):Es(s);if(n)for(const i in n)e[i]=n[i]}return e}else if($t(t)||ct(t))return t}const ic=/;(?![^(]*\))/g,oc=/:([^]+)/,ac=/\/\*[^]*?\*\//g;function lc(t){const e={};return t.replace(ac,"").split(ic).forEach(r=>{if(r){const s=r.split(oc);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Lt(t){let e="";if($t(t))e=t;else if($e(t))for(let r=0;r<t.length;r++){const s=Lt(t[r]);s&&(e+=s+" ")}else if(ct(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}const cc="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",uc=Xi(cc);function Ua(t){return!!t||t===""}function fc(t,e){if(t.length!==e.length)return!1;let r=!0;for(let s=0;r&&s<t.length;s++)r=to(t[s],e[s]);return r}function to(t,e){if(t===e)return!0;let r=go(t),s=go(e);if(r||s)return r&&s?t.getTime()===e.getTime():!1;if(r=Sr(t),s=Sr(e),r||s)return t===e;if(r=$e(t),s=$e(e),r||s)return r&&s?fc(t,e):!1;if(r=ct(t),s=ct(e),r||s){if(!r||!s)return!1;const n=Object.keys(t).length,i=Object.keys(e).length;if(n!==i)return!1;for(const o in t){const l=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(l&&!c||!l&&c||!to(t[o],e[o]))return!1}}return String(t)===String(e)}const Da=t=>!!(t&&t.__v_isRef===!0),et=t=>$t(t)?t:t==null?"":$e(t)||ct(t)&&(t.toString===$a||!Ue(t.toString))?Da(t)?et(t.value):JSON.stringify(t,La,2):String(t),La=(t,e)=>Da(e)?La(t,e.value):Ss(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[s,n],i)=>(r[ci(s,i)+" =>"]=n,r),{})}:Ra(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>ci(r))}:Sr(e)?ci(e):ct(e)&&!$e(e)&&!Pa(e)?String(e):e,ci=(t,e="")=>{var r;return Sr(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};let tr;class dc{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.__v_skip=!0,this.parent=tr,!e&&tr&&(this.index=(tr.scopes||(tr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].pause();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].resume();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].resume()}}run(e){if(this._active){const r=tr;try{return tr=this,e()}finally{tr=r}}}on(){++this._on===1&&(this.prevScope=tr,tr=this)}off(){this._on>0&&--this._on===0&&(tr=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let r,s;for(r=0,s=this.effects.length;r<s;r++)this.effects[r].stop();for(this.effects.length=0,r=0,s=this.cleanups.length;r<s;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,s=this.scopes.length;r<s;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function hc(){return tr}let yt;const ui=new WeakSet;class Na{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,tr&&tr.active&&tr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ui.has(this)&&(ui.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ma(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,vo(this),Fa(this);const e=yt,r=hr;yt=this,hr=!0;try{return this.fn()}finally{Ka(this),yt=e,hr=r,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)no(e);this.deps=this.depsTail=void 0,vo(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ui.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Pi(this)&&this.run()}get dirty(){return Pi(this)}}let Ba=0,Fs,Ks;function Ma(t,e=!1){if(t.flags|=8,e){t.next=Ks,Ks=t;return}t.next=Fs,Fs=t}function ro(){Ba++}function so(){if(--Ba>0)return;if(Ks){let e=Ks;for(Ks=void 0;e;){const r=e.next;e.next=void 0,e.flags&=-9,e=r}}let t;for(;Fs;){let e=Fs;for(Fs=void 0;e;){const r=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=r}}if(t)throw t}function Fa(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Ka(t){let e,r=t.depsTail,s=r;for(;s;){const n=s.prevDep;s.version===-1?(s===r&&(r=n),no(s),pc(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=n}t.deps=e,t.depsTail=r}function Pi(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(qa(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function qa(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Gs)||(t.globalVersion=Gs,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Pi(t))))return;t.flags|=2;const e=t.dep,r=yt,s=hr;yt=t,hr=!0;try{Fa(t);const n=t.fn(t._value);(e.version===0||Vr(n,t._value))&&(t.flags|=128,t._value=n,e.version++)}catch(n){throw e.version++,n}finally{yt=r,hr=s,Ka(t),t.flags&=-3}}function no(t,e=!1){const{dep:r,prevSub:s,nextSub:n}=t;if(s&&(s.nextSub=n,t.prevSub=void 0),n&&(n.prevSub=s,t.nextSub=void 0),r.subs===t&&(r.subs=s,!s&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)no(i,!0)}!e&&!--r.sc&&r.map&&r.map.delete(r.key)}function pc(t){const{prevDep:e,nextDep:r}=t;e&&(e.nextDep=r,t.prevDep=void 0),r&&(r.prevDep=e,t.nextDep=void 0)}let hr=!0;const Ha=[];function Ur(){Ha.push(hr),hr=!1}function Dr(){const t=Ha.pop();hr=t===void 0?!0:t}function vo(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const r=yt;yt=void 0;try{e()}finally{yt=r}}}let Gs=0;class gc{constructor(e,r){this.sub=e,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Gn{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!yt||!hr||yt===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==yt)r=this.activeLink=new gc(yt,this),yt.deps?(r.prevDep=yt.depsTail,yt.depsTail.nextDep=r,yt.depsTail=r):yt.deps=yt.depsTail=r,Wa(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const s=r.nextDep;s.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=s),r.prevDep=yt.depsTail,r.nextDep=void 0,yt.depsTail.nextDep=r,yt.depsTail=r,yt.deps===r&&(yt.deps=s)}return r}trigger(e){this.version++,Gs++,this.notify(e)}notify(e){ro();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{so()}}}function Wa(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)Wa(s)}const r=t.dep.subs;r!==t&&(t.prevSub=r,r&&(r.nextSub=t)),t.dep.subs=t}}const Un=new WeakMap,is=Symbol(""),Ii=Symbol(""),Ys=Symbol("");function Vt(t,e,r){if(hr&&yt){let s=Un.get(t);s||Un.set(t,s=new Map);let n=s.get(r);n||(s.set(r,n=new Gn),n.map=s,n.key=r),n.track()}}function Pr(t,e,r,s,n,i){const o=Un.get(t);if(!o){Gs++;return}const l=c=>{c&&c.trigger()};if(ro(),e==="clear")o.forEach(l);else{const c=$e(t),f=c&&Vn(r);if(c&&r==="length"){const p=Number(s);o.forEach((y,w)=>{(w==="length"||w===Ys||!Sr(w)&&w>=p)&&l(y)})}else switch((r!==void 0||o.has(void 0))&&l(o.get(r)),f&&l(o.get(Ys)),e){case"add":c?f&&l(o.get("length")):(l(o.get(is)),Ss(t)&&l(o.get(Ii)));break;case"delete":c||(l(o.get(is)),Ss(t)&&l(o.get(Ii)));break;case"set":Ss(t)&&l(o.get(is));break}}so()}function yc(t,e){const r=Un.get(t);return r&&r.get(e)}function ls(t){const e=nt(t);return e===t?e:(Vt(e,"iterate",Ys),ar(t)?e:e.map(pr))}function Yn(t){return Vt(t=nt(t),"iterate",Ys),t}function Fr(t,e){return Lr(t)?Os(os(t)?pr(e):e):pr(e)}const vc={__proto__:null,[Symbol.iterator](){return fi(this,Symbol.iterator,t=>Fr(this,t))},concat(...t){return ls(this).concat(...t.map(e=>$e(e)?ls(e):e))},entries(){return fi(this,"entries",t=>(t[1]=Fr(this,t[1]),t))},every(t,e){return Cr(this,"every",t,e,void 0,arguments)},filter(t,e){return Cr(this,"filter",t,e,r=>r.map(s=>Fr(this,s)),arguments)},find(t,e){return Cr(this,"find",t,e,r=>Fr(this,r),arguments)},findIndex(t,e){return Cr(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Cr(this,"findLast",t,e,r=>Fr(this,r),arguments)},findLastIndex(t,e){return Cr(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Cr(this,"forEach",t,e,void 0,arguments)},includes(...t){return di(this,"includes",t)},indexOf(...t){return di(this,"indexOf",t)},join(t){return ls(this).join(t)},lastIndexOf(...t){return di(this,"lastIndexOf",t)},map(t,e){return Cr(this,"map",t,e,void 0,arguments)},pop(){return Us(this,"pop")},push(...t){return Us(this,"push",t)},reduce(t,...e){return bo(this,"reduce",t,e)},reduceRight(t,...e){return bo(this,"reduceRight",t,e)},shift(){return Us(this,"shift")},some(t,e){return Cr(this,"some",t,e,void 0,arguments)},splice(...t){return Us(this,"splice",t)},toReversed(){return ls(this).toReversed()},toSorted(t){return ls(this).toSorted(t)},toSpliced(...t){return ls(this).toSpliced(...t)},unshift(...t){return Us(this,"unshift",t)},values(){return fi(this,"values",t=>Fr(this,t))}};function fi(t,e,r){const s=Yn(t),n=s[e]();return s!==t&&!ar(t)&&(n._next=n.next,n.next=()=>{const i=n._next();return i.done||(i.value=r(i.value)),i}),n}const bc=Array.prototype;function Cr(t,e,r,s,n,i){const o=Yn(t),l=o!==t&&!ar(t),c=o[e];if(c!==bc[e]){const y=c.apply(t,i);return l?pr(y):y}let f=r;o!==t&&(l?f=function(y,w){return r.call(this,Fr(t,y),w,t)}:r.length>2&&(f=function(y,w){return r.call(this,y,w,t)}));const p=c.call(o,f,s);return l&&n?n(p):p}function bo(t,e,r,s){const n=Yn(t);let i=r;return n!==t&&(ar(t)?r.length>3&&(i=function(o,l,c){return r.call(this,o,l,c,t)}):i=function(o,l,c){return r.call(this,o,Fr(t,l),c,t)}),n[e](i,...s)}function di(t,e,r){const s=nt(t);Vt(s,"iterate",Ys);const n=s[e](...r);return(n===-1||n===!1)&&Xn(r[0])?(r[0]=nt(r[0]),s[e](...r)):n}function Us(t,e,r=[]){Ur(),ro();const s=nt(t)[e].apply(t,r);return so(),Dr(),s}const mc=Xi("__proto__,__v_isRef,__isVue"),Va=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Sr));function _c(t){Sr(t)||(t=String(t));const e=nt(this);return Vt(e,"has",t),e.hasOwnProperty(t)}class za{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,s){if(r==="__v_skip")return e.__v_skip;const n=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!n;if(r==="__v_isReadonly")return n;if(r==="__v_isShallow")return i;if(r==="__v_raw")return s===(n?i?Oc:Xa:i?Ya:Ga).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=$e(e);if(!n){let c;if(o&&(c=vc[r]))return c;if(r==="hasOwnProperty")return _c}const l=Reflect.get(e,r,jt(e)?e:s);if((Sr(r)?Va.has(r):mc(r))||(n||Vt(e,"get",r),i))return l;if(jt(l)){const c=o&&Vn(r)?l:l.value;return n&&ct(c)?Xs(c):c}return ct(l)?n?Xs(l):ks(l):l}}class Ja extends za{constructor(e=!1){super(!1,e)}set(e,r,s,n){let i=e[r];const o=$e(e)&&Vn(r);if(!this._isShallow){const f=Lr(i);if(!ar(s)&&!Lr(s)&&(i=nt(i),s=nt(s)),!o&&jt(i)&&!jt(s))return f||(i.value=s),!0}const l=o?Number(r)<e.length:at(e,r),c=Reflect.set(e,r,s,jt(e)?e:n);return e===nt(n)&&(l?Vr(s,i)&&Pr(e,"set",r,s):Pr(e,"add",r,s)),c}deleteProperty(e,r){const s=at(e,r);e[r];const n=Reflect.deleteProperty(e,r);return n&&s&&Pr(e,"delete",r,void 0),n}has(e,r){const s=Reflect.has(e,r);return(!Sr(r)||!Va.has(r))&&Vt(e,"has",r),s}ownKeys(e){return Vt(e,"iterate",$e(e)?"length":is),Reflect.ownKeys(e)}}class wc extends za{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const xc=new Ja,Sc=new wc,Ec=new Ja(!0);const ji=t=>t,yn=t=>Reflect.getPrototypeOf(t);function kc(t,e,r){return function(...s){const n=this.__v_raw,i=nt(n),o=Ss(i),l=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,f=n[t](...s),p=r?ji:e?Os:pr;return!e&&Vt(i,"iterate",c?Ii:is),Mt(Object.create(f),{next(){const{value:y,done:w}=f.next();return w?{value:y,done:w}:{value:l?[p(y[0]),p(y[1])]:p(y),done:w}}})}}function vn(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Tc(t,e){const r={get(n){const i=this.__v_raw,o=nt(i),l=nt(n);t||(Vr(n,l)&&Vt(o,"get",n),Vt(o,"get",l));const{has:c}=yn(o),f=e?ji:t?Os:pr;if(c.call(o,n))return f(i.get(n));if(c.call(o,l))return f(i.get(l));i!==o&&i.get(n)},get size(){const n=this.__v_raw;return!t&&Vt(nt(n),"iterate",is),n.size},has(n){const i=this.__v_raw,o=nt(i),l=nt(n);return t||(Vr(n,l)&&Vt(o,"has",n),Vt(o,"has",l)),n===l?i.has(n):i.has(n)||i.has(l)},forEach(n,i){const o=this,l=o.__v_raw,c=nt(l),f=e?ji:t?Os:pr;return!t&&Vt(c,"iterate",is),l.forEach((p,y)=>n.call(i,f(p),f(y),o))}};return Mt(r,t?{add:vn("add"),set:vn("set"),delete:vn("delete"),clear:vn("clear")}:{add(n){!e&&!ar(n)&&!Lr(n)&&(n=nt(n));const i=nt(this);return yn(i).has.call(i,n)||(i.add(n),Pr(i,"add",n,n)),this},set(n,i){!e&&!ar(i)&&!Lr(i)&&(i=nt(i));const o=nt(this),{has:l,get:c}=yn(o);let f=l.call(o,n);f||(n=nt(n),f=l.call(o,n));const p=c.call(o,n);return o.set(n,i),f?Vr(i,p)&&Pr(o,"set",n,i):Pr(o,"add",n,i),this},delete(n){const i=nt(this),{has:o,get:l}=yn(i);let c=o.call(i,n);c||(n=nt(n),c=o.call(i,n)),l&&l.call(i,n);const f=i.delete(n);return c&&Pr(i,"delete",n,void 0),f},clear(){const n=nt(this),i=n.size!==0,o=n.clear();return i&&Pr(n,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(n=>{r[n]=kc(n,t,e)}),r}function io(t,e){const r=Tc(t,e);return(s,n,i)=>n==="__v_isReactive"?!t:n==="__v_isReadonly"?t:n==="__v_raw"?s:Reflect.get(at(r,n)&&n in s?r:s,n,i)}const Ac={get:io(!1,!1)},Cc={get:io(!1,!0)},Rc={get:io(!0,!1)};const Ga=new WeakMap,Ya=new WeakMap,Xa=new WeakMap,Oc=new WeakMap;function $c(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Pc(t){return t.__v_skip||!Object.isExtensible(t)?0:$c(rc(t))}function ks(t){return Lr(t)?t:oo(t,!1,xc,Ac,Ga)}function Ic(t){return oo(t,!1,Ec,Cc,Ya)}function Xs(t){return oo(t,!0,Sc,Rc,Xa)}function oo(t,e,r,s,n){if(!ct(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=Pc(t);if(i===0)return t;const o=n.get(t);if(o)return o;const l=new Proxy(t,i===2?s:r);return n.set(t,l),l}function os(t){return Lr(t)?os(t.__v_raw):!!(t&&t.__v_isReactive)}function Lr(t){return!!(t&&t.__v_isReadonly)}function ar(t){return!!(t&&t.__v_isShallow)}function Xn(t){return t?!!t.__v_raw:!1}function nt(t){const e=t&&t.__v_raw;return e?nt(e):t}function jc(t){return!at(t,"__v_skip")&&Object.isExtensible(t)&&ja(t,"__v_skip",!0),t}const pr=t=>ct(t)?ks(t):t,Os=t=>ct(t)?Xs(t):t;function jt(t){return t?t.__v_isRef===!0:!1}function tt(t){return Za(t,!1)}function Uc(t){return Za(t,!0)}function Za(t,e){return jt(t)?t:new Dc(t,e)}class Dc{constructor(e,r){this.dep=new Gn,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?e:nt(e),this._value=r?e:pr(e),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(e){const r=this._rawValue,s=this.__v_isShallow||ar(e)||Lr(e);e=s?e:nt(e),Vr(e,r)&&(this._rawValue=e,this._value=s?e:pr(e),this.dep.trigger())}}function ee(t){return jt(t)?t.value:t}function Ts(t){return Ue(t)?t():ee(t)}const Lc={get:(t,e,r)=>e==="__v_raw"?t:ee(Reflect.get(t,e,r)),set:(t,e,r,s)=>{const n=t[e];return jt(n)&&!jt(r)?(n.value=r,!0):Reflect.set(t,e,r,s)}};function Qa(t){return os(t)?t:new Proxy(t,Lc)}class Nc{constructor(e){this.__v_isRef=!0,this._value=void 0;const r=this.dep=new Gn,{get:s,set:n}=e(r.track.bind(r),r.trigger.bind(r));this._get=s,this._set=n}get value(){return this._value=this._get()}set value(e){this._set(e)}}function Bc(t){return new Nc(t)}class Mc{constructor(e,r,s){this._object=e,this._key=r,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0,this._raw=nt(e);let n=!0,i=e;if(!$e(e)||!Vn(String(r)))do n=!Xn(i)||ar(i);while(n&&(i=i.__v_raw));this._shallow=n}get value(){let e=this._object[this._key];return this._shallow&&(e=ee(e)),this._value=e===void 0?this._defaultValue:e}set value(e){if(this._shallow&&jt(this._raw[this._key])){const r=this._object[this._key];if(jt(r)){r.value=e;return}}this._object[this._key]=e}get dep(){return yc(this._raw,this._key)}}class Fc{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Kc(t,e,r){return jt(t)?t:Ue(t)?new Fc(t):ct(t)&&arguments.length>1?qc(t,e,r):tt(t)}function qc(t,e,r){return new Mc(t,e,r)}class Hc{constructor(e,r,s){this.fn=e,this.setter=r,this._value=void 0,this.dep=new Gn(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Gs-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&yt!==this)return Ma(this,!0),!0}get value(){const e=this.dep.track();return qa(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Wc(t,e,r=!1){let s,n;return Ue(t)?s=t:(s=t.get,n=t.set),new Hc(s,n,r)}const bn={},Dn=new WeakMap;let es;function Vc(t,e=!1,r=es){if(r){let s=Dn.get(r);s||Dn.set(r,s=[]),s.push(t)}}function zc(t,e,r=pt){const{immediate:s,deep:n,once:i,scheduler:o,augmentJob:l,call:c}=r,f=M=>n?M:ar(M)||n===!1||n===0?Ir(M,1):Ir(M);let p,y,w,_,C=!1,O=!1;if(jt(t)?(y=()=>t.value,C=ar(t)):os(t)?(y=()=>f(t),C=!0):$e(t)?(O=!0,C=t.some(M=>os(M)||ar(M)),y=()=>t.map(M=>{if(jt(M))return M.value;if(os(M))return f(M);if(Ue(M))return c?c(M,2):M()})):Ue(t)?e?y=c?()=>c(t,2):t:y=()=>{if(w){Ur();try{w()}finally{Dr()}}const M=es;es=p;try{return c?c(t,3,[_]):t(_)}finally{es=M}}:y=_r,e&&n){const M=y,me=n===!0?1/0:n;y=()=>Ir(M(),me)}const U=hc(),N=()=>{p.stop(),U&&U.active&&Qi(U.effects,p)};if(i&&e){const M=e;e=(...me)=>{M(...me),N()}}let H=O?new Array(t.length).fill(bn):bn;const B=M=>{if(!(!(p.flags&1)||!p.dirty&&!M))if(e){const me=p.run();if(n||C||(O?me.some((ge,Te)=>Vr(ge,H[Te])):Vr(me,H))){w&&w();const ge=es;es=p;try{const Te=[me,H===bn?void 0:O&&H[0]===bn?[]:H,_];H=me,c?c(e,3,Te):e(...Te)}finally{es=ge}}}else p.run()};return l&&l(B),p=new Na(y),p.scheduler=o?()=>o(B,!1):B,_=M=>Vc(M,!1,p),w=p.onStop=()=>{const M=Dn.get(p);if(M){if(c)c(M,4);else for(const me of M)me();Dn.delete(p)}},e?s?B(!0):H=p.run():o?o(B.bind(null,!0),!0):p.run(),N.pause=p.pause.bind(p),N.resume=p.resume.bind(p),N.stop=N,N}function Ir(t,e=1/0,r){if(e<=0||!ct(t)||t.__v_skip||(r=r||new Map,(r.get(t)||0)>=e))return t;if(r.set(t,e),e--,jt(t))Ir(t.value,e,r);else if($e(t))for(let s=0;s<t.length;s++)Ir(t[s],e,r);else if(Ra(t)||Ss(t))t.forEach(s=>{Ir(s,e,r)});else if(Pa(t)){for(const s in t)Ir(t[s],e,r);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Ir(t[s],e,r)}return t}function dn(t,e,r,s){try{return s?t(...s):t()}catch(n){Zn(n,e,r)}}function Er(t,e,r,s){if(Ue(t)){const n=dn(t,e,r,s);return n&&Oa(n)&&n.catch(i=>{Zn(i,e,r)}),n}if($e(t)){const n=[];for(let i=0;i<t.length;i++)n.push(Er(t[i],e,r,s));return n}}function Zn(t,e,r,s=!0){const n=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||pt;if(e){let l=e.parent;const c=e.proxy,f=`https://vuejs.org/error-reference/#runtime-${r}`;for(;l;){const p=l.ec;if(p){for(let y=0;y<p.length;y++)if(p[y](t,c,f)===!1)return}l=l.parent}if(i){Ur(),dn(i,null,10,[t,c,f]),Dr();return}}Jc(t,r,n,s,o)}function Jc(t,e,r,s=!0,n=!1){if(n)throw t;console.error(t)}const Xt=[];let vr=-1;const As=[];let Kr=null,gs=0;const el=Promise.resolve();let Ln=null;function Qn(t){const e=Ln||el;return t?e.then(this?t.bind(this):t):e}function Gc(t){let e=vr+1,r=Xt.length;for(;e<r;){const s=e+r>>>1,n=Xt[s],i=Zs(n);i<t||i===t&&n.flags&2?e=s+1:r=s}return e}function ao(t){if(!(t.flags&1)){const e=Zs(t),r=Xt[Xt.length-1];!r||!(t.flags&2)&&e>=Zs(r)?Xt.push(t):Xt.splice(Gc(e),0,t),t.flags|=1,tl()}}function tl(){Ln||(Ln=el.then(sl))}function Yc(t){$e(t)?As.push(...t):Kr&&t.id===-1?Kr.splice(gs+1,0,t):t.flags&1||(As.push(t),t.flags|=1),tl()}function mo(t,e,r=vr+1){for(;r<Xt.length;r++){const s=Xt[r];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;Xt.splice(r,1),r--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function rl(t){if(As.length){const e=[...new Set(As)].sort((r,s)=>Zs(r)-Zs(s));if(As.length=0,Kr){Kr.push(...e);return}for(Kr=e,gs=0;gs<Kr.length;gs++){const r=Kr[gs];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}Kr=null,gs=0}}const Zs=t=>t.id==null?t.flags&2?-1:1/0:t.id;function sl(t){try{for(vr=0;vr<Xt.length;vr++){const e=Xt[vr];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),dn(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;vr<Xt.length;vr++){const e=Xt[vr];e&&(e.flags&=-2)}vr=-1,Xt.length=0,rl(),Ln=null,(Xt.length||As.length)&&sl()}}let cr=null,nl=null;function Nn(t){const e=cr;return cr=t,nl=t&&t.type.__scopeId||null,e}function Xc(t,e=cr,r){if(!e||t._n)return t;const s=(...n)=>{s._d&&Oo(-1);const i=Nn(e);let o;try{o=t(...n)}finally{Nn(i),s._d&&Oo(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function hi(t,e){if(cr===null)return t;const r=si(cr),s=t.dirs||(t.dirs=[]);for(let n=0;n<e.length;n++){let[i,o,l,c=pt]=e[n];i&&(Ue(i)&&(i={mounted:i,updated:i}),i.deep&&Ir(o),s.push({dir:i,instance:r,value:o,oldValue:void 0,arg:l,modifiers:c}))}return t}function Yr(t,e,r,s){const n=t.dirs,i=e&&e.dirs;for(let o=0;o<n.length;o++){const l=n[o];i&&(l.oldValue=i[o].value);let c=l.dir[s];c&&(Ur(),Er(c,r,8,[t.el,l,t,e]),Dr())}}function Zc(t,e){if(Zt){let r=Zt.provides;const s=Zt.parent&&Zt.parent.provides;s===r&&(r=Zt.provides=Object.create(s)),r[t]=e}}function On(t,e,r=!1){const s=jl();if(s||Cs){let n=Cs?Cs._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(n&&t in n)return n[t];if(arguments.length>1)return r&&Ue(e)?e.call(s&&s.proxy):e}}const Qc=Symbol.for("v-scx"),eu=()=>On(Qc);function jr(t,e,r){return il(t,e,r)}function il(t,e,r=pt){const{immediate:s,deep:n,flush:i,once:o}=r,l=Mt({},r),c=e&&s||!e&&i!=="post";let f;if(tn){if(i==="sync"){const _=eu();f=_.__watcherHandles||(_.__watcherHandles=[])}else if(!c){const _=()=>{};return _.stop=_r,_.resume=_r,_.pause=_r,_}}const p=Zt;l.call=(_,C,O)=>Er(_,p,C,O);let y=!1;i==="post"?l.scheduler=_=>{er(_,p&&p.suspense)}:i!=="sync"&&(y=!0,l.scheduler=(_,C)=>{C?_():ao(_)}),l.augmentJob=_=>{e&&(_.flags|=4),y&&(_.flags|=2,p&&(_.id=p.uid,_.i=p))};const w=zc(t,e,l);return tn&&(f?f.push(w):c&&w()),w}function tu(t,e,r){const s=this.proxy,n=$t(t)?t.includes(".")?ol(s,t):()=>s[t]:t.bind(s,s);let i;Ue(e)?i=e:(i=e.handler,r=e);const o=hn(this),l=il(n,i.bind(s),r);return o(),l}function ol(t,e){const r=e.split(".");return()=>{let s=t;for(let n=0;n<r.length&&s;n++)s=s[r[n]];return s}}const ru=Symbol("_vte"),su=t=>t.__isTeleport,nu=Symbol("_leaveCb");function lo(t,e){t.shapeFlag&6&&t.component?(t.transition=e,lo(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function al(t,e){return Ue(t)?Mt({name:t.name},e,{setup:t}):t}function ll(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function _o(t,e){let r;return!!((r=Object.getOwnPropertyDescriptor(t,e))&&!r.configurable)}const Bn=new WeakMap;function qs(t,e,r,s,n=!1){if($e(t)){t.forEach((O,U)=>qs(O,e&&($e(e)?e[U]:e),r,s,n));return}if(Hs(s)&&!n){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&qs(t,e,r,s.component.subTree);return}const i=s.shapeFlag&4?si(s.component):s.el,o=n?null:i,{i:l,r:c}=t,f=e&&e.r,p=l.refs===pt?l.refs={}:l.refs,y=l.setupState,w=nt(y),_=y===pt?Ca:O=>_o(p,O)?!1:at(w,O),C=(O,U)=>!(U&&_o(p,U));if(f!=null&&f!==c){if(wo(e),$t(f))p[f]=null,_(f)&&(y[f]=null);else if(jt(f)){const O=e;C(f,O.k)&&(f.value=null),O.k&&(p[O.k]=null)}}if(Ue(c))dn(c,l,12,[o,p]);else{const O=$t(c),U=jt(c);if(O||U){const N=()=>{if(t.f){const H=O?_(c)?y[c]:p[c]:C()||!t.k?c.value:p[t.k];if(n)$e(H)&&Qi(H,i);else if($e(H))H.includes(i)||H.push(i);else if(O)p[c]=[i],_(c)&&(y[c]=p[c]);else{const B=[i];C(c,t.k)&&(c.value=B),t.k&&(p[t.k]=B)}}else O?(p[c]=o,_(c)&&(y[c]=o)):U&&(C(c,t.k)&&(c.value=o),t.k&&(p[t.k]=o))};if(o){const H=()=>{N(),Bn.delete(t)};H.id=-1,Bn.set(t,H),er(H,r)}else wo(t),N()}}}function wo(t){const e=Bn.get(t);e&&(e.flags|=8,Bn.delete(t))}Jn().requestIdleCallback;Jn().cancelIdleCallback;const Hs=t=>!!t.type.__asyncLoader,cl=t=>t.type.__isKeepAlive;function iu(t,e){ul(t,"a",e)}function ou(t,e){ul(t,"da",e)}function ul(t,e,r=Zt){const s=t.__wdc||(t.__wdc=()=>{let n=r;for(;n;){if(n.isDeactivated)return;n=n.parent}return t()});if(ei(e,s,r),r){let n=r.parent;for(;n&&n.parent;)cl(n.parent.vnode)&&au(s,e,r,n),n=n.parent}}function au(t,e,r,s){const n=ei(e,t,s,!0);hl(()=>{Qi(s[e],n)},r)}function ei(t,e,r=Zt,s=!1){if(r){const n=r[t]||(r[t]=[]),i=e.__weh||(e.__weh=(...o)=>{Ur();const l=hn(r),c=Er(e,r,t,o);return l(),Dr(),c});return s?n.unshift(i):n.push(i),i}}const Nr=t=>(e,r=Zt)=>{(!tn||t==="sp")&&ei(t,(...s)=>e(...s),r)},lu=Nr("bm"),fl=Nr("m"),cu=Nr("bu"),uu=Nr("u"),dl=Nr("bum"),hl=Nr("um"),fu=Nr("sp"),du=Nr("rtg"),hu=Nr("rtc");function pu(t,e=Zt){ei("ec",t,e)}const gu=Symbol.for("v-ndc");function qr(t,e,r,s){let n;const i=r,o=$e(t);if(o||$t(t)){const l=o&&os(t);let c=!1,f=!1;l&&(c=!ar(t),f=Lr(t),t=Yn(t)),n=new Array(t.length);for(let p=0,y=t.length;p<y;p++)n[p]=e(c?f?Os(pr(t[p])):pr(t[p]):t[p],p,void 0,i)}else if(typeof t=="number"){n=new Array(t);for(let l=0;l<t;l++)n[l]=e(l+1,l,void 0,i)}else if(ct(t))if(t[Symbol.iterator])n=Array.from(t,(l,c)=>e(l,c,void 0,i));else{const l=Object.keys(t);n=new Array(l.length);for(let c=0,f=l.length;c<f;c++){const p=l[c];n[c]=e(t[p],p,c,i)}}else n=[];return n}const Ui=t=>t?Ul(t)?si(t):Ui(t.parent):null,Ws=Mt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ui(t.parent),$root:t=>Ui(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>gl(t),$forceUpdate:t=>t.f||(t.f=()=>{ao(t.update)}),$nextTick:t=>t.n||(t.n=Qn.bind(t.proxy)),$watch:t=>tu.bind(t)}),pi=(t,e)=>t!==pt&&!t.__isScriptSetup&&at(t,e),yu={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:s,data:n,props:i,accessCache:o,type:l,appContext:c}=t;if(e[0]!=="$"){const w=o[e];if(w!==void 0)switch(w){case 1:return s[e];case 2:return n[e];case 4:return r[e];case 3:return i[e]}else{if(pi(s,e))return o[e]=1,s[e];if(n!==pt&&at(n,e))return o[e]=2,n[e];if(at(i,e))return o[e]=3,i[e];if(r!==pt&&at(r,e))return o[e]=4,r[e];Di&&(o[e]=0)}}const f=Ws[e];let p,y;if(f)return e==="$attrs"&&Vt(t.attrs,"get",""),f(t);if((p=l.__cssModules)&&(p=p[e]))return p;if(r!==pt&&at(r,e))return o[e]=4,r[e];if(y=c.config.globalProperties,at(y,e))return y[e]},set({_:t},e,r){const{data:s,setupState:n,ctx:i}=t;return pi(n,e)?(n[e]=r,!0):s!==pt&&at(s,e)?(s[e]=r,!0):at(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:s,appContext:n,props:i,type:o}},l){let c;return!!(r[l]||t!==pt&&l[0]!=="$"&&at(t,l)||pi(e,l)||at(i,l)||at(s,l)||at(Ws,l)||at(n.config.globalProperties,l)||(c=o.__cssModules)&&c[l])},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:at(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}};function xo(t){return $e(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}let Di=!0;function vu(t){const e=gl(t),r=t.proxy,s=t.ctx;Di=!1,e.beforeCreate&&So(e.beforeCreate,t,"bc");const{data:n,computed:i,methods:o,watch:l,provide:c,inject:f,created:p,beforeMount:y,mounted:w,beforeUpdate:_,updated:C,activated:O,deactivated:U,beforeDestroy:N,beforeUnmount:H,destroyed:B,unmounted:M,render:me,renderTracked:ge,renderTriggered:Te,errorCaptured:it,serverPrefetch:ot,expose:At,inheritAttrs:vt,components:ut,directives:zt,filters:_e}=e;if(f&&bu(f,s,null),o)for(const ne in o){const re=o[ne];Ue(re)&&(s[ne]=re.bind(r))}if(n){const ne=n.call(r,r);ct(ne)&&(t.data=ks(ne))}if(Di=!0,i)for(const ne in i){const re=i[ne],Ie=Ue(re)?re.bind(r,r):Ue(re.get)?re.get.bind(r,r):_r,qe=!Ue(re)&&Ue(re.set)?re.set.bind(r):_r,ft=mr({get:Ie,set:qe});Object.defineProperty(s,ne,{enumerable:!0,configurable:!0,get:()=>ft.value,set:ze=>ft.value=ze})}if(l)for(const ne in l)pl(l[ne],s,r,ne);if(c){const ne=Ue(c)?c.call(r):c;Reflect.ownKeys(ne).forEach(re=>{Zc(re,ne[re])})}p&&So(p,t,"c");function Se(ne,re){$e(re)?re.forEach(Ie=>ne(Ie.bind(r))):re&&ne(re.bind(r))}if(Se(lu,y),Se(fl,w),Se(cu,_),Se(uu,C),Se(iu,O),Se(ou,U),Se(pu,it),Se(hu,ge),Se(du,Te),Se(dl,H),Se(hl,M),Se(fu,ot),$e(At))if(At.length){const ne=t.exposed||(t.exposed={});At.forEach(re=>{Object.defineProperty(ne,re,{get:()=>r[re],set:Ie=>r[re]=Ie,enumerable:!0})})}else t.exposed||(t.exposed={});me&&t.render===_r&&(t.render=me),vt!=null&&(t.inheritAttrs=vt),ut&&(t.components=ut),zt&&(t.directives=zt),ot&&ll(t)}function bu(t,e,r=_r){$e(t)&&(t=Li(t));for(const s in t){const n=t[s];let i;ct(n)?"default"in n?i=On(n.from||s,n.default,!0):i=On(n.from||s):i=On(n),jt(i)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function So(t,e,r){Er($e(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,r)}function pl(t,e,r,s){let n=s.includes(".")?ol(r,s):()=>r[s];if($t(t)){const i=e[t];Ue(i)&&jr(n,i)}else if(Ue(t))jr(n,t.bind(r));else if(ct(t))if($e(t))t.forEach(i=>pl(i,e,r,s));else{const i=Ue(t.handler)?t.handler.bind(r):e[t.handler];Ue(i)&&jr(n,i,t)}}function gl(t){const e=t.type,{mixins:r,extends:s}=e,{mixins:n,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,l=i.get(e);let c;return l?c=l:!n.length&&!r&&!s?c=e:(c={},n.length&&n.forEach(f=>Mn(c,f,o,!0)),Mn(c,e,o)),ct(e)&&i.set(e,c),c}function Mn(t,e,r,s=!1){const{mixins:n,extends:i}=e;i&&Mn(t,i,r,!0),n&&n.forEach(o=>Mn(t,o,r,!0));for(const o in e)if(!(s&&o==="expose")){const l=mu[o]||r&&r[o];t[o]=l?l(t[o],e[o]):e[o]}return t}const mu={data:Eo,props:ko,emits:ko,methods:Ns,computed:Ns,beforeCreate:Yt,created:Yt,beforeMount:Yt,mounted:Yt,beforeUpdate:Yt,updated:Yt,beforeDestroy:Yt,beforeUnmount:Yt,destroyed:Yt,unmounted:Yt,activated:Yt,deactivated:Yt,errorCaptured:Yt,serverPrefetch:Yt,components:Ns,directives:Ns,watch:wu,provide:Eo,inject:_u};function Eo(t,e){return e?t?function(){return Mt(Ue(t)?t.call(this,this):t,Ue(e)?e.call(this,this):e)}:e:t}function _u(t,e){return Ns(Li(t),Li(e))}function Li(t){if($e(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function Yt(t,e){return t?[...new Set([].concat(t,e))]:e}function Ns(t,e){return t?Mt(Object.create(null),t,e):e}function ko(t,e){return t?$e(t)&&$e(e)?[...new Set([...t,...e])]:Mt(Object.create(null),xo(t),xo(e??{})):e}function wu(t,e){if(!t)return e;if(!e)return t;const r=Mt(Object.create(null),t);for(const s in e)r[s]=Yt(t[s],e[s]);return r}function yl(){return{app:null,config:{isNativeTag:Ca,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let xu=0;function Su(t,e){return function(s,n=null){Ue(s)||(s=Mt({},s)),n!=null&&!ct(n)&&(n=null);const i=yl(),o=new WeakSet,l=[];let c=!1;const f=i.app={_uid:xu++,_component:s,_props:n,_container:null,_context:i,_instance:null,version:tf,get config(){return i.config},set config(p){},use(p,...y){return o.has(p)||(p&&Ue(p.install)?(o.add(p),p.install(f,...y)):Ue(p)&&(o.add(p),p(f,...y))),f},mixin(p){return i.mixins.includes(p)||i.mixins.push(p),f},component(p,y){return y?(i.components[p]=y,f):i.components[p]},directive(p,y){return y?(i.directives[p]=y,f):i.directives[p]},mount(p,y,w){if(!c){const _=f._ceVNode||wr(s,n);return _.appContext=i,w===!0?w="svg":w===!1&&(w=void 0),t(_,p,w),c=!0,f._container=p,p.__vue_app__=f,si(_.component)}},onUnmount(p){l.push(p)},unmount(){c&&(Er(l,f._instance,16),t(null,f._container),delete f._container.__vue_app__)},provide(p,y){return i.provides[p]=y,f},runWithContext(p){const y=Cs;Cs=f;try{return p()}finally{Cs=y}}};return f}}let Cs=null;const Eu=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${zr(e)}Modifiers`]||t[`${Gr(e)}Modifiers`];function ku(t,e,...r){if(t.isUnmounted)return;const s=t.vnode.props||pt;let n=r;const i=e.startsWith("update:"),o=i&&Eu(s,e.slice(7));o&&(o.trim&&(n=r.map(p=>$t(p)?p.trim():p)),o.number&&(n=r.map(eo)));let l,c=s[l=li(e)]||s[l=li(zr(e))];!c&&i&&(c=s[l=li(Gr(e))]),c&&Er(c,t,6,n);const f=s[l+"Once"];if(f){if(!t.emitted)t.emitted={};else if(t.emitted[l])return;t.emitted[l]=!0,Er(f,t,6,n)}}const Tu=new WeakMap;function vl(t,e,r=!1){const s=r?Tu:e.emitsCache,n=s.get(t);if(n!==void 0)return n;const i=t.emits;let o={},l=!1;if(!Ue(t)){const c=f=>{const p=vl(f,e,!0);p&&(l=!0,Mt(o,p))};!r&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!l?(ct(t)&&s.set(t,null),null):($e(i)?i.forEach(c=>o[c]=null):Mt(o,i),ct(t)&&s.set(t,o),o)}function ti(t,e){return!t||!Wn(e)?!1:(e=e.slice(2).replace(/Once$/,""),at(t,e[0].toLowerCase()+e.slice(1))||at(t,Gr(e))||at(t,e))}function To(t){const{type:e,vnode:r,proxy:s,withProxy:n,propsOptions:[i],slots:o,attrs:l,emit:c,render:f,renderCache:p,props:y,data:w,setupState:_,ctx:C,inheritAttrs:O}=t,U=Nn(t);let N,H;try{if(r.shapeFlag&4){const M=n||s,me=M;N=br(f.call(me,M,p,y,_,w,C)),H=l}else{const M=e;N=br(M.length>1?M(y,{attrs:l,slots:o,emit:c}):M(y,null)),H=e.props?l:Au(l)}}catch(M){Vs.length=0,Zn(M,t,1),N=wr(Jr)}let B=N;if(H&&O!==!1){const M=Object.keys(H),{shapeFlag:me}=B;M.length&&me&7&&(i&&M.some(Zi)&&(H=Cu(H,i)),B=$s(B,H,!1,!0))}return r.dirs&&(B=$s(B,null,!1,!0),B.dirs=B.dirs?B.dirs.concat(r.dirs):r.dirs),r.transition&&lo(B,r.transition),N=B,Nn(U),N}const Au=t=>{let e;for(const r in t)(r==="class"||r==="style"||Wn(r))&&((e||(e={}))[r]=t[r]);return e},Cu=(t,e)=>{const r={};for(const s in t)(!Zi(s)||!(s.slice(9)in e))&&(r[s]=t[s]);return r};function Ru(t,e,r){const{props:s,children:n,component:i}=t,{props:o,children:l,patchFlag:c}=e,f=i.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&c>=0){if(c&1024)return!0;if(c&16)return s?Ao(s,o,f):!!o;if(c&8){const p=e.dynamicProps;for(let y=0;y<p.length;y++){const w=p[y];if(bl(o,s,w)&&!ti(f,w))return!0}}}else return(n||l)&&(!l||!l.$stable)?!0:s===o?!1:s?o?Ao(s,o,f):!0:!!o;return!1}function Ao(t,e,r){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let n=0;n<s.length;n++){const i=s[n];if(bl(e,t,i)&&!ti(r,i))return!0}return!1}function bl(t,e,r){const s=t[r],n=e[r];return r==="style"&&ct(s)&&ct(n)?!to(s,n):s!==n}function Ou({vnode:t,parent:e},r){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=r,e=e.parent;else break}}const ml={},_l=()=>Object.create(ml),wl=t=>Object.getPrototypeOf(t)===ml;function $u(t,e,r,s=!1){const n={},i=_l();t.propsDefaults=Object.create(null),xl(t,e,n,i);for(const o in t.propsOptions[0])o in n||(n[o]=void 0);r?t.props=s?n:Ic(n):t.type.props?t.props=n:t.props=i,t.attrs=i}function Pu(t,e,r,s){const{props:n,attrs:i,vnode:{patchFlag:o}}=t,l=nt(n),[c]=t.propsOptions;let f=!1;if((s||o>0)&&!(o&16)){if(o&8){const p=t.vnode.dynamicProps;for(let y=0;y<p.length;y++){let w=p[y];if(ti(t.emitsOptions,w))continue;const _=e[w];if(c)if(at(i,w))_!==i[w]&&(i[w]=_,f=!0);else{const C=zr(w);n[C]=Ni(c,l,C,_,t,!1)}else _!==i[w]&&(i[w]=_,f=!0)}}}else{xl(t,e,n,i)&&(f=!0);let p;for(const y in l)(!e||!at(e,y)&&((p=Gr(y))===y||!at(e,p)))&&(c?r&&(r[y]!==void 0||r[p]!==void 0)&&(n[y]=Ni(c,l,y,void 0,t,!0)):delete n[y]);if(i!==l)for(const y in i)(!e||!at(e,y))&&(delete i[y],f=!0)}f&&Pr(t.attrs,"set","")}function xl(t,e,r,s){const[n,i]=t.propsOptions;let o=!1,l;if(e)for(let c in e){if(Ms(c))continue;const f=e[c];let p;n&&at(n,p=zr(c))?!i||!i.includes(p)?r[p]=f:(l||(l={}))[p]=f:ti(t.emitsOptions,c)||(!(c in s)||f!==s[c])&&(s[c]=f,o=!0)}if(i){const c=nt(r),f=l||pt;for(let p=0;p<i.length;p++){const y=i[p];r[y]=Ni(n,c,y,f[y],t,!at(f,y))}}return o}function Ni(t,e,r,s,n,i){const o=t[r];if(o!=null){const l=at(o,"default");if(l&&s===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&Ue(c)){const{propsDefaults:f}=n;if(r in f)s=f[r];else{const p=hn(n);s=f[r]=c.call(null,e),p()}}else s=c;n.ce&&n.ce._setProp(r,s)}o[0]&&(i&&!l?s=!1:o[1]&&(s===""||s===Gr(r))&&(s=!0))}return s}const Iu=new WeakMap;function Sl(t,e,r=!1){const s=r?Iu:e.propsCache,n=s.get(t);if(n)return n;const i=t.props,o={},l=[];let c=!1;if(!Ue(t)){const p=y=>{c=!0;const[w,_]=Sl(y,e,!0);Mt(o,w),_&&l.push(..._)};!r&&e.mixins.length&&e.mixins.forEach(p),t.extends&&p(t.extends),t.mixins&&t.mixins.forEach(p)}if(!i&&!c)return ct(t)&&s.set(t,xs),xs;if($e(i))for(let p=0;p<i.length;p++){const y=zr(i[p]);Co(y)&&(o[y]=pt)}else if(i)for(const p in i){const y=zr(p);if(Co(y)){const w=i[p],_=o[y]=$e(w)||Ue(w)?{type:w}:Mt({},w),C=_.type;let O=!1,U=!0;if($e(C))for(let N=0;N<C.length;++N){const H=C[N],B=Ue(H)&&H.name;if(B==="Boolean"){O=!0;break}else B==="String"&&(U=!1)}else O=Ue(C)&&C.name==="Boolean";_[0]=O,_[1]=U,(O||at(_,"default"))&&l.push(y)}}const f=[o,l];return ct(t)&&s.set(t,f),f}function Co(t){return t[0]!=="$"&&!Ms(t)}const co=t=>t==="_"||t==="_ctx"||t==="$stable",uo=t=>$e(t)?t.map(br):[br(t)],ju=(t,e,r)=>{if(e._n)return e;const s=Xc((...n)=>uo(e(...n)),r);return s._c=!1,s},El=(t,e,r)=>{const s=t._ctx;for(const n in t){if(co(n))continue;const i=t[n];if(Ue(i))e[n]=ju(n,i,s);else if(i!=null){const o=uo(i);e[n]=()=>o}}},kl=(t,e)=>{const r=uo(e);t.slots.default=()=>r},Tl=(t,e,r)=>{for(const s in e)(r||!co(s))&&(t[s]=e[s])},Uu=(t,e,r)=>{const s=t.slots=_l();if(t.vnode.shapeFlag&32){const n=e._;n?(Tl(s,e,r),r&&ja(s,"_",n,!0)):El(e,s)}else e&&kl(t,e)},Du=(t,e,r)=>{const{vnode:s,slots:n}=t;let i=!0,o=pt;if(s.shapeFlag&32){const l=e._;l?r&&l===1?i=!1:Tl(n,e,r):(i=!e.$stable,El(e,n)),o=e}else e&&(kl(t,e),o={default:1});if(i)for(const l in n)!co(l)&&o[l]==null&&delete n[l]},er=Fu;function Lu(t){return Nu(t)}function Nu(t,e){const r=Jn();r.__VUE__=!0;const{insert:s,remove:n,patchProp:i,createElement:o,createText:l,createComment:c,setText:f,setElementText:p,parentNode:y,nextSibling:w,setScopeId:_=_r,insertStaticContent:C}=t,O=(b,S,I,W=null,F=null,E=null,Z=void 0,G=null,J=!!S.dynamicChildren)=>{if(b===S)return;b&&!Ds(b,S)&&(W=mt(b),ze(b,F,E,!0),b=null),S.patchFlag===-2&&(J=!1,S.dynamicChildren=null);const{type:K,ref:he,shapeFlag:Q}=S;switch(K){case ri:U(b,S,I,W);break;case Jr:N(b,S,I,W);break;case yi:b==null&&H(S,I,W,Z);break;case ht:ut(b,S,I,W,F,E,Z,G,J);break;default:Q&1?me(b,S,I,W,F,E,Z,G,J):Q&6?zt(b,S,I,W,F,E,Z,G,J):(Q&64||Q&128)&&K.process(b,S,I,W,F,E,Z,G,J,_t)}he!=null&&F?qs(he,b&&b.ref,E,S||b,!S):he==null&&b&&b.ref!=null&&qs(b.ref,null,E,b,!0)},U=(b,S,I,W)=>{if(b==null)s(S.el=l(S.children),I,W);else{const F=S.el=b.el;S.children!==b.children&&f(F,S.children)}},N=(b,S,I,W)=>{b==null?s(S.el=c(S.children||""),I,W):S.el=b.el},H=(b,S,I,W)=>{[b.el,b.anchor]=C(b.children,S,I,W,b.el,b.anchor)},B=({el:b,anchor:S},I,W)=>{let F;for(;b&&b!==S;)F=w(b),s(b,I,W),b=F;s(S,I,W)},M=({el:b,anchor:S})=>{let I;for(;b&&b!==S;)I=w(b),n(b),b=I;n(S)},me=(b,S,I,W,F,E,Z,G,J)=>{if(S.type==="svg"?Z="svg":S.type==="math"&&(Z="mathml"),b==null)ge(S,I,W,F,E,Z,G,J);else{const K=b.el&&b.el._isVueCE?b.el:null;try{K&&K._beginPatch(),ot(b,S,F,E,Z,G,J)}finally{K&&K._endPatch()}}},ge=(b,S,I,W,F,E,Z,G)=>{let J,K;const{props:he,shapeFlag:Q,transition:fe,dirs:ve}=b;if(J=b.el=o(b.type,E,he&&he.is,he),Q&8?p(J,b.children):Q&16&&it(b.children,J,null,W,F,gi(b,E),Z,G),ve&&Yr(b,null,W,"created"),Te(J,b,b.scopeId,Z,W),he){for(const rt in he)rt!=="value"&&!Ms(rt)&&i(J,rt,null,he[rt],E,W);"value"in he&&i(J,"value",null,he.value,E),(K=he.onVnodeBeforeMount)&&yr(K,W,b)}ve&&Yr(b,null,W,"beforeMount");const Ne=Bu(F,fe);Ne&&fe.beforeEnter(J),s(J,S,I),((K=he&&he.onVnodeMounted)||Ne||ve)&&er(()=>{K&&yr(K,W,b),Ne&&fe.enter(J),ve&&Yr(b,null,W,"mounted")},F)},Te=(b,S,I,W,F)=>{if(I&&_(b,I),W)for(let E=0;E<W.length;E++)_(b,W[E]);if(F){let E=F.subTree;if(S===E||Ol(E.type)&&(E.ssContent===S||E.ssFallback===S)){const Z=F.vnode;Te(b,Z,Z.scopeId,Z.slotScopeIds,F.parent)}}},it=(b,S,I,W,F,E,Z,G,J=0)=>{for(let K=J;K<b.length;K++){const he=b[K]=G?$r(b[K]):br(b[K]);O(null,he,S,I,W,F,E,Z,G)}},ot=(b,S,I,W,F,E,Z)=>{const G=S.el=b.el;let{patchFlag:J,dynamicChildren:K,dirs:he}=S;J|=b.patchFlag&16;const Q=b.props||pt,fe=S.props||pt;let ve;if(I&&Xr(I,!1),(ve=fe.onVnodeBeforeUpdate)&&yr(ve,I,S,b),he&&Yr(S,b,I,"beforeUpdate"),I&&Xr(I,!0),(Q.innerHTML&&fe.innerHTML==null||Q.textContent&&fe.textContent==null)&&p(G,""),K?At(b.dynamicChildren,K,G,I,W,gi(S,F),E):Z||re(b,S,G,null,I,W,gi(S,F),E,!1),J>0){if(J&16)vt(G,Q,fe,I,F);else if(J&2&&Q.class!==fe.class&&i(G,"class",null,fe.class,F),J&4&&i(G,"style",Q.style,fe.style,F),J&8){const Ne=S.dynamicProps;for(let rt=0;rt<Ne.length;rt++){const Je=Ne[rt],Rt=Q[Je],Ut=fe[Je];(Ut!==Rt||Je==="value")&&i(G,Je,Rt,Ut,F,I)}}J&1&&b.children!==S.children&&p(G,S.children)}else!Z&&K==null&&vt(G,Q,fe,I,F);((ve=fe.onVnodeUpdated)||he)&&er(()=>{ve&&yr(ve,I,S,b),he&&Yr(S,b,I,"updated")},W)},At=(b,S,I,W,F,E,Z)=>{for(let G=0;G<S.length;G++){const J=b[G],K=S[G],he=J.el&&(J.type===ht||!Ds(J,K)||J.shapeFlag&198)?y(J.el):I;O(J,K,he,null,W,F,E,Z,!0)}},vt=(b,S,I,W,F)=>{if(S!==I){if(S!==pt)for(const E in S)!Ms(E)&&!(E in I)&&i(b,E,S[E],null,F,W);for(const E in I){if(Ms(E))continue;const Z=I[E],G=S[E];Z!==G&&E!=="value"&&i(b,E,G,Z,F,W)}"value"in I&&i(b,"value",S.value,I.value,F)}},ut=(b,S,I,W,F,E,Z,G,J)=>{const K=S.el=b?b.el:l(""),he=S.anchor=b?b.anchor:l("");let{patchFlag:Q,dynamicChildren:fe,slotScopeIds:ve}=S;ve&&(G=G?G.concat(ve):ve),b==null?(s(K,I,W),s(he,I,W),it(S.children||[],I,he,F,E,Z,G,J)):Q>0&&Q&64&&fe&&b.dynamicChildren&&b.dynamicChildren.length===fe.length?(At(b.dynamicChildren,fe,I,F,E,Z,G),(S.key!=null||F&&S===F.subTree)&&Al(b,S,!0)):re(b,S,I,he,F,E,Z,G,J)},zt=(b,S,I,W,F,E,Z,G,J)=>{S.slotScopeIds=G,b==null?S.shapeFlag&512?F.ctx.activate(S,I,W,Z,J):_e(S,I,W,F,E,Z,J):Pe(b,S,J)},_e=(b,S,I,W,F,E,Z)=>{const G=b.component=Gu(b,W,F);if(cl(b)&&(G.ctx.renderer=_t),Yu(G,!1,Z),G.asyncDep){if(F&&F.registerDep(G,Se,Z),!b.el){const J=G.subTree=wr(Jr);N(null,J,S,I),b.placeholder=J.el}}else Se(G,b,S,I,F,E,Z)},Pe=(b,S,I)=>{const W=S.component=b.component;if(Ru(b,S,I))if(W.asyncDep&&!W.asyncResolved){ne(W,S,I);return}else W.next=S,W.update();else S.el=b.el,W.vnode=S},Se=(b,S,I,W,F,E,Z)=>{const G=()=>{if(b.isMounted){let{next:Q,bu:fe,u:ve,parent:Ne,vnode:rt}=b;{const Kt=Cl(b);if(Kt){Q&&(Q.el=rt.el,ne(b,Q,Z)),Kt.asyncDep.then(()=>{er(()=>{b.isUnmounted||K()},F)});return}}let Je=Q,Rt;Xr(b,!1),Q?(Q.el=rt.el,ne(b,Q,Z)):Q=rt,fe&&Rn(fe),(Rt=Q.props&&Q.props.onVnodeBeforeUpdate)&&yr(Rt,Ne,Q,rt),Xr(b,!0);const Ut=To(b),Ft=b.subTree;b.subTree=Ut,O(Ft,Ut,y(Ft.el),mt(Ft),b,F,E),Q.el=Ut.el,Je===null&&Ou(b,Ut.el),ve&&er(ve,F),(Rt=Q.props&&Q.props.onVnodeUpdated)&&er(()=>yr(Rt,Ne,Q,rt),F)}else{let Q;const{el:fe,props:ve}=S,{bm:Ne,m:rt,parent:Je,root:Rt,type:Ut}=b,Ft=Hs(S);Xr(b,!1),Ne&&Rn(Ne),!Ft&&(Q=ve&&ve.onVnodeBeforeMount)&&yr(Q,Je,S),Xr(b,!0);{Rt.ce&&Rt.ce._hasShadowRoot()&&Rt.ce._injectChildStyle(Ut);const Kt=b.subTree=To(b);O(null,Kt,I,W,b,F,E),S.el=Kt.el}if(rt&&er(rt,F),!Ft&&(Q=ve&&ve.onVnodeMounted)){const Kt=S;er(()=>yr(Q,Je,Kt),F)}(S.shapeFlag&256||Je&&Hs(Je.vnode)&&Je.vnode.shapeFlag&256)&&b.a&&er(b.a,F),b.isMounted=!0,S=I=W=null}};b.scope.on();const J=b.effect=new Na(G);b.scope.off();const K=b.update=J.run.bind(J),he=b.job=J.runIfDirty.bind(J);he.i=b,he.id=b.uid,J.scheduler=()=>ao(he),Xr(b,!0),K()},ne=(b,S,I)=>{S.component=b;const W=b.vnode.props;b.vnode=S,b.next=null,Pu(b,S.props,W,I),Du(b,S.children,I),Ur(),mo(b),Dr()},re=(b,S,I,W,F,E,Z,G,J=!1)=>{const K=b&&b.children,he=b?b.shapeFlag:0,Q=S.children,{patchFlag:fe,shapeFlag:ve}=S;if(fe>0){if(fe&128){qe(K,Q,I,W,F,E,Z,G,J);return}else if(fe&256){Ie(K,Q,I,W,F,E,Z,G,J);return}}ve&8?(he&16&&st(K,F,E),Q!==K&&p(I,Q)):he&16?ve&16?qe(K,Q,I,W,F,E,Z,G,J):st(K,F,E,!0):(he&8&&p(I,""),ve&16&&it(Q,I,W,F,E,Z,G,J))},Ie=(b,S,I,W,F,E,Z,G,J)=>{b=b||xs,S=S||xs;const K=b.length,he=S.length,Q=Math.min(K,he);let fe;for(fe=0;fe<Q;fe++){const ve=S[fe]=J?$r(S[fe]):br(S[fe]);O(b[fe],ve,I,null,F,E,Z,G,J)}K>he?st(b,F,E,!0,!1,Q):it(S,I,W,F,E,Z,G,J,Q)},qe=(b,S,I,W,F,E,Z,G,J)=>{let K=0;const he=S.length;let Q=b.length-1,fe=he-1;for(;K<=Q&&K<=fe;){const ve=b[K],Ne=S[K]=J?$r(S[K]):br(S[K]);if(Ds(ve,Ne))O(ve,Ne,I,null,F,E,Z,G,J);else break;K++}for(;K<=Q&&K<=fe;){const ve=b[Q],Ne=S[fe]=J?$r(S[fe]):br(S[fe]);if(Ds(ve,Ne))O(ve,Ne,I,null,F,E,Z,G,J);else break;Q--,fe--}if(K>Q){if(K<=fe){const ve=fe+1,Ne=ve<he?S[ve].el:W;for(;K<=fe;)O(null,S[K]=J?$r(S[K]):br(S[K]),I,Ne,F,E,Z,G,J),K++}}else if(K>fe)for(;K<=Q;)ze(b[K],F,E,!0),K++;else{const ve=K,Ne=K,rt=new Map;for(K=Ne;K<=fe;K++){const wt=S[K]=J?$r(S[K]):br(S[K]);wt.key!=null&&rt.set(wt.key,K)}let Je,Rt=0;const Ut=fe-Ne+1;let Ft=!1,Kt=0;const Jt=new Array(Ut);for(K=0;K<Ut;K++)Jt[K]=0;for(K=ve;K<=Q;K++){const wt=b[K];if(Rt>=Ut){ze(wt,F,E,!0);continue}let Dt;if(wt.key!=null)Dt=rt.get(wt.key);else for(Je=Ne;Je<=fe;Je++)if(Jt[Je-Ne]===0&&Ds(wt,S[Je])){Dt=Je;break}Dt===void 0?ze(wt,F,E,!0):(Jt[Dt-Ne]=K+1,Dt>=Kt?Kt=Dt:Ft=!0,O(wt,S[Dt],I,null,F,E,Z,G,J),Rt++)}const lr=Ft?Mu(Jt):xs;for(Je=lr.length-1,K=Ut-1;K>=0;K--){const wt=Ne+K,Dt=S[wt],kr=S[wt+1],gr=wt+1<he?kr.el||Rl(kr):W;Jt[K]===0?O(null,Dt,I,gr,F,E,Z,G,J):Ft&&(Je<0||K!==lr[Je]?ft(Dt,I,gr,2):Je--)}}},ft=(b,S,I,W,F=null)=>{const{el:E,type:Z,transition:G,children:J,shapeFlag:K}=b;if(K&6){ft(b.component.subTree,S,I,W);return}if(K&128){b.suspense.move(S,I,W);return}if(K&64){Z.move(b,S,I,_t);return}if(Z===ht){s(E,S,I);for(let Q=0;Q<J.length;Q++)ft(J[Q],S,I,W);s(b.anchor,S,I);return}if(Z===yi){B(b,S,I);return}if(W!==2&&K&1&&G)if(W===0)G.beforeEnter(E),s(E,S,I),er(()=>G.enter(E),F);else{const{leave:Q,delayLeave:fe,afterLeave:ve}=G,Ne=()=>{b.ctx.isUnmounted?n(E):s(E,S,I)},rt=()=>{E._isLeaving&&E[nu](!0),Q(E,()=>{Ne(),ve&&ve()})};fe?fe(E,Ne,rt):rt()}else s(E,S,I)},ze=(b,S,I,W=!1,F=!1)=>{const{type:E,props:Z,ref:G,children:J,dynamicChildren:K,shapeFlag:he,patchFlag:Q,dirs:fe,cacheIndex:ve}=b;if(Q===-2&&(F=!1),G!=null&&(Ur(),qs(G,null,I,b,!0),Dr()),ve!=null&&(S.renderCache[ve]=void 0),he&256){S.ctx.deactivate(b);return}const Ne=he&1&&fe,rt=!Hs(b);let Je;if(rt&&(Je=Z&&Z.onVnodeBeforeUnmount)&&yr(Je,S,b),he&6)ye(b.component,I,W);else{if(he&128){b.suspense.unmount(I,W);return}Ne&&Yr(b,null,S,"beforeUnmount"),he&64?b.type.remove(b,S,I,_t,W):K&&!K.hasOnce&&(E!==ht||Q>0&&Q&64)?st(K,S,I,!1,!0):(E===ht&&Q&384||!F&&he&16)&&st(J,S,I),W&&bt(b)}(rt&&(Je=Z&&Z.onVnodeUnmounted)||Ne)&&er(()=>{Je&&yr(Je,S,b),Ne&&Yr(b,null,S,"unmounted")},I)},bt=b=>{const{type:S,el:I,anchor:W,transition:F}=b;if(S===ht){Ee(I,W);return}if(S===yi){M(b);return}const E=()=>{n(I),F&&!F.persisted&&F.afterLeave&&F.afterLeave()};if(b.shapeFlag&1&&F&&!F.persisted){const{leave:Z,delayLeave:G}=F,J=()=>Z(I,E);G?G(b.el,E,J):J()}else E()},Ee=(b,S)=>{let I;for(;b!==S;)I=w(b),n(b),b=I;n(S)},ye=(b,S,I)=>{const{bum:W,scope:F,job:E,subTree:Z,um:G,m:J,a:K}=b;Ro(J),Ro(K),W&&Rn(W),F.stop(),E&&(E.flags|=8,ze(Z,b,S,I)),G&&er(G,S),er(()=>{b.isUnmounted=!0},S)},st=(b,S,I,W=!1,F=!1,E=0)=>{for(let Z=E;Z<b.length;Z++)ze(b[Z],S,I,W,F)},mt=b=>{if(b.shapeFlag&6)return mt(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const S=w(b.anchor||b.el),I=S&&S[ru];return I?w(I):S};let rr=!1;const Qt=(b,S,I)=>{let W;b==null?S._vnode&&(ze(S._vnode,null,null,!0),W=S._vnode.component):O(S._vnode||null,b,S,null,null,null,I),S._vnode=b,rr||(rr=!0,mo(W),rl(),rr=!1)},_t={p:O,um:ze,m:ft,r:bt,mt:_e,mc:it,pc:re,pbc:At,n:mt,o:t};return{render:Qt,hydrate:void 0,createApp:Su(Qt)}}function gi({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function Xr({effect:t,job:e},r){r?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Bu(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Al(t,e,r=!1){const s=t.children,n=e.children;if($e(s)&&$e(n))for(let i=0;i<s.length;i++){const o=s[i];let l=n[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=n[i]=$r(n[i]),l.el=o.el),!r&&l.patchFlag!==-2&&Al(o,l)),l.type===ri&&(l.patchFlag===-1&&(l=n[i]=$r(l)),l.el=o.el),l.type===Jr&&!l.el&&(l.el=o.el)}}function Mu(t){const e=t.slice(),r=[0];let s,n,i,o,l;const c=t.length;for(s=0;s<c;s++){const f=t[s];if(f!==0){if(n=r[r.length-1],t[n]<f){e[s]=n,r.push(s);continue}for(i=0,o=r.length-1;i<o;)l=i+o>>1,t[r[l]]<f?i=l+1:o=l;f<t[r[i]]&&(i>0&&(e[s]=r[i-1]),r[i]=s)}}for(i=r.length,o=r[i-1];i-- >0;)r[i]=o,o=e[o];return r}function Cl(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Cl(e)}function Ro(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}function Rl(t){if(t.placeholder)return t.placeholder;const e=t.component;return e?Rl(e.subTree):null}const Ol=t=>t.__isSuspense;function Fu(t,e){e&&e.pendingBranch?$e(t)?e.effects.push(...t):e.effects.push(t):Yc(t)}const ht=Symbol.for("v-fgt"),ri=Symbol.for("v-txt"),Jr=Symbol.for("v-cmt"),yi=Symbol.for("v-stc"),Vs=[];let or=null;function Y(t=!1){Vs.push(or=t?null:[])}function Ku(){Vs.pop(),or=Vs[Vs.length-1]||null}let Qs=1;function Oo(t,e=!1){Qs+=t,t<0&&or&&e&&(or.hasOnce=!0)}function $l(t){return t.dynamicChildren=Qs>0?or||xs:null,Ku(),Qs>0&&or&&or.push(t),t}function X(t,e,r,s,n,i){return $l(x(t,e,r,s,n,i,!0))}function qu(t,e,r,s,n){return $l(wr(t,e,r,s,n,!0))}function Pl(t){return t?t.__v_isVNode===!0:!1}function Ds(t,e){return t.type===e.type&&t.key===e.key}const Il=({key:t})=>t??null,$n=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?$t(t)||jt(t)||Ue(t)?{i:cr,r:t,k:e,f:!!r}:t:null);function x(t,e=null,r=null,s=0,n=null,i=t===ht?0:1,o=!1,l=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Il(e),ref:e&&$n(e),scopeId:nl,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:cr};return l?(fo(c,r),i&128&&t.normalize(c)):r&&(c.shapeFlag|=$t(r)?8:16),Qs>0&&!o&&or&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&or.push(c),c}const wr=Hu;function Hu(t,e=null,r=null,s=0,n=null,i=!1){if((!t||t===gu)&&(t=Jr),Pl(t)){const l=$s(t,e,!0);return r&&fo(l,r),Qs>0&&!i&&or&&(l.shapeFlag&6?or[or.indexOf(t)]=l:or.push(l)),l.patchFlag=-2,l}if(ef(t)&&(t=t.__vccOpts),e){e=Wu(e);let{class:l,style:c}=e;l&&!$t(l)&&(e.class=Lt(l)),ct(c)&&(Xn(c)&&!$e(c)&&(c=Mt({},c)),e.style=Es(c))}const o=$t(t)?1:Ol(t)?128:su(t)?64:ct(t)?4:Ue(t)?2:0;return x(t,e,r,s,n,o,i,!0)}function Wu(t){return t?Xn(t)||wl(t)?Mt({},t):t:null}function $s(t,e,r=!1,s=!1){const{props:n,ref:i,patchFlag:o,children:l,transition:c}=t,f=e?Vu(n||{},e):n,p={__v_isVNode:!0,__v_skip:!0,type:t.type,props:f,key:f&&Il(f),ref:e&&e.ref?r&&i?$e(i)?i.concat($n(e)):[i,$n(e)]:$n(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ht?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&$s(t.ssContent),ssFallback:t.ssFallback&&$s(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&s&&lo(p,c.clone(p)),p}function en(t=" ",e=0){return wr(ri,null,t,e)}function dt(t="",e=!1){return e?(Y(),qu(Jr,null,t)):wr(Jr,null,t)}function br(t){return t==null||typeof t=="boolean"?wr(Jr):$e(t)?wr(ht,null,t.slice()):Pl(t)?$r(t):wr(ri,null,String(t))}function $r(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:$s(t)}function fo(t,e){let r=0;const{shapeFlag:s}=t;if(e==null)e=null;else if($e(e))r=16;else if(typeof e=="object")if(s&65){const n=e.default;n&&(n._c&&(n._d=!1),fo(t,n()),n._c&&(n._d=!0));return}else{r=32;const n=e._;!n&&!wl(e)?e._ctx=cr:n===3&&cr&&(cr.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ue(e)?(e={default:e,_ctx:cr},r=32):(e=String(e),s&64?(r=16,e=[en(e)]):r=8);t.children=e,t.shapeFlag|=r}function Vu(...t){const e={};for(let r=0;r<t.length;r++){const s=t[r];for(const n in s)if(n==="class")e.class!==s.class&&(e.class=Lt([e.class,s.class]));else if(n==="style")e.style=Es([e.style,s.style]);else if(Wn(n)){const i=e[n],o=s[n];o&&i!==o&&!($e(i)&&i.includes(o))&&(e[n]=i?[].concat(i,o):o)}else n!==""&&(e[n]=s[n])}return e}function yr(t,e,r,s=null){Er(t,e,7,[r,s])}const zu=yl();let Ju=0;function Gu(t,e,r){const s=t.type,n=(e?e.appContext:t.appContext)||zu,i={uid:Ju++,vnode:t,type:s,parent:e,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new dc(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(n.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Sl(s,n),emitsOptions:vl(s,n),emit:null,emitted:null,propsDefaults:pt,inheritAttrs:s.inheritAttrs,ctx:pt,data:pt,props:pt,attrs:pt,slots:pt,refs:pt,setupState:pt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=ku.bind(null,i),t.ce&&t.ce(i),i}let Zt=null;const jl=()=>Zt||cr;let Fn,Bi;{const t=Jn(),e=(r,s)=>{let n;return(n=t[r])||(n=t[r]=[]),n.push(s),i=>{n.length>1?n.forEach(o=>o(i)):n[0](i)}};Fn=e("__VUE_INSTANCE_SETTERS__",r=>Zt=r),Bi=e("__VUE_SSR_SETTERS__",r=>tn=r)}const hn=t=>{const e=Zt;return Fn(t),t.scope.on(),()=>{t.scope.off(),Fn(e)}},$o=()=>{Zt&&Zt.scope.off(),Fn(null)};function Ul(t){return t.vnode.shapeFlag&4}let tn=!1;function Yu(t,e=!1,r=!1){e&&Bi(e);const{props:s,children:n}=t.vnode,i=Ul(t);$u(t,s,i,e),Uu(t,n,r||e);const o=i?Xu(t,e):void 0;return e&&Bi(!1),o}function Xu(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,yu);const{setup:s}=r;if(s){Ur();const n=t.setupContext=s.length>1?Qu(t):null,i=hn(t),o=dn(s,t,0,[t.props,n]),l=Oa(o);if(Dr(),i(),(l||t.sp)&&!Hs(t)&&ll(t),l){if(o.then($o,$o),e)return o.then(c=>{Po(t,c)}).catch(c=>{Zn(c,t,0)});t.asyncDep=o}else Po(t,o)}else Dl(t)}function Po(t,e,r){Ue(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:ct(e)&&(t.setupState=Qa(e)),Dl(t)}function Dl(t,e,r){const s=t.type;t.render||(t.render=s.render||_r);{const n=hn(t);Ur();try{vu(t)}finally{Dr(),n()}}}const Zu={get(t,e){return Vt(t,"get",""),t[e]}};function Qu(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,Zu),slots:t.slots,emit:t.emit,expose:e}}function si(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Qa(jc(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in Ws)return Ws[r](t)},has(e,r){return r in e||r in Ws}})):t.proxy}function ef(t){return Ue(t)&&"__vccOpts"in t}const mr=(t,e)=>Wc(t,e,tn),tf="3.5.28";let Mi;const Io=typeof window<"u"&&window.trustedTypes;if(Io)try{Mi=Io.createPolicy("vue",{createHTML:t=>t})}catch{}const Ll=Mi?t=>Mi.createHTML(t):t=>t,rf="http://www.w3.org/2000/svg",sf="http://www.w3.org/1998/Math/MathML",Rr=typeof document<"u"?document:null,jo=Rr&&Rr.createElement("template"),nf={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,s)=>{const n=e==="svg"?Rr.createElementNS(rf,t):e==="mathml"?Rr.createElementNS(sf,t):r?Rr.createElement(t,{is:r}):Rr.createElement(t);return t==="select"&&s&&s.multiple!=null&&n.setAttribute("multiple",s.multiple),n},createText:t=>Rr.createTextNode(t),createComment:t=>Rr.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Rr.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,s,n,i){const o=r?r.previousSibling:e.lastChild;if(n&&(n===i||n.nextSibling))for(;e.insertBefore(n.cloneNode(!0),r),!(n===i||!(n=n.nextSibling)););else{jo.innerHTML=Ll(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const l=jo.content;if(s==="svg"||s==="mathml"){const c=l.firstChild;for(;c.firstChild;)l.appendChild(c.firstChild);l.removeChild(c)}e.insertBefore(l,r)}return[o?o.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},of=Symbol("_vtc");function af(t,e,r){const s=t[of];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const Uo=Symbol("_vod"),lf=Symbol("_vsh"),cf=Symbol(""),uf=/(?:^|;)\s*display\s*:/;function ff(t,e,r){const s=t.style,n=$t(r);let i=!1;if(r&&!n){if(e)if($t(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();r[l]==null&&Pn(s,l,"")}else for(const o in e)r[o]==null&&Pn(s,o,"");for(const o in r)o==="display"&&(i=!0),Pn(s,o,r[o])}else if(n){if(e!==r){const o=s[cf];o&&(r+=";"+o),s.cssText=r,i=uf.test(r)}}else e&&t.removeAttribute("style");Uo in t&&(t[Uo]=i?s.display:"",t[lf]&&(s.display="none"))}const Do=/\s*!important$/;function Pn(t,e,r){if($e(r))r.forEach(s=>Pn(t,e,s));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const s=df(t,e);Do.test(r)?t.setProperty(Gr(s),r.replace(Do,""),"important"):t[s]=r}}const Lo=["Webkit","Moz","ms"],vi={};function df(t,e){const r=vi[e];if(r)return r;let s=zr(e);if(s!=="filter"&&s in t)return vi[e]=s;s=Ia(s);for(let n=0;n<Lo.length;n++){const i=Lo[n]+s;if(i in t)return vi[e]=i}return e}const No="http://www.w3.org/1999/xlink";function Bo(t,e,r,s,n,i=uc(e)){s&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(No,e.slice(6,e.length)):t.setAttributeNS(No,e,r):r==null||i&&!Ua(r)?t.removeAttribute(e):t.setAttribute(e,i?"":Sr(r)?String(r):r)}function Mo(t,e,r,s,n){if(e==="innerHTML"||e==="textContent"){r!=null&&(t[e]=e==="innerHTML"?Ll(r):r);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const l=i==="OPTION"?t.getAttribute("value")||"":t.value,c=r==null?t.type==="checkbox"?"on":"":String(r);(l!==c||!("_value"in t))&&(t.value=c),r==null&&t.removeAttribute(e),t._value=r;return}let o=!1;if(r===""||r==null){const l=typeof t[e];l==="boolean"?r=Ua(r):r==null&&l==="string"?(r="",o=!0):l==="number"&&(r=0,o=!0)}try{t[e]=r}catch{}o&&t.removeAttribute(n||e)}function ys(t,e,r,s){t.addEventListener(e,r,s)}function hf(t,e,r,s){t.removeEventListener(e,r,s)}const Fo=Symbol("_vei");function pf(t,e,r,s,n=null){const i=t[Fo]||(t[Fo]={}),o=i[e];if(s&&o)o.value=s;else{const[l,c]=gf(e);if(s){const f=i[e]=bf(s,n);ys(t,l,f,c)}else o&&(hf(t,l,o,c),i[e]=void 0)}}const Ko=/(?:Once|Passive|Capture)$/;function gf(t){let e;if(Ko.test(t)){e={};let s;for(;s=t.match(Ko);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Gr(t.slice(2)),e]}let bi=0;const yf=Promise.resolve(),vf=()=>bi||(yf.then(()=>bi=0),bi=Date.now());function bf(t,e){const r=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=r.attached)return;Er(mf(s,r.value),e,5,[s])};return r.value=t,r.attached=vf(),r}function mf(t,e){if($e(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(s=>n=>!n._stopped&&s&&s(n))}else return e}const qo=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,_f=(t,e,r,s,n,i)=>{const o=n==="svg";e==="class"?af(t,s,o):e==="style"?ff(t,r,s):Wn(e)?Zi(e)||pf(t,e,r,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):wf(t,e,s,o))?(Mo(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Bo(t,e,s,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!$t(s))?Mo(t,zr(e),s,i,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Bo(t,e,s,o))};function wf(t,e,r,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&qo(e)&&Ue(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const n=t.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return qo(e)&&$t(r)?!1:e in t}const Ho=t=>{const e=t.props["onUpdate:modelValue"]||!1;return $e(e)?r=>Rn(e,r):e};function xf(t){t.target.composing=!0}function Wo(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const mi=Symbol("_assign");function Vo(t,e,r){return e&&(t=t.trim()),r&&(t=eo(t)),t}const _i={created(t,{modifiers:{lazy:e,trim:r,number:s}},n){t[mi]=Ho(n);const i=s||n.props&&n.props.type==="number";ys(t,e?"change":"input",o=>{o.target.composing||t[mi](Vo(t.value,r,i))}),(r||i)&&ys(t,"change",()=>{t.value=Vo(t.value,r,i)}),e||(ys(t,"compositionstart",xf),ys(t,"compositionend",Wo),ys(t,"change",Wo))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:r,modifiers:{lazy:s,trim:n,number:i}},o){if(t[mi]=Ho(o),t.composing)return;const l=(i||t.type==="number")&&!/^0\d/.test(t.value)?eo(t.value):t.value,c=e??"";l!==c&&(document.activeElement===t&&t.type!=="range"&&(s&&e===r||n&&t.value.trim()===c)||(t.value=c))}},Sf=["ctrl","shift","alt","meta"],Ef={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Sf.some(r=>t[`${r}Key`]&&!e.includes(r))},zo=(t,e)=>{if(!t)return t;const r=t._withMods||(t._withMods={}),s=e.join(".");return r[s]||(r[s]=((n,...i)=>{for(let o=0;o<e.length;o++){const l=Ef[e[o]];if(l&&l(n,e))return}return t(n,...i)}))},kf={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Tf=(t,e)=>{const r=t._withKeys||(t._withKeys={}),s=e.join(".");return r[s]||(r[s]=(n=>{if(!("key"in n))return;const i=Gr(n.key);if(e.some(o=>o===i||kf[o]===i))return t(n)}))},Af=Mt({patchProp:_f},nf);let Jo;function Cf(){return Jo||(Jo=Lu(Af))}const Rf=((...t)=>{const e=Cf().createApp(...t),{mount:r}=e;return e.mount=s=>{const n=$f(s);if(!n)return;const i=e._component;!Ue(i)&&!i.render&&!i.template&&(i.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const o=r(n,!1,Of(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},e});function Of(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function $f(t){return $t(t)?document.querySelector(t):t}const Pf=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const If=Object.prototype.toString,jf=t=>If.call(t)==="[object Object]",Uf=()=>{};function Df(...t){if(t.length!==1)return Kc(...t);const e=t[0];return typeof e=="function"?Xs(Bc(()=>({get:e,set:Uf}))):tt(e)}function Lf(t,e){function r(...s){return new Promise((n,i)=>{Promise.resolve(t(()=>e.apply(this,s),{fn:e,thisArg:this,args:s})).then(n).catch(i)})}return r}const Nl=t=>t();function Nf(t=Nl,e={}){const{initialState:r="active"}=e,s=Df(r==="active");function n(){s.value=!1}function i(){s.value=!0}return{isActive:Xs(s),pause:n,resume:i,eventFilter:(...l)=>{s.value&&t(...l)}}}function wi(t){return Array.isArray(t)?t:[t]}function Bf(t){return jl()}function Mf(t,e,r={}){const{eventFilter:s=Nl,...n}=r;return jr(t,Lf(s,e),n)}function Ff(t,e,r={}){const{eventFilter:s,initialState:n="active",...i}=r,{eventFilter:o,pause:l,resume:c,isActive:f}=Nf(s,{initialState:n});return{stop:Mf(t,e,{...i,eventFilter:o}),pause:l,resume:c,isActive:f}}function Kf(t,e=!0,r){Bf()?fl(t,r):e?t():Qn(t)}function qf(t,e,r){return jr(t,e,{...r,immediate:!0})}const _s=Pf?window:void 0;function Hf(t){var e;const r=Ts(t);return(e=r?.$el)!==null&&e!==void 0?e:r}function Go(...t){const e=(s,n,i,o)=>(s.addEventListener(n,i,o),()=>s.removeEventListener(n,i,o)),r=mr(()=>{const s=wi(Ts(t[0])).filter(n=>n!=null);return s.every(n=>typeof n!="string")?s:void 0});return qf(()=>{var s,n;return[(s=(n=r.value)===null||n===void 0?void 0:n.map(i=>Hf(i)))!==null&&s!==void 0?s:[_s].filter(i=>i!=null),wi(Ts(r.value?t[1]:t[0])),wi(ee(r.value?t[2]:t[1])),Ts(r.value?t[3]:t[2])]},([s,n,i,o],l,c)=>{if(!s?.length||!n?.length||!i?.length)return;const f=jf(o)?{...o}:o,p=s.flatMap(y=>n.flatMap(w=>i.map(_=>e(y,w,_,f))));c(()=>{p.forEach(y=>y())})},{flush:"post"})}const mn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_n="__vueuse_ssr_handlers__",Wf=Vf();function Vf(){return _n in mn||(mn[_n]=mn[_n]||{}),mn[_n]}function zf(t,e){return Wf[t]||e}function Jf(t){return t==null?"any":t instanceof Set?"set":t instanceof Map?"map":t instanceof Date?"date":typeof t=="boolean"?"boolean":typeof t=="string"?"string":typeof t=="object"?"object":Number.isNaN(t)?"any":"number"}const Gf={boolean:{read:t=>t==="true",write:t=>String(t)},object:{read:t=>JSON.parse(t),write:t=>JSON.stringify(t)},number:{read:t=>Number.parseFloat(t),write:t=>String(t)},any:{read:t=>t,write:t=>String(t)},string:{read:t=>t,write:t=>String(t)},map:{read:t=>new Map(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t.entries()))},set:{read:t=>new Set(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t))},date:{read:t=>new Date(t),write:t=>t.toISOString()}},Yo="vueuse-storage";function Yf(t,e,r,s={}){var n;const{flush:i="pre",deep:o=!0,listenToStorageChanges:l=!0,writeDefaults:c=!0,mergeDefaults:f=!1,shallow:p,window:y=_s,eventFilter:w,onError:_=_e=>{console.error(_e)},initOnMounted:C}=s,O=(p?Uc:tt)(typeof e=="function"?e():e),U=mr(()=>Ts(t));if(!r)try{r=zf("getDefaultStorage",()=>_s?.localStorage)()}catch(_e){_(_e)}if(!r)return O;const N=Ts(e),H=Jf(N),B=(n=s.serializer)!==null&&n!==void 0?n:Gf[H],{pause:M,resume:me}=Ff(O,_e=>At(_e),{flush:i,deep:o,eventFilter:w});jr(U,()=>ut(),{flush:i});let ge=!1;const Te=_e=>{C&&!ge||ut(_e)},it=_e=>{C&&!ge||zt(_e)};y&&l&&(r instanceof Storage?Go(y,"storage",Te,{passive:!0}):Go(y,Yo,it)),C?Kf(()=>{ge=!0,ut()}):ut();function ot(_e,Pe){if(y){const Se={key:U.value,oldValue:_e,newValue:Pe,storageArea:r};y.dispatchEvent(r instanceof Storage?new StorageEvent("storage",Se):new CustomEvent(Yo,{detail:Se}))}}function At(_e){try{const Pe=r.getItem(U.value);if(_e==null)ot(Pe,null),r.removeItem(U.value);else{const Se=B.write(_e);Pe!==Se&&(r.setItem(U.value,Se),ot(Pe,Se))}}catch(Pe){_(Pe)}}function vt(_e){const Pe=_e?_e.newValue:r.getItem(U.value);if(Pe==null)return c&&N!=null&&r.setItem(U.value,B.write(N)),N;if(!_e&&f){const Se=B.read(Pe);return typeof f=="function"?f(Se,N):H==="object"&&!Array.isArray(Se)?{...N,...Se}:Se}else return typeof Pe!="string"?Pe:B.read(Pe)}function ut(_e){if(!(_e&&_e.storageArea!==r)){if(_e&&_e.key==null){O.value=N;return}if(!(_e&&_e.key!==U.value)){M();try{const Pe=B.write(O.value);(_e===void 0||_e?.newValue!==Pe)&&(O.value=vt(_e))}catch(Pe){_(Pe)}finally{_e?Qn(me):me()}}}}function zt(_e){ut(_e.detail)}return O}function In(t,e,r={}){const{window:s=_s}=r;return Yf(t,e,s?.localStorage,r)}function Xf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Zf(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function s(){var n=!1;try{n=this instanceof s}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var n=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return t[s]}})}),r}function Qf(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xi={exports:{}};const ed={},td=Object.freeze(Object.defineProperty({__proto__:null,default:ed},Symbol.toStringTag,{value:"Module"})),rd=Zf(td);var Xo;function sd(){return Xo||(Xo=1,(function(t){(function(e){var r=function(u){var h,d=new Float64Array(16);if(u)for(h=0;h<u.length;h++)d[h]=u[h];return d},s=function(){throw new Error("no PRNG")},n=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var o=r(),l=r([1]),c=r([56129,1]),f=r([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=r([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),y=r([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=r([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_=r([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function C(u,h,d,a){u[h]=d>>24&255,u[h+1]=d>>16&255,u[h+2]=d>>8&255,u[h+3]=d&255,u[h+4]=a>>24&255,u[h+5]=a>>16&255,u[h+6]=a>>8&255,u[h+7]=a&255}function O(u,h,d,a,g){var k,T=0;for(k=0;k<g;k++)T|=u[h+k]^d[a+k];return(1&T-1>>>8)-1}function U(u,h,d,a){return O(u,h,d,a,16)}function N(u,h,d,a){return O(u,h,d,a,32)}function H(u,h,d,a){for(var g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,k=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,T=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,j=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,V=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,le=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,te=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,Xe=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,oe=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,Ae=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,Ce=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,Be=d[16]&255|(d[17]&255)<<8|(d[18]&255)<<16|(d[19]&255)<<24,De=d[20]&255|(d[21]&255)<<8|(d[22]&255)<<16|(d[23]&255)<<24,Re=d[24]&255|(d[25]&255)<<8|(d[26]&255)<<16|(d[27]&255)<<24,je=d[28]&255|(d[29]&255)<<8|(d[30]&255)<<16|(d[31]&255)<<24,Oe=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,ae=g,pe=k,ie=T,ce=j,ue=V,se=le,$=te,P=Xe,q=oe,D=Ae,L=Ce,z=Be,we=De,Me=Re,Ke=je,Fe=Oe,v,Ve=0;Ve<20;Ve+=2)v=ae+we|0,ue^=v<<7|v>>>25,v=ue+ae|0,q^=v<<9|v>>>23,v=q+ue|0,we^=v<<13|v>>>19,v=we+q|0,ae^=v<<18|v>>>14,v=se+pe|0,D^=v<<7|v>>>25,v=D+se|0,Me^=v<<9|v>>>23,v=Me+D|0,pe^=v<<13|v>>>19,v=pe+Me|0,se^=v<<18|v>>>14,v=L+$|0,Ke^=v<<7|v>>>25,v=Ke+L|0,ie^=v<<9|v>>>23,v=ie+Ke|0,$^=v<<13|v>>>19,v=$+ie|0,L^=v<<18|v>>>14,v=Fe+z|0,ce^=v<<7|v>>>25,v=ce+Fe|0,P^=v<<9|v>>>23,v=P+ce|0,z^=v<<13|v>>>19,v=z+P|0,Fe^=v<<18|v>>>14,v=ae+ce|0,pe^=v<<7|v>>>25,v=pe+ae|0,ie^=v<<9|v>>>23,v=ie+pe|0,ce^=v<<13|v>>>19,v=ce+ie|0,ae^=v<<18|v>>>14,v=se+ue|0,$^=v<<7|v>>>25,v=$+se|0,P^=v<<9|v>>>23,v=P+$|0,ue^=v<<13|v>>>19,v=ue+P|0,se^=v<<18|v>>>14,v=L+D|0,z^=v<<7|v>>>25,v=z+L|0,q^=v<<9|v>>>23,v=q+z|0,D^=v<<13|v>>>19,v=D+q|0,L^=v<<18|v>>>14,v=Fe+Ke|0,we^=v<<7|v>>>25,v=we+Fe|0,Me^=v<<9|v>>>23,v=Me+we|0,Ke^=v<<13|v>>>19,v=Ke+Me|0,Fe^=v<<18|v>>>14;ae=ae+g|0,pe=pe+k|0,ie=ie+T|0,ce=ce+j|0,ue=ue+V|0,se=se+le|0,$=$+te|0,P=P+Xe|0,q=q+oe|0,D=D+Ae|0,L=L+Ce|0,z=z+Be|0,we=we+De|0,Me=Me+Re|0,Ke=Ke+je|0,Fe=Fe+Oe|0,u[0]=ae>>>0&255,u[1]=ae>>>8&255,u[2]=ae>>>16&255,u[3]=ae>>>24&255,u[4]=pe>>>0&255,u[5]=pe>>>8&255,u[6]=pe>>>16&255,u[7]=pe>>>24&255,u[8]=ie>>>0&255,u[9]=ie>>>8&255,u[10]=ie>>>16&255,u[11]=ie>>>24&255,u[12]=ce>>>0&255,u[13]=ce>>>8&255,u[14]=ce>>>16&255,u[15]=ce>>>24&255,u[16]=ue>>>0&255,u[17]=ue>>>8&255,u[18]=ue>>>16&255,u[19]=ue>>>24&255,u[20]=se>>>0&255,u[21]=se>>>8&255,u[22]=se>>>16&255,u[23]=se>>>24&255,u[24]=$>>>0&255,u[25]=$>>>8&255,u[26]=$>>>16&255,u[27]=$>>>24&255,u[28]=P>>>0&255,u[29]=P>>>8&255,u[30]=P>>>16&255,u[31]=P>>>24&255,u[32]=q>>>0&255,u[33]=q>>>8&255,u[34]=q>>>16&255,u[35]=q>>>24&255,u[36]=D>>>0&255,u[37]=D>>>8&255,u[38]=D>>>16&255,u[39]=D>>>24&255,u[40]=L>>>0&255,u[41]=L>>>8&255,u[42]=L>>>16&255,u[43]=L>>>24&255,u[44]=z>>>0&255,u[45]=z>>>8&255,u[46]=z>>>16&255,u[47]=z>>>24&255,u[48]=we>>>0&255,u[49]=we>>>8&255,u[50]=we>>>16&255,u[51]=we>>>24&255,u[52]=Me>>>0&255,u[53]=Me>>>8&255,u[54]=Me>>>16&255,u[55]=Me>>>24&255,u[56]=Ke>>>0&255,u[57]=Ke>>>8&255,u[58]=Ke>>>16&255,u[59]=Ke>>>24&255,u[60]=Fe>>>0&255,u[61]=Fe>>>8&255,u[62]=Fe>>>16&255,u[63]=Fe>>>24&255}function B(u,h,d,a){for(var g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,k=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,T=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,j=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,V=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,le=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,te=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,Xe=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,oe=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,Ae=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,Ce=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,Be=d[16]&255|(d[17]&255)<<8|(d[18]&255)<<16|(d[19]&255)<<24,De=d[20]&255|(d[21]&255)<<8|(d[22]&255)<<16|(d[23]&255)<<24,Re=d[24]&255|(d[25]&255)<<8|(d[26]&255)<<16|(d[27]&255)<<24,je=d[28]&255|(d[29]&255)<<8|(d[30]&255)<<16|(d[31]&255)<<24,Oe=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,ae=g,pe=k,ie=T,ce=j,ue=V,se=le,$=te,P=Xe,q=oe,D=Ae,L=Ce,z=Be,we=De,Me=Re,Ke=je,Fe=Oe,v,Ve=0;Ve<20;Ve+=2)v=ae+we|0,ue^=v<<7|v>>>25,v=ue+ae|0,q^=v<<9|v>>>23,v=q+ue|0,we^=v<<13|v>>>19,v=we+q|0,ae^=v<<18|v>>>14,v=se+pe|0,D^=v<<7|v>>>25,v=D+se|0,Me^=v<<9|v>>>23,v=Me+D|0,pe^=v<<13|v>>>19,v=pe+Me|0,se^=v<<18|v>>>14,v=L+$|0,Ke^=v<<7|v>>>25,v=Ke+L|0,ie^=v<<9|v>>>23,v=ie+Ke|0,$^=v<<13|v>>>19,v=$+ie|0,L^=v<<18|v>>>14,v=Fe+z|0,ce^=v<<7|v>>>25,v=ce+Fe|0,P^=v<<9|v>>>23,v=P+ce|0,z^=v<<13|v>>>19,v=z+P|0,Fe^=v<<18|v>>>14,v=ae+ce|0,pe^=v<<7|v>>>25,v=pe+ae|0,ie^=v<<9|v>>>23,v=ie+pe|0,ce^=v<<13|v>>>19,v=ce+ie|0,ae^=v<<18|v>>>14,v=se+ue|0,$^=v<<7|v>>>25,v=$+se|0,P^=v<<9|v>>>23,v=P+$|0,ue^=v<<13|v>>>19,v=ue+P|0,se^=v<<18|v>>>14,v=L+D|0,z^=v<<7|v>>>25,v=z+L|0,q^=v<<9|v>>>23,v=q+z|0,D^=v<<13|v>>>19,v=D+q|0,L^=v<<18|v>>>14,v=Fe+Ke|0,we^=v<<7|v>>>25,v=we+Fe|0,Me^=v<<9|v>>>23,v=Me+we|0,Ke^=v<<13|v>>>19,v=Ke+Me|0,Fe^=v<<18|v>>>14;u[0]=ae>>>0&255,u[1]=ae>>>8&255,u[2]=ae>>>16&255,u[3]=ae>>>24&255,u[4]=se>>>0&255,u[5]=se>>>8&255,u[6]=se>>>16&255,u[7]=se>>>24&255,u[8]=L>>>0&255,u[9]=L>>>8&255,u[10]=L>>>16&255,u[11]=L>>>24&255,u[12]=Fe>>>0&255,u[13]=Fe>>>8&255,u[14]=Fe>>>16&255,u[15]=Fe>>>24&255,u[16]=$>>>0&255,u[17]=$>>>8&255,u[18]=$>>>16&255,u[19]=$>>>24&255,u[20]=P>>>0&255,u[21]=P>>>8&255,u[22]=P>>>16&255,u[23]=P>>>24&255,u[24]=q>>>0&255,u[25]=q>>>8&255,u[26]=q>>>16&255,u[27]=q>>>24&255,u[28]=D>>>0&255,u[29]=D>>>8&255,u[30]=D>>>16&255,u[31]=D>>>24&255}function M(u,h,d,a){H(u,h,d,a)}function me(u,h,d,a){B(u,h,d,a)}var ge=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function Te(u,h,d,a,g,k,T){var j=new Uint8Array(16),V=new Uint8Array(64),le,te;for(te=0;te<16;te++)j[te]=0;for(te=0;te<8;te++)j[te]=k[te];for(;g>=64;){for(M(V,j,T,ge),te=0;te<64;te++)u[h+te]=d[a+te]^V[te];for(le=1,te=8;te<16;te++)le=le+(j[te]&255)|0,j[te]=le&255,le>>>=8;g-=64,h+=64,a+=64}if(g>0)for(M(V,j,T,ge),te=0;te<g;te++)u[h+te]=d[a+te]^V[te];return 0}function it(u,h,d,a,g){var k=new Uint8Array(16),T=new Uint8Array(64),j,V;for(V=0;V<16;V++)k[V]=0;for(V=0;V<8;V++)k[V]=a[V];for(;d>=64;){for(M(T,k,g,ge),V=0;V<64;V++)u[h+V]=T[V];for(j=1,V=8;V<16;V++)j=j+(k[V]&255)|0,k[V]=j&255,j>>>=8;d-=64,h+=64}if(d>0)for(M(T,k,g,ge),V=0;V<d;V++)u[h+V]=T[V];return 0}function ot(u,h,d,a,g){var k=new Uint8Array(32);me(k,a,g,ge);for(var T=new Uint8Array(8),j=0;j<8;j++)T[j]=a[j+16];return it(u,h,d,T,k)}function At(u,h,d,a,g,k,T){var j=new Uint8Array(32);me(j,k,T,ge);for(var V=new Uint8Array(8),le=0;le<8;le++)V[le]=k[le+16];return Te(u,h,d,a,g,V,j)}var vt=function(u){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var h,d,a,g,k,T,j,V;h=u[0]&255|(u[1]&255)<<8,this.r[0]=h&8191,d=u[2]&255|(u[3]&255)<<8,this.r[1]=(h>>>13|d<<3)&8191,a=u[4]&255|(u[5]&255)<<8,this.r[2]=(d>>>10|a<<6)&7939,g=u[6]&255|(u[7]&255)<<8,this.r[3]=(a>>>7|g<<9)&8191,k=u[8]&255|(u[9]&255)<<8,this.r[4]=(g>>>4|k<<12)&255,this.r[5]=k>>>1&8190,T=u[10]&255|(u[11]&255)<<8,this.r[6]=(k>>>14|T<<2)&8191,j=u[12]&255|(u[13]&255)<<8,this.r[7]=(T>>>11|j<<5)&8065,V=u[14]&255|(u[15]&255)<<8,this.r[8]=(j>>>8|V<<8)&8191,this.r[9]=V>>>5&127,this.pad[0]=u[16]&255|(u[17]&255)<<8,this.pad[1]=u[18]&255|(u[19]&255)<<8,this.pad[2]=u[20]&255|(u[21]&255)<<8,this.pad[3]=u[22]&255|(u[23]&255)<<8,this.pad[4]=u[24]&255|(u[25]&255)<<8,this.pad[5]=u[26]&255|(u[27]&255)<<8,this.pad[6]=u[28]&255|(u[29]&255)<<8,this.pad[7]=u[30]&255|(u[31]&255)<<8};vt.prototype.blocks=function(u,h,d){for(var a=this.fin?0:2048,g,k,T,j,V,le,te,Xe,oe,Ae,Ce,Be,De,Re,je,Oe,ae,pe,ie,ce=this.h[0],ue=this.h[1],se=this.h[2],$=this.h[3],P=this.h[4],q=this.h[5],D=this.h[6],L=this.h[7],z=this.h[8],we=this.h[9],Me=this.r[0],Ke=this.r[1],Fe=this.r[2],v=this.r[3],Ve=this.r[4],Ze=this.r[5],Qe=this.r[6],We=this.r[7],Ge=this.r[8],Ye=this.r[9];d>=16;)g=u[h+0]&255|(u[h+1]&255)<<8,ce+=g&8191,k=u[h+2]&255|(u[h+3]&255)<<8,ue+=(g>>>13|k<<3)&8191,T=u[h+4]&255|(u[h+5]&255)<<8,se+=(k>>>10|T<<6)&8191,j=u[h+6]&255|(u[h+7]&255)<<8,$+=(T>>>7|j<<9)&8191,V=u[h+8]&255|(u[h+9]&255)<<8,P+=(j>>>4|V<<12)&8191,q+=V>>>1&8191,le=u[h+10]&255|(u[h+11]&255)<<8,D+=(V>>>14|le<<2)&8191,te=u[h+12]&255|(u[h+13]&255)<<8,L+=(le>>>11|te<<5)&8191,Xe=u[h+14]&255|(u[h+15]&255)<<8,z+=(te>>>8|Xe<<8)&8191,we+=Xe>>>5|a,oe=0,Ae=oe,Ae+=ce*Me,Ae+=ue*(5*Ye),Ae+=se*(5*Ge),Ae+=$*(5*We),Ae+=P*(5*Qe),oe=Ae>>>13,Ae&=8191,Ae+=q*(5*Ze),Ae+=D*(5*Ve),Ae+=L*(5*v),Ae+=z*(5*Fe),Ae+=we*(5*Ke),oe+=Ae>>>13,Ae&=8191,Ce=oe,Ce+=ce*Ke,Ce+=ue*Me,Ce+=se*(5*Ye),Ce+=$*(5*Ge),Ce+=P*(5*We),oe=Ce>>>13,Ce&=8191,Ce+=q*(5*Qe),Ce+=D*(5*Ze),Ce+=L*(5*Ve),Ce+=z*(5*v),Ce+=we*(5*Fe),oe+=Ce>>>13,Ce&=8191,Be=oe,Be+=ce*Fe,Be+=ue*Ke,Be+=se*Me,Be+=$*(5*Ye),Be+=P*(5*Ge),oe=Be>>>13,Be&=8191,Be+=q*(5*We),Be+=D*(5*Qe),Be+=L*(5*Ze),Be+=z*(5*Ve),Be+=we*(5*v),oe+=Be>>>13,Be&=8191,De=oe,De+=ce*v,De+=ue*Fe,De+=se*Ke,De+=$*Me,De+=P*(5*Ye),oe=De>>>13,De&=8191,De+=q*(5*Ge),De+=D*(5*We),De+=L*(5*Qe),De+=z*(5*Ze),De+=we*(5*Ve),oe+=De>>>13,De&=8191,Re=oe,Re+=ce*Ve,Re+=ue*v,Re+=se*Fe,Re+=$*Ke,Re+=P*Me,oe=Re>>>13,Re&=8191,Re+=q*(5*Ye),Re+=D*(5*Ge),Re+=L*(5*We),Re+=z*(5*Qe),Re+=we*(5*Ze),oe+=Re>>>13,Re&=8191,je=oe,je+=ce*Ze,je+=ue*Ve,je+=se*v,je+=$*Fe,je+=P*Ke,oe=je>>>13,je&=8191,je+=q*Me,je+=D*(5*Ye),je+=L*(5*Ge),je+=z*(5*We),je+=we*(5*Qe),oe+=je>>>13,je&=8191,Oe=oe,Oe+=ce*Qe,Oe+=ue*Ze,Oe+=se*Ve,Oe+=$*v,Oe+=P*Fe,oe=Oe>>>13,Oe&=8191,Oe+=q*Ke,Oe+=D*Me,Oe+=L*(5*Ye),Oe+=z*(5*Ge),Oe+=we*(5*We),oe+=Oe>>>13,Oe&=8191,ae=oe,ae+=ce*We,ae+=ue*Qe,ae+=se*Ze,ae+=$*Ve,ae+=P*v,oe=ae>>>13,ae&=8191,ae+=q*Fe,ae+=D*Ke,ae+=L*Me,ae+=z*(5*Ye),ae+=we*(5*Ge),oe+=ae>>>13,ae&=8191,pe=oe,pe+=ce*Ge,pe+=ue*We,pe+=se*Qe,pe+=$*Ze,pe+=P*Ve,oe=pe>>>13,pe&=8191,pe+=q*v,pe+=D*Fe,pe+=L*Ke,pe+=z*Me,pe+=we*(5*Ye),oe+=pe>>>13,pe&=8191,ie=oe,ie+=ce*Ye,ie+=ue*Ge,ie+=se*We,ie+=$*Qe,ie+=P*Ze,oe=ie>>>13,ie&=8191,ie+=q*Ve,ie+=D*v,ie+=L*Fe,ie+=z*Ke,ie+=we*Me,oe+=ie>>>13,ie&=8191,oe=(oe<<2)+oe|0,oe=oe+Ae|0,Ae=oe&8191,oe=oe>>>13,Ce+=oe,ce=Ae,ue=Ce,se=Be,$=De,P=Re,q=je,D=Oe,L=ae,z=pe,we=ie,h+=16,d-=16;this.h[0]=ce,this.h[1]=ue,this.h[2]=se,this.h[3]=$,this.h[4]=P,this.h[5]=q,this.h[6]=D,this.h[7]=L,this.h[8]=z,this.h[9]=we},vt.prototype.finish=function(u,h){var d=new Uint16Array(10),a,g,k,T;if(this.leftover){for(T=this.leftover,this.buffer[T++]=1;T<16;T++)this.buffer[T]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(a=this.h[1]>>>13,this.h[1]&=8191,T=2;T<10;T++)this.h[T]+=a,a=this.h[T]>>>13,this.h[T]&=8191;for(this.h[0]+=a*5,a=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=a,a=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=a,d[0]=this.h[0]+5,a=d[0]>>>13,d[0]&=8191,T=1;T<10;T++)d[T]=this.h[T]+a,a=d[T]>>>13,d[T]&=8191;for(d[9]-=8192,g=(a^1)-1,T=0;T<10;T++)d[T]&=g;for(g=~g,T=0;T<10;T++)this.h[T]=this.h[T]&g|d[T];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,k=this.h[0]+this.pad[0],this.h[0]=k&65535,T=1;T<8;T++)k=(this.h[T]+this.pad[T]|0)+(k>>>16)|0,this.h[T]=k&65535;u[h+0]=this.h[0]>>>0&255,u[h+1]=this.h[0]>>>8&255,u[h+2]=this.h[1]>>>0&255,u[h+3]=this.h[1]>>>8&255,u[h+4]=this.h[2]>>>0&255,u[h+5]=this.h[2]>>>8&255,u[h+6]=this.h[3]>>>0&255,u[h+7]=this.h[3]>>>8&255,u[h+8]=this.h[4]>>>0&255,u[h+9]=this.h[4]>>>8&255,u[h+10]=this.h[5]>>>0&255,u[h+11]=this.h[5]>>>8&255,u[h+12]=this.h[6]>>>0&255,u[h+13]=this.h[6]>>>8&255,u[h+14]=this.h[7]>>>0&255,u[h+15]=this.h[7]>>>8&255},vt.prototype.update=function(u,h,d){var a,g;if(this.leftover){for(g=16-this.leftover,g>d&&(g=d),a=0;a<g;a++)this.buffer[this.leftover+a]=u[h+a];if(d-=g,h+=g,this.leftover+=g,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(d>=16&&(g=d-d%16,this.blocks(u,h,g),h+=g,d-=g),d){for(a=0;a<d;a++)this.buffer[this.leftover+a]=u[h+a];this.leftover+=d}};function ut(u,h,d,a,g,k){var T=new vt(k);return T.update(d,a,g),T.finish(u,h),0}function zt(u,h,d,a,g,k){var T=new Uint8Array(16);return ut(T,0,d,a,g,k),U(u,h,T,0)}function _e(u,h,d,a,g){var k;if(d<32)return-1;for(At(u,0,h,0,d,a,g),ut(u,16,u,32,d-32,u),k=0;k<16;k++)u[k]=0;return 0}function Pe(u,h,d,a,g){var k,T=new Uint8Array(32);if(d<32||(ot(T,0,32,a,g),zt(h,16,h,32,d-32,T)!==0))return-1;for(At(u,0,h,0,d,a,g),k=0;k<32;k++)u[k]=0;return 0}function Se(u,h){var d;for(d=0;d<16;d++)u[d]=h[d]|0}function ne(u){var h,d,a=1;for(h=0;h<16;h++)d=u[h]+a+65535,a=Math.floor(d/65536),u[h]=d-a*65536;u[0]+=a-1+37*(a-1)}function re(u,h,d){for(var a,g=~(d-1),k=0;k<16;k++)a=g&(u[k]^h[k]),u[k]^=a,h[k]^=a}function Ie(u,h){var d,a,g,k=r(),T=r();for(d=0;d<16;d++)T[d]=h[d];for(ne(T),ne(T),ne(T),a=0;a<2;a++){for(k[0]=T[0]-65517,d=1;d<15;d++)k[d]=T[d]-65535-(k[d-1]>>16&1),k[d-1]&=65535;k[15]=T[15]-32767-(k[14]>>16&1),g=k[15]>>16&1,k[14]&=65535,re(T,k,1-g)}for(d=0;d<16;d++)u[2*d]=T[d]&255,u[2*d+1]=T[d]>>8}function qe(u,h){var d=new Uint8Array(32),a=new Uint8Array(32);return Ie(d,u),Ie(a,h),N(d,0,a,0)}function ft(u){var h=new Uint8Array(32);return Ie(h,u),h[0]&1}function ze(u,h){var d;for(d=0;d<16;d++)u[d]=h[2*d]+(h[2*d+1]<<8);u[15]&=32767}function bt(u,h,d){for(var a=0;a<16;a++)u[a]=h[a]+d[a]}function Ee(u,h,d){for(var a=0;a<16;a++)u[a]=h[a]-d[a]}function ye(u,h,d){var a,g,k=0,T=0,j=0,V=0,le=0,te=0,Xe=0,oe=0,Ae=0,Ce=0,Be=0,De=0,Re=0,je=0,Oe=0,ae=0,pe=0,ie=0,ce=0,ue=0,se=0,$=0,P=0,q=0,D=0,L=0,z=0,we=0,Me=0,Ke=0,Fe=0,v=d[0],Ve=d[1],Ze=d[2],Qe=d[3],We=d[4],Ge=d[5],Ye=d[6],Ct=d[7],lt=d[8],St=d[9],Et=d[10],kt=d[11],Pt=d[12],qt=d[13],Ht=d[14],Wt=d[15];a=h[0],k+=a*v,T+=a*Ve,j+=a*Ze,V+=a*Qe,le+=a*We,te+=a*Ge,Xe+=a*Ye,oe+=a*Ct,Ae+=a*lt,Ce+=a*St,Be+=a*Et,De+=a*kt,Re+=a*Pt,je+=a*qt,Oe+=a*Ht,ae+=a*Wt,a=h[1],T+=a*v,j+=a*Ve,V+=a*Ze,le+=a*Qe,te+=a*We,Xe+=a*Ge,oe+=a*Ye,Ae+=a*Ct,Ce+=a*lt,Be+=a*St,De+=a*Et,Re+=a*kt,je+=a*Pt,Oe+=a*qt,ae+=a*Ht,pe+=a*Wt,a=h[2],j+=a*v,V+=a*Ve,le+=a*Ze,te+=a*Qe,Xe+=a*We,oe+=a*Ge,Ae+=a*Ye,Ce+=a*Ct,Be+=a*lt,De+=a*St,Re+=a*Et,je+=a*kt,Oe+=a*Pt,ae+=a*qt,pe+=a*Ht,ie+=a*Wt,a=h[3],V+=a*v,le+=a*Ve,te+=a*Ze,Xe+=a*Qe,oe+=a*We,Ae+=a*Ge,Ce+=a*Ye,Be+=a*Ct,De+=a*lt,Re+=a*St,je+=a*Et,Oe+=a*kt,ae+=a*Pt,pe+=a*qt,ie+=a*Ht,ce+=a*Wt,a=h[4],le+=a*v,te+=a*Ve,Xe+=a*Ze,oe+=a*Qe,Ae+=a*We,Ce+=a*Ge,Be+=a*Ye,De+=a*Ct,Re+=a*lt,je+=a*St,Oe+=a*Et,ae+=a*kt,pe+=a*Pt,ie+=a*qt,ce+=a*Ht,ue+=a*Wt,a=h[5],te+=a*v,Xe+=a*Ve,oe+=a*Ze,Ae+=a*Qe,Ce+=a*We,Be+=a*Ge,De+=a*Ye,Re+=a*Ct,je+=a*lt,Oe+=a*St,ae+=a*Et,pe+=a*kt,ie+=a*Pt,ce+=a*qt,ue+=a*Ht,se+=a*Wt,a=h[6],Xe+=a*v,oe+=a*Ve,Ae+=a*Ze,Ce+=a*Qe,Be+=a*We,De+=a*Ge,Re+=a*Ye,je+=a*Ct,Oe+=a*lt,ae+=a*St,pe+=a*Et,ie+=a*kt,ce+=a*Pt,ue+=a*qt,se+=a*Ht,$+=a*Wt,a=h[7],oe+=a*v,Ae+=a*Ve,Ce+=a*Ze,Be+=a*Qe,De+=a*We,Re+=a*Ge,je+=a*Ye,Oe+=a*Ct,ae+=a*lt,pe+=a*St,ie+=a*Et,ce+=a*kt,ue+=a*Pt,se+=a*qt,$+=a*Ht,P+=a*Wt,a=h[8],Ae+=a*v,Ce+=a*Ve,Be+=a*Ze,De+=a*Qe,Re+=a*We,je+=a*Ge,Oe+=a*Ye,ae+=a*Ct,pe+=a*lt,ie+=a*St,ce+=a*Et,ue+=a*kt,se+=a*Pt,$+=a*qt,P+=a*Ht,q+=a*Wt,a=h[9],Ce+=a*v,Be+=a*Ve,De+=a*Ze,Re+=a*Qe,je+=a*We,Oe+=a*Ge,ae+=a*Ye,pe+=a*Ct,ie+=a*lt,ce+=a*St,ue+=a*Et,se+=a*kt,$+=a*Pt,P+=a*qt,q+=a*Ht,D+=a*Wt,a=h[10],Be+=a*v,De+=a*Ve,Re+=a*Ze,je+=a*Qe,Oe+=a*We,ae+=a*Ge,pe+=a*Ye,ie+=a*Ct,ce+=a*lt,ue+=a*St,se+=a*Et,$+=a*kt,P+=a*Pt,q+=a*qt,D+=a*Ht,L+=a*Wt,a=h[11],De+=a*v,Re+=a*Ve,je+=a*Ze,Oe+=a*Qe,ae+=a*We,pe+=a*Ge,ie+=a*Ye,ce+=a*Ct,ue+=a*lt,se+=a*St,$+=a*Et,P+=a*kt,q+=a*Pt,D+=a*qt,L+=a*Ht,z+=a*Wt,a=h[12],Re+=a*v,je+=a*Ve,Oe+=a*Ze,ae+=a*Qe,pe+=a*We,ie+=a*Ge,ce+=a*Ye,ue+=a*Ct,se+=a*lt,$+=a*St,P+=a*Et,q+=a*kt,D+=a*Pt,L+=a*qt,z+=a*Ht,we+=a*Wt,a=h[13],je+=a*v,Oe+=a*Ve,ae+=a*Ze,pe+=a*Qe,ie+=a*We,ce+=a*Ge,ue+=a*Ye,se+=a*Ct,$+=a*lt,P+=a*St,q+=a*Et,D+=a*kt,L+=a*Pt,z+=a*qt,we+=a*Ht,Me+=a*Wt,a=h[14],Oe+=a*v,ae+=a*Ve,pe+=a*Ze,ie+=a*Qe,ce+=a*We,ue+=a*Ge,se+=a*Ye,$+=a*Ct,P+=a*lt,q+=a*St,D+=a*Et,L+=a*kt,z+=a*Pt,we+=a*qt,Me+=a*Ht,Ke+=a*Wt,a=h[15],ae+=a*v,pe+=a*Ve,ie+=a*Ze,ce+=a*Qe,ue+=a*We,se+=a*Ge,$+=a*Ye,P+=a*Ct,q+=a*lt,D+=a*St,L+=a*Et,z+=a*kt,we+=a*Pt,Me+=a*qt,Ke+=a*Ht,Fe+=a*Wt,k+=38*pe,T+=38*ie,j+=38*ce,V+=38*ue,le+=38*se,te+=38*$,Xe+=38*P,oe+=38*q,Ae+=38*D,Ce+=38*L,Be+=38*z,De+=38*we,Re+=38*Me,je+=38*Ke,Oe+=38*Fe,g=1,a=k+g+65535,g=Math.floor(a/65536),k=a-g*65536,a=T+g+65535,g=Math.floor(a/65536),T=a-g*65536,a=j+g+65535,g=Math.floor(a/65536),j=a-g*65536,a=V+g+65535,g=Math.floor(a/65536),V=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=te+g+65535,g=Math.floor(a/65536),te=a-g*65536,a=Xe+g+65535,g=Math.floor(a/65536),Xe=a-g*65536,a=oe+g+65535,g=Math.floor(a/65536),oe=a-g*65536,a=Ae+g+65535,g=Math.floor(a/65536),Ae=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=Be+g+65535,g=Math.floor(a/65536),Be=a-g*65536,a=De+g+65535,g=Math.floor(a/65536),De=a-g*65536,a=Re+g+65535,g=Math.floor(a/65536),Re=a-g*65536,a=je+g+65535,g=Math.floor(a/65536),je=a-g*65536,a=Oe+g+65535,g=Math.floor(a/65536),Oe=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,k+=g-1+37*(g-1),g=1,a=k+g+65535,g=Math.floor(a/65536),k=a-g*65536,a=T+g+65535,g=Math.floor(a/65536),T=a-g*65536,a=j+g+65535,g=Math.floor(a/65536),j=a-g*65536,a=V+g+65535,g=Math.floor(a/65536),V=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=te+g+65535,g=Math.floor(a/65536),te=a-g*65536,a=Xe+g+65535,g=Math.floor(a/65536),Xe=a-g*65536,a=oe+g+65535,g=Math.floor(a/65536),oe=a-g*65536,a=Ae+g+65535,g=Math.floor(a/65536),Ae=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=Be+g+65535,g=Math.floor(a/65536),Be=a-g*65536,a=De+g+65535,g=Math.floor(a/65536),De=a-g*65536,a=Re+g+65535,g=Math.floor(a/65536),Re=a-g*65536,a=je+g+65535,g=Math.floor(a/65536),je=a-g*65536,a=Oe+g+65535,g=Math.floor(a/65536),Oe=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,k+=g-1+37*(g-1),u[0]=k,u[1]=T,u[2]=j,u[3]=V,u[4]=le,u[5]=te,u[6]=Xe,u[7]=oe,u[8]=Ae,u[9]=Ce,u[10]=Be,u[11]=De,u[12]=Re,u[13]=je,u[14]=Oe,u[15]=ae}function st(u,h){ye(u,h,h)}function mt(u,h){var d=r(),a;for(a=0;a<16;a++)d[a]=h[a];for(a=253;a>=0;a--)st(d,d),a!==2&&a!==4&&ye(d,d,h);for(a=0;a<16;a++)u[a]=d[a]}function rr(u,h){var d=r(),a;for(a=0;a<16;a++)d[a]=h[a];for(a=250;a>=0;a--)st(d,d),a!==1&&ye(d,d,h);for(a=0;a<16;a++)u[a]=d[a]}function Qt(u,h,d){var a=new Uint8Array(32),g=new Float64Array(80),k,T,j=r(),V=r(),le=r(),te=r(),Xe=r(),oe=r();for(T=0;T<31;T++)a[T]=h[T];for(a[31]=h[31]&127|64,a[0]&=248,ze(g,d),T=0;T<16;T++)V[T]=g[T],te[T]=j[T]=le[T]=0;for(j[0]=te[0]=1,T=254;T>=0;--T)k=a[T>>>3]>>>(T&7)&1,re(j,V,k),re(le,te,k),bt(Xe,j,le),Ee(j,j,le),bt(le,V,te),Ee(V,V,te),st(te,Xe),st(oe,j),ye(j,le,j),ye(le,V,Xe),bt(Xe,j,le),Ee(j,j,le),st(V,j),Ee(le,te,oe),ye(j,le,c),bt(j,j,te),ye(le,le,j),ye(j,te,oe),ye(te,V,g),st(V,Xe),re(j,V,k),re(le,te,k);for(T=0;T<16;T++)g[T+16]=j[T],g[T+32]=le[T],g[T+48]=V[T],g[T+64]=te[T];var Ae=g.subarray(32),Ce=g.subarray(16);return mt(Ae,Ae),ye(Ce,Ce,Ae),Ie(u,Ce),0}function _t(u,h){return Qt(u,h,i)}function as(u,h){return s(h,32),_t(u,h)}function b(u,h,d){var a=new Uint8Array(32);return Qt(a,d,h),me(u,n,a,ge)}var S=_e,I=Pe;function W(u,h,d,a,g,k){var T=new Uint8Array(32);return b(T,g,k),S(u,h,d,a,T)}function F(u,h,d,a,g,k){var T=new Uint8Array(32);return b(T,g,k),I(u,h,d,a,T)}var E=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Z(u,h,d,a){for(var g=new Int32Array(16),k=new Int32Array(16),T,j,V,le,te,Xe,oe,Ae,Ce,Be,De,Re,je,Oe,ae,pe,ie,ce,ue,se,$,P,q,D,L,z,we=u[0],Me=u[1],Ke=u[2],Fe=u[3],v=u[4],Ve=u[5],Ze=u[6],Qe=u[7],We=h[0],Ge=h[1],Ye=h[2],Ct=h[3],lt=h[4],St=h[5],Et=h[6],kt=h[7],Pt=0;a>=128;){for(ue=0;ue<16;ue++)se=8*ue+Pt,g[ue]=d[se+0]<<24|d[se+1]<<16|d[se+2]<<8|d[se+3],k[ue]=d[se+4]<<24|d[se+5]<<16|d[se+6]<<8|d[se+7];for(ue=0;ue<80;ue++)if(T=we,j=Me,V=Ke,le=Fe,te=v,Xe=Ve,oe=Ze,Ae=Qe,Ce=We,Be=Ge,De=Ye,Re=Ct,je=lt,Oe=St,ae=Et,pe=kt,$=Qe,P=kt,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=(v>>>14|lt<<18)^(v>>>18|lt<<14)^(lt>>>9|v<<23),P=(lt>>>14|v<<18)^(lt>>>18|v<<14)^(v>>>9|lt<<23),q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,$=v&Ve^~v&Ze,P=lt&St^~lt&Et,q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,$=E[ue*2],P=E[ue*2+1],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,$=g[ue%16],P=k[ue%16],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,ie=L&65535|z<<16,ce=q&65535|D<<16,$=ie,P=ce,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=(we>>>28|We<<4)^(We>>>2|we<<30)^(We>>>7|we<<25),P=(We>>>28|we<<4)^(we>>>2|We<<30)^(we>>>7|We<<25),q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,$=we&Me^we&Ke^Me&Ke,P=We&Ge^We&Ye^Ge&Ye,q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,Ae=L&65535|z<<16,pe=q&65535|D<<16,$=le,P=Re,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=ie,P=ce,q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,le=L&65535|z<<16,Re=q&65535|D<<16,Me=T,Ke=j,Fe=V,v=le,Ve=te,Ze=Xe,Qe=oe,we=Ae,Ge=Ce,Ye=Be,Ct=De,lt=Re,St=je,Et=Oe,kt=ae,We=pe,ue%16===15)for(se=0;se<16;se++)$=g[se],P=k[se],q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=g[(se+9)%16],P=k[(se+9)%16],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,ie=g[(se+1)%16],ce=k[(se+1)%16],$=(ie>>>1|ce<<31)^(ie>>>8|ce<<24)^ie>>>7,P=(ce>>>1|ie<<31)^(ce>>>8|ie<<24)^(ce>>>7|ie<<25),q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,ie=g[(se+14)%16],ce=k[(se+14)%16],$=(ie>>>19|ce<<13)^(ce>>>29|ie<<3)^ie>>>6,P=(ce>>>19|ie<<13)^(ie>>>29|ce<<3)^(ce>>>6|ie<<26),q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,g[se]=L&65535|z<<16,k[se]=q&65535|D<<16;$=we,P=We,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=u[0],P=h[0],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,u[0]=we=L&65535|z<<16,h[0]=We=q&65535|D<<16,$=Me,P=Ge,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=u[1],P=h[1],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,u[1]=Me=L&65535|z<<16,h[1]=Ge=q&65535|D<<16,$=Ke,P=Ye,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=u[2],P=h[2],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,u[2]=Ke=L&65535|z<<16,h[2]=Ye=q&65535|D<<16,$=Fe,P=Ct,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=u[3],P=h[3],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,u[3]=Fe=L&65535|z<<16,h[3]=Ct=q&65535|D<<16,$=v,P=lt,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=u[4],P=h[4],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,u[4]=v=L&65535|z<<16,h[4]=lt=q&65535|D<<16,$=Ve,P=St,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=u[5],P=h[5],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,u[5]=Ve=L&65535|z<<16,h[5]=St=q&65535|D<<16,$=Ze,P=Et,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=u[6],P=h[6],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,u[6]=Ze=L&65535|z<<16,h[6]=Et=q&65535|D<<16,$=Qe,P=kt,q=P&65535,D=P>>>16,L=$&65535,z=$>>>16,$=u[7],P=h[7],q+=P&65535,D+=P>>>16,L+=$&65535,z+=$>>>16,D+=q>>>16,L+=D>>>16,z+=L>>>16,u[7]=Qe=L&65535|z<<16,h[7]=kt=q&65535|D<<16,Pt+=128,a-=128}return a}function G(u,h,d){var a=new Int32Array(8),g=new Int32Array(8),k=new Uint8Array(256),T,j=d;for(a[0]=1779033703,a[1]=3144134277,a[2]=1013904242,a[3]=2773480762,a[4]=1359893119,a[5]=2600822924,a[6]=528734635,a[7]=1541459225,g[0]=4089235720,g[1]=2227873595,g[2]=4271175723,g[3]=1595750129,g[4]=2917565137,g[5]=725511199,g[6]=4215389547,g[7]=327033209,Z(a,g,h,d),d%=128,T=0;T<d;T++)k[T]=h[j-d+T];for(k[d]=128,d=256-128*(d<112?1:0),k[d-9]=0,C(k,d-8,j/536870912|0,j<<3),Z(a,g,k,d),T=0;T<8;T++)C(u,8*T,a[T],g[T]);return 0}function J(u,h){var d=r(),a=r(),g=r(),k=r(),T=r(),j=r(),V=r(),le=r(),te=r();Ee(d,u[1],u[0]),Ee(te,h[1],h[0]),ye(d,d,te),bt(a,u[0],u[1]),bt(te,h[0],h[1]),ye(a,a,te),ye(g,u[3],h[3]),ye(g,g,p),ye(k,u[2],h[2]),bt(k,k,k),Ee(T,a,d),Ee(j,k,g),bt(V,k,g),bt(le,a,d),ye(u[0],T,j),ye(u[1],le,V),ye(u[2],V,j),ye(u[3],T,le)}function K(u,h,d){var a;for(a=0;a<4;a++)re(u[a],h[a],d)}function he(u,h){var d=r(),a=r(),g=r();mt(g,h[2]),ye(d,h[0],g),ye(a,h[1],g),Ie(u,a),u[31]^=ft(d)<<7}function Q(u,h,d){var a,g;for(Se(u[0],o),Se(u[1],l),Se(u[2],l),Se(u[3],o),g=255;g>=0;--g)a=d[g/8|0]>>(g&7)&1,K(u,h,a),J(h,u),J(u,u),K(u,h,a)}function fe(u,h){var d=[r(),r(),r(),r()];Se(d[0],y),Se(d[1],w),Se(d[2],l),ye(d[3],y,w),Q(u,d,h)}function ve(u,h,d){var a=new Uint8Array(64),g=[r(),r(),r(),r()],k;for(d||s(h,32),G(a,h,32),a[0]&=248,a[31]&=127,a[31]|=64,fe(g,a),he(u,g),k=0;k<32;k++)h[k+32]=u[k];return 0}var Ne=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function rt(u,h){var d,a,g,k;for(a=63;a>=32;--a){for(d=0,g=a-32,k=a-12;g<k;++g)h[g]+=d-16*h[a]*Ne[g-(a-32)],d=Math.floor((h[g]+128)/256),h[g]-=d*256;h[g]+=d,h[a]=0}for(d=0,g=0;g<32;g++)h[g]+=d-(h[31]>>4)*Ne[g],d=h[g]>>8,h[g]&=255;for(g=0;g<32;g++)h[g]-=d*Ne[g];for(a=0;a<32;a++)h[a+1]+=h[a]>>8,u[a]=h[a]&255}function Je(u){var h=new Float64Array(64),d;for(d=0;d<64;d++)h[d]=u[d];for(d=0;d<64;d++)u[d]=0;rt(u,h)}function Rt(u,h,d,a){var g=new Uint8Array(64),k=new Uint8Array(64),T=new Uint8Array(64),j,V,le=new Float64Array(64),te=[r(),r(),r(),r()];G(g,a,32),g[0]&=248,g[31]&=127,g[31]|=64;var Xe=d+64;for(j=0;j<d;j++)u[64+j]=h[j];for(j=0;j<32;j++)u[32+j]=g[32+j];for(G(T,u.subarray(32),d+32),Je(T),fe(te,T),he(u,te),j=32;j<64;j++)u[j]=a[j];for(G(k,u,d+64),Je(k),j=0;j<64;j++)le[j]=0;for(j=0;j<32;j++)le[j]=T[j];for(j=0;j<32;j++)for(V=0;V<32;V++)le[j+V]+=k[j]*g[V];return rt(u.subarray(32),le),Xe}function Ut(u,h){var d=r(),a=r(),g=r(),k=r(),T=r(),j=r(),V=r();return Se(u[2],l),ze(u[1],h),st(g,u[1]),ye(k,g,f),Ee(g,g,u[2]),bt(k,u[2],k),st(T,k),st(j,T),ye(V,j,T),ye(d,V,g),ye(d,d,k),rr(d,d),ye(d,d,g),ye(d,d,k),ye(d,d,k),ye(u[0],d,k),st(a,u[0]),ye(a,a,k),qe(a,g)&&ye(u[0],u[0],_),st(a,u[0]),ye(a,a,k),qe(a,g)?-1:(ft(u[0])===h[31]>>7&&Ee(u[0],o,u[0]),ye(u[3],u[0],u[1]),0)}function Ft(u,h,d,a){var g,k=new Uint8Array(32),T=new Uint8Array(64),j=[r(),r(),r(),r()],V=[r(),r(),r(),r()];if(d<64||Ut(V,a))return-1;for(g=0;g<d;g++)u[g]=h[g];for(g=0;g<32;g++)u[g+32]=a[g];if(G(T,u,d),Je(T),Q(j,V,T),fe(V,h.subarray(32)),J(j,V),he(k,j),d-=64,N(h,0,k,0)){for(g=0;g<d;g++)u[g]=0;return-1}for(g=0;g<d;g++)u[g]=h[g+64];return d}var Kt=32,Jt=24,lr=32,wt=16,Dt=32,kr=32,gr=32,Mr=32,Is=32,Tr=Jt,js=lr,gn=wt,sr=64,Gt=32,Ar=64,R=32,m=64;e.lowlevel={crypto_core_hsalsa20:me,crypto_stream_xor:At,crypto_stream:ot,crypto_stream_salsa20_xor:Te,crypto_stream_salsa20:it,crypto_onetimeauth:ut,crypto_onetimeauth_verify:zt,crypto_verify_16:U,crypto_verify_32:N,crypto_secretbox:_e,crypto_secretbox_open:Pe,crypto_scalarmult:Qt,crypto_scalarmult_base:_t,crypto_box_beforenm:b,crypto_box_afternm:S,crypto_box:W,crypto_box_open:F,crypto_box_keypair:as,crypto_hash:G,crypto_sign:Rt,crypto_sign_keypair:ve,crypto_sign_open:Ft,crypto_secretbox_KEYBYTES:Kt,crypto_secretbox_NONCEBYTES:Jt,crypto_secretbox_ZEROBYTES:lr,crypto_secretbox_BOXZEROBYTES:wt,crypto_scalarmult_BYTES:Dt,crypto_scalarmult_SCALARBYTES:kr,crypto_box_PUBLICKEYBYTES:gr,crypto_box_SECRETKEYBYTES:Mr,crypto_box_BEFORENMBYTES:Is,crypto_box_NONCEBYTES:Tr,crypto_box_ZEROBYTES:js,crypto_box_BOXZEROBYTES:gn,crypto_sign_BYTES:sr,crypto_sign_PUBLICKEYBYTES:Gt,crypto_sign_SECRETKEYBYTES:Ar,crypto_sign_SEEDBYTES:R,crypto_hash_BYTES:m,gf:r,D:f,L:Ne,pack25519:Ie,unpack25519:ze,M:ye,A:bt,S:st,Z:Ee,pow2523:rr,add:J,set25519:Se,modL:rt,scalarmult:Q,scalarbase:fe};function A(u,h){if(u.length!==Kt)throw new Error("bad key size");if(h.length!==Jt)throw new Error("bad nonce size")}function He(u,h){if(u.length!==gr)throw new Error("bad public key size");if(h.length!==Mr)throw new Error("bad secret key size")}function be(){for(var u=0;u<arguments.length;u++)if(!(arguments[u]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function xt(u){for(var h=0;h<u.length;h++)u[h]=0}e.randomBytes=function(u){var h=new Uint8Array(u);return s(h,u),h},e.secretbox=function(u,h,d){be(u,h,d),A(d,h);for(var a=new Uint8Array(lr+u.length),g=new Uint8Array(a.length),k=0;k<u.length;k++)a[k+lr]=u[k];return _e(g,a,a.length,h,d),g.subarray(wt)},e.secretbox.open=function(u,h,d){be(u,h,d),A(d,h);for(var a=new Uint8Array(wt+u.length),g=new Uint8Array(a.length),k=0;k<u.length;k++)a[k+wt]=u[k];return a.length<32||Pe(g,a,a.length,h,d)!==0?null:g.subarray(lr)},e.secretbox.keyLength=Kt,e.secretbox.nonceLength=Jt,e.secretbox.overheadLength=wt,e.scalarMult=function(u,h){if(be(u,h),u.length!==kr)throw new Error("bad n size");if(h.length!==Dt)throw new Error("bad p size");var d=new Uint8Array(Dt);return Qt(d,u,h),d},e.scalarMult.base=function(u){if(be(u),u.length!==kr)throw new Error("bad n size");var h=new Uint8Array(Dt);return _t(h,u),h},e.scalarMult.scalarLength=kr,e.scalarMult.groupElementLength=Dt,e.box=function(u,h,d,a){var g=e.box.before(d,a);return e.secretbox(u,h,g)},e.box.before=function(u,h){be(u,h),He(u,h);var d=new Uint8Array(Is);return b(d,u,h),d},e.box.after=e.secretbox,e.box.open=function(u,h,d,a){var g=e.box.before(d,a);return e.secretbox.open(u,h,g)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var u=new Uint8Array(gr),h=new Uint8Array(Mr);return as(u,h),{publicKey:u,secretKey:h}},e.box.keyPair.fromSecretKey=function(u){if(be(u),u.length!==Mr)throw new Error("bad secret key size");var h=new Uint8Array(gr);return _t(h,u),{publicKey:h,secretKey:new Uint8Array(u)}},e.box.publicKeyLength=gr,e.box.secretKeyLength=Mr,e.box.sharedKeyLength=Is,e.box.nonceLength=Tr,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(u,h){if(be(u,h),h.length!==Ar)throw new Error("bad secret key size");var d=new Uint8Array(sr+u.length);return Rt(d,u,u.length,h),d},e.sign.open=function(u,h){if(be(u,h),h.length!==Gt)throw new Error("bad public key size");var d=new Uint8Array(u.length),a=Ft(d,u,u.length,h);if(a<0)return null;for(var g=new Uint8Array(a),k=0;k<g.length;k++)g[k]=d[k];return g},e.sign.detached=function(u,h){for(var d=e.sign(u,h),a=new Uint8Array(sr),g=0;g<a.length;g++)a[g]=d[g];return a},e.sign.detached.verify=function(u,h,d){if(be(u,h,d),h.length!==sr)throw new Error("bad signature size");if(d.length!==Gt)throw new Error("bad public key size");var a=new Uint8Array(sr+u.length),g=new Uint8Array(sr+u.length),k;for(k=0;k<sr;k++)a[k]=h[k];for(k=0;k<u.length;k++)a[k+sr]=u[k];return Ft(g,a,a.length,d)>=0},e.sign.keyPair=function(){var u=new Uint8Array(Gt),h=new Uint8Array(Ar);return ve(u,h),{publicKey:u,secretKey:h}},e.sign.keyPair.fromSecretKey=function(u){if(be(u),u.length!==Ar)throw new Error("bad secret key size");for(var h=new Uint8Array(Gt),d=0;d<h.length;d++)h[d]=u[32+d];return{publicKey:h,secretKey:new Uint8Array(u)}},e.sign.keyPair.fromSeed=function(u){if(be(u),u.length!==R)throw new Error("bad seed size");for(var h=new Uint8Array(Gt),d=new Uint8Array(Ar),a=0;a<32;a++)d[a]=u[a];return ve(h,d,!0),{publicKey:h,secretKey:d}},e.sign.publicKeyLength=Gt,e.sign.secretKeyLength=Ar,e.sign.seedLength=R,e.sign.signatureLength=sr,e.hash=function(u){be(u);var h=new Uint8Array(m);return G(h,u,u.length),h},e.hash.hashLength=m,e.verify=function(u,h){return be(u,h),u.length===0||h.length===0||u.length!==h.length?!1:O(u,0,h,0,u.length)===0},e.setPRNG=function(u){s=u},(function(){var u=typeof self<"u"?self.crypto||self.msCrypto:null;if(u&&u.getRandomValues){var h=65536;e.setPRNG(function(d,a){var g,k=new Uint8Array(a);for(g=0;g<a;g+=h)u.getRandomValues(k.subarray(g,g+Math.min(a-g,h)));for(g=0;g<a;g++)d[g]=k[g];xt(k)})}else typeof Qf<"u"&&(u=rd,u&&u.randomBytes&&e.setPRNG(function(d,a){var g,k=u.randomBytes(a);for(g=0;g<a;g++)d[g]=k[g];xt(k)}))})()})(t.exports?t.exports:self.nacl=self.nacl||{})})(xi)),xi.exports}var nd=sd();const xr=Xf(nd);var jn={exports:{}},id=jn.exports,Zo;function od(){return Zo||(Zo=1,(function(t){(function(e,r){t.exports?t.exports=r():(e.nacl||(e.nacl={}),e.nacl.util=r())})(id,function(){var e={};function r(s){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(s))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(s){if(typeof s!="string")throw new TypeError("expected string");var n,i=unescape(encodeURIComponent(s)),o=new Uint8Array(i.length);for(n=0;n<i.length;n++)o[n]=i.charCodeAt(n);return o},e.encodeUTF8=function(s){var n,i=[];for(n=0;n<s.length;n++)i.push(String.fromCharCode(s[n]));return decodeURIComponent(escape(i.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(s){return Buffer.from(s).toString("base64")},e.decodeBase64=function(s){return r(s),new Uint8Array(Array.prototype.slice.call(Buffer.from(s,"base64"),0))}):(e.encodeBase64=function(s){return new Buffer(s).toString("base64")},e.decodeBase64=function(s){return r(s),new Uint8Array(Array.prototype.slice.call(new Buffer(s,"base64"),0))}):(e.encodeBase64=function(s){var n,i=[],o=s.length;for(n=0;n<o;n++)i.push(String.fromCharCode(s[n]));return btoa(i.join(""))},e.decodeBase64=function(s){r(s);var n,i=atob(s),o=new Uint8Array(i.length);for(n=0;n<i.length;n++)o[n]=i.charCodeAt(n);return o}),e})})(jn)),jn.exports}var Le=od();function Qo(){const t=xr.box.keyPair();return console.log("[KeyGen] Generated X25519 key pair"),console.log("[KeyGen] Public key:",Le.encodeBase64(t.publicKey)),console.log("[KeyGen] Secret key length:",t.secretKey.length,"bytes"),{publicKey:t.publicKey,secretKey:t.secretKey}}function ad(t,e){console.log("[ECDH] Computing shared secret..."),console.log("[ECDH] Our secret key length:",t.length,"bytes"),console.log("[ECDH] Their public key:",Le.encodeBase64(e));const r=xr.box.before(e,t);return console.log("[ECDH] Shared secret computed:",Le.encodeBase64(r)),console.log("[ECDH] Shared secret length:",r.length,"bytes"),r}function rn(t){return xr.hash(t).slice(0,32)}function ld(t,e){for(let r=0;r<t.length;r++){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return 0}function cd(t,e,r){console.log("[ChainDerive] Deriving send/receive chain keys from shared secret...");const s=ld(e,r)<0;console.log("[ChainDerive] Our public key is lexicographically",s?"SMALLER":"LARGER");const n=new Uint8Array(t.length+1);n.set(t),n[t.length]=1;const i=new Uint8Array(t.length+1);i.set(t),i[t.length]=2;const o=rn(n),l=rn(i),c=s?o:l,f=s?l:o;return console.log("[ChainDerive] Send chain key:",Le.encodeBase64(c)),console.log("[ChainDerive] Recv chain key:",Le.encodeBase64(f)),console.log("[ChainDerive] Chain keys derived successfully"),{sendChain:c,recvChain:f}}function Si(t){const e=new Uint8Array(t.length+1);e.set(t),e[t.length]=1;const r=new Uint8Array(t.length+1);r.set(t),r[t.length]=2;const s=rn(e),n=rn(r);return console.log("[Ratchet] Chain key advanced"),console.log("[Ratchet] Previous chain key:",Le.encodeBase64(t)),console.log("[Ratchet] New chain key:     ",Le.encodeBase64(s)),console.log("[Ratchet] Message key:       ",Le.encodeBase64(n)),{nextChainKey:s,messageKey:n}}function Ei(t,e,r){console.log("[DH-Ratchet] Incorporating fresh ECDH into chain..."),console.log("[DH-Ratchet] Their public key:",Le.encodeBase64(r));const s=xr.box.before(r,e);console.log("[DH-Ratchet] DH shared:",Le.encodeBase64(s));const n=new Uint8Array(t.length+s.length);n.set(t),n.set(s,t.length);const i=rn(n);return console.log("[DH-Ratchet] New chain key:",Le.encodeBase64(i)),i}function ud(t,e){console.log("[Encrypt] Encrypting message..."),console.log("[Encrypt] Text:",e.text?`${e.text.length} chars`:"none"),console.log("[Encrypt] Attachments:",e.attachments?.length??0),e.attachments?.forEach((c,f)=>{console.log(`[Encrypt]   [${f}] ${c.type} (${c.mime}), data: ${c.data.length} base64 chars`)}),console.log("[Encrypt] Ratchet key:",e.ratchetKey.slice(0,16)+"..."),console.log("[Encrypt] Message key:",Le.encodeBase64(t));const r=JSON.stringify(e),s=new TextEncoder().encode(r);console.log(`[Encrypt] JSON payload: ${s.length} bytes`);const n=xr.randomBytes(xr.secretbox.nonceLength);console.log("[Encrypt] Nonce:",Le.encodeBase64(n));const i=xr.secretbox(s,n,t),o=new Uint8Array(n.length+i.length);o.set(n),o.set(i,n.length);const l=Le.encodeBase64(o);return console.log(`[Encrypt] Ciphertext: ${i.length} bytes  Base64: ${l.length} chars`),l}function ea(t,e){console.log("[Decrypt] Decrypting message..."),console.log(`[Decrypt] Base64 input: ${e.length} chars`),console.log("[Decrypt] Message key:",Le.encodeBase64(t));const r=Le.decodeBase64(e),s=r.slice(0,xr.secretbox.nonceLength),n=r.slice(xr.secretbox.nonceLength);console.log("[Decrypt] Nonce:",Le.encodeBase64(s)),console.log(`[Decrypt] Ciphertext: ${n.length} bytes`);const i=xr.secretbox.open(n,s,t);if(!i)return console.error("[Decrypt] FAILED  authentication error (wrong key or tampered data)"),null;const o=new TextDecoder().decode(i),l=JSON.parse(o);return console.log("[Decrypt] Success!"),console.log("[Decrypt] Text:",l.text?`${l.text.length} chars`:"none"),console.log("[Decrypt] Attachments:",l.attachments?.length??0),l.attachments?.forEach((c,f)=>{console.log(`[Decrypt]   [${f}] ${c.type} (${c.mime}), data: ${c.data.length} base64 chars`)}),console.log("[Decrypt] Ratchet key:",l.ratchetKey.slice(0,16)+"..."),l}function fd(t){return Le.encodeBase64(t)}function ta(t){return Le.decodeBase64(t)}const dd={key:0,class:"absolute -top-0.5 -right-0.5 w-3 h-3 rounded-full bg-green-500 border-2 border-gray-950"},hd={key:0,class:"fixed inset-0 z-40 flex justify-end"},pd={class:"relative w-full max-w-sm bg-gray-900 border-l border-gray-800 p-5 overflow-y-auto space-y-5"},gd={class:"flex items-center justify-between"},yd={class:"flex items-center gap-2 text-sm"},vd={class:"text-gray-400"},bd={key:0,class:"text-xs text-red-400 bg-red-900/20 rounded-lg p-2"},md={class:"space-y-3"},_d={class:"space-y-1"},wd=["value","disabled"],xd={class:"space-y-1"},Sd=["value","disabled"],Ed=["disabled"],kd={class:"border-t border-gray-800 pt-4 space-y-3"},Td={class:"space-y-1"},Ad={key:0},Cd=["value"],Rd=["value"],Od=["value"],$d={class:"space-y-1"},Pd={key:0},Id=["value"],jd=["value"],Ud=["value"],Dd={class:"space-y-1"},Ld=["value"],Nd={class:"space-y-1"},Bd=["value"],Md={key:0,class:"border-t border-gray-800 pt-4 space-y-3"},Fd={class:"space-y-1"},Kd=["value","disabled"],qd={key:0,disabled:"",class:"w-full py-2 bg-gray-700 text-gray-500 rounded-lg text-sm font-medium cursor-not-allowed"},Hd={key:3,class:"space-y-1"},Wd={key:0,class:"flex items-center gap-2 text-xs text-emerald-400"},Vd={key:1,class:"flex items-center gap-2 text-xs text-yellow-400"},zd=al({__name:"DbSettings",props:{settings:{},connectionState:{},connectionError:{},isConnected:{type:Boolean},isConfigured:{type:Boolean},isSyncing:{type:Boolean},isListening:{type:Boolean},tables:{},columns:{},canSync:{type:Boolean}},emits:["connect","disconnect","startSync","stopSync","update:settings","fetchColumns"],setup(t,{emit:e}){const r=t,s=e,n=tt(!1);function i(l,c){s("update:settings",{...r.settings,[l]:c})}jr(()=>r.settings.table,l=>{l&&r.isConnected&&s("fetchColumns",l)});const o={disconnected:"bg-gray-500",connecting:"bg-yellow-500 animate-pulse",connected:"bg-green-500",error:"bg-red-500"};return(l,c)=>(Y(),X(ht,null,[x("button",{onClick:c[0]||(c[0]=f=>n.value=!n.value),class:"fixed top-[61px] right-4 z-50 w-10 h-10 flex items-center justify-center rounded-full bg-gray-800 border border-gray-700 hover:bg-gray-700 transition-colors cursor-pointer"},[c[16]||(c[16]=x("span",{class:"text-lg"},"",-1)),t.isConnected?(Y(),X("span",dd)):dt("",!0)]),n.value?(Y(),X("div",hd,[x("div",{class:"absolute inset-0 bg-black/40",onClick:c[1]||(c[1]=f=>n.value=!1)}),x("div",pd,[x("div",gd,[c[17]||(c[17]=x("h2",{class:"text-lg font-semibold"},"Supabase Settings",-1)),x("button",{onClick:c[2]||(c[2]=f=>n.value=!1),class:"text-gray-400 hover:text-gray-200 cursor-pointer text-xl"},"")]),x("div",yd,[x("span",{class:Lt(["w-2.5 h-2.5 rounded-full",o[t.connectionState]])},null,2),x("span",vd,et(t.connectionState==="disconnected"?"Not connected":t.connectionState==="connecting"?"Connecting...":t.connectionState==="connected"?"Connected":"Connection error"),1)]),t.connectionError?(Y(),X("div",bd,et(t.connectionError),1)):dt("",!0),x("div",md,[x("div",_d,[c[18]||(c[18]=x("label",{class:"block text-xs text-gray-400"},"Supabase URL",-1)),x("input",{type:"text",value:t.settings.url,onInput:c[3]||(c[3]=f=>i("url",f.target.value)),placeholder:"https://xxx.supabase.co",disabled:t.isConnected,class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500 disabled:opacity-50"},null,40,wd)]),x("div",xd,[c[19]||(c[19]=x("label",{class:"block text-xs text-gray-400"},"Anon Key",-1)),x("input",{type:"password",value:t.settings.anonKey,onInput:c[4]||(c[4]=f=>i("anonKey",f.target.value)),placeholder:"eyJhbGciOiJIUzI1NiIs...",disabled:t.isConnected,class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm font-mono focus:outline-none focus:border-blue-500 disabled:opacity-50"},null,40,Sd)]),t.isConnected?(Y(),X("button",{key:1,onClick:c[6]||(c[6]=f=>s("disconnect")),class:"w-full py-2 bg-red-600 hover:bg-red-500 rounded-lg text-sm font-medium transition-colors cursor-pointer"}," Disconnect ")):(Y(),X("button",{key:0,onClick:c[5]||(c[5]=f=>s("connect")),disabled:!t.settings.url||!t.settings.anonKey||t.connectionState==="connecting",class:"w-full py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-700 disabled:text-gray-500 rounded-lg text-sm font-medium transition-colors cursor-pointer disabled:cursor-not-allowed"}," Connect ",8,Ed))]),t.isConnected?(Y(),X(ht,{key:1},[x("div",kd,[c[27]||(c[27]=x("h3",{class:"text-sm font-medium text-gray-300"},"Table & Column",-1)),x("div",Td,[c[21]||(c[21]=x("label",{class:"block text-xs text-gray-400"},"Table name",-1)),t.tables.length>0?(Y(),X("div",Ad,[x("select",{value:t.settings.table,onChange:c[7]||(c[7]=f=>i("table",f.target.value)),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},[c[20]||(c[20]=x("option",{value:""},"-- select table --",-1)),(Y(!0),X(ht,null,qr(t.tables,f=>(Y(),X("option",{key:f,value:f},et(f),9,Rd))),128))],40,Cd)])):(Y(),X("input",{key:1,type:"text",value:t.settings.table,onInput:c[8]||(c[8]=f=>i("table",f.target.value)),placeholder:"messages",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},null,40,Od))]),x("div",$d,[c[23]||(c[23]=x("label",{class:"block text-xs text-gray-400"},"Message column",-1)),t.columns.length>0?(Y(),X("div",Pd,[x("select",{value:t.settings.column,onChange:c[9]||(c[9]=f=>i("column",f.target.value)),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},[c[22]||(c[22]=x("option",{value:""},"-- select column --",-1)),(Y(!0),X(ht,null,qr(t.columns,f=>(Y(),X("option",{key:f,value:f},et(f),9,jd))),128))],40,Id)])):(Y(),X("input",{key:1,type:"text",value:t.settings.column,onInput:c[10]||(c[10]=f=>i("column",f.target.value)),placeholder:"payload",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},null,40,Ud))]),x("div",Dd,[c[24]||(c[24]=x("label",{class:"block text-xs text-gray-400"},"ID column (primary key)",-1)),x("input",{type:"text",value:t.settings.idColumn,onInput:c[11]||(c[11]=f=>i("idColumn",f.target.value)),placeholder:"id",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},null,40,Ld)]),x("div",Nd,[c[25]||(c[25]=x("label",{class:"block text-xs text-gray-400"},"Sender column (for server-side filtering)",-1)),x("input",{type:"text",value:t.settings.senderColumn,onInput:c[12]||(c[12]=f=>i("senderColumn",f.target.value)),placeholder:"sender",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},null,40,Bd),c[26]||(c[26]=x("p",{class:"text-xs text-gray-600"},"Leave empty to skip server-side filtering",-1))])]),t.isConfigured?(Y(),X("div",Md,[c[32]||(c[32]=x("h3",{class:"text-sm font-medium text-gray-300"},"Message Sync",-1)),x("div",Fd,[c[29]||(c[29]=x("label",{class:"block text-xs text-gray-400"},"Poll interval (used when Realtime is unavailable)",-1)),x("select",{value:t.settings.pollInterval,onChange:c[13]||(c[13]=f=>i("pollInterval",Number(f.target.value))),disabled:t.isSyncing,class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500 disabled:opacity-50"},[...c[28]||(c[28]=[x("option",{value:1e4},"10 seconds",-1),x("option",{value:15e3},"15 seconds",-1),x("option",{value:2e4},"20 seconds",-1),x("option",{value:3e4},"30 seconds",-1),x("option",{value:6e4},"1 minute",-1),x("option",{value:12e4},"2 minutes",-1)])],40,Kd)]),t.canSync?t.isSyncing?(Y(),X("button",{key:2,onClick:c[15]||(c[15]=f=>s("stopSync")),class:"w-full py-2 bg-yellow-600 hover:bg-yellow-500 rounded-lg text-sm font-medium transition-colors cursor-pointer"}," Stop Sync ")):(Y(),X("button",{key:1,onClick:c[14]||(c[14]=f=>s("startSync")),class:"w-full py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg text-sm font-medium transition-colors cursor-pointer"}," Start Sync ")):(Y(),X("button",qd," Complete handshake first ")),t.isSyncing?(Y(),X("div",Hd,[t.isListening?(Y(),X("div",Wd,[...c[30]||(c[30]=[x("span",{class:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"},null,-1),en(" Realtime active + backup poll every 5 min ",-1)])])):(Y(),X("div",Vd,[c[31]||(c[31]=x("span",{class:"w-2 h-2 rounded-full bg-yellow-500 animate-pulse"},null,-1)),en(" Polling every "+et(t.settings.pollInterval/1e3)+"s (Realtime unavailable) ",1)]))])):dt("",!0)])):dt("",!0),c[33]||(c[33]=x("div",{class:"border-t border-gray-800 pt-4 space-y-2"},[x("details",{class:"text-xs text-gray-500"},[x("summary",{class:"cursor-pointer hover:text-gray-300"},"SQL for table setup & RPC functions"),x("pre",{class:"mt-2 bg-gray-800 rounded-lg p-3 overflow-x-auto text-gray-400 whitespace-pre"},`-- Create a messages table
CREATE TABLE messages (
  id BIGSERIAL PRIMARY KEY,
  payload TEXT,
  sender TEXT  -- fingerprint for server-side filtering
);

-- Index for fast sender filtering
CREATE INDEX idx_messages_sender ON messages (sender);

-- Enable RLS and allow all operations
ALTER TABLE messages ENABLE ROW LEVEL SECURITY;
CREATE POLICY "allow_all" ON messages
  FOR ALL USING (true) WITH CHECK (true);

-- Enable Realtime (instant delivery via WebSocket)
ALTER PUBLICATION supabase_realtime ADD TABLE messages;

-- Optional: RPC to list tables
CREATE OR REPLACE FUNCTION list_tables()
RETURNS TABLE(table_name text) AS $$
  SELECT table_name::text
  FROM information_schema.tables
  WHERE table_schema = 'public'
    AND table_type = 'BASE TABLE'
$$ LANGUAGE sql SECURITY DEFINER;

-- Optional: RPC to list columns
CREATE OR REPLACE FUNCTION list_columns(p_table text)
RETURNS TABLE(column_name text) AS $$
  SELECT column_name::text
  FROM information_schema.columns
  WHERE table_schema = 'public'
    AND table_name = p_table
$$ LANGUAGE sql SECURITY DEFINER;`)])],-1))],64)):dt("",!0)])])):dt("",!0)],64))}});function ni(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function Jd(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(p){try{f(s.next(p))}catch(y){o(y)}}function c(p){try{f(s.throw(p))}catch(y){o(y)}}function f(p){p.done?i(p.value):n(p.value).then(l,c)}f((s=s.apply(t,e||[])).next())})}const Gd=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class ho extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class Yd extends ho{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ra extends ho{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class sa extends ho{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Fi;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Fi||(Fi={}));class Xd{constructor(e,{headers:r={},customFetch:s,region:n=Fi.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=Gd(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Jd(this,arguments,void 0,function*(r,s={}){var n;let i,o;try{const{headers:l,method:c,body:f,signal:p,timeout:y}=s;let w={},{region:_}=s;_||(_=this.region);const C=new URL(`${this.url}/${r}`);_&&_!=="any"&&(w["x-region"]=_,C.searchParams.set("forceFunctionRegion",_));let O;f&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(w["Content-Type"]="application/octet-stream",O=f):typeof f=="string"?(w["Content-Type"]="text/plain",O=f):typeof FormData<"u"&&f instanceof FormData?O=f:(w["Content-Type"]="application/json",O=JSON.stringify(f)):f&&typeof f!="string"&&!(typeof Blob<"u"&&f instanceof Blob)&&!(f instanceof ArrayBuffer)&&!(typeof FormData<"u"&&f instanceof FormData)?O=JSON.stringify(f):O=f;let U=p;y&&(o=new AbortController,i=setTimeout(()=>o.abort(),y),p?(U=o.signal,p.addEventListener("abort",()=>o.abort())):U=o.signal);const N=yield this.fetch(C.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},w),this.headers),l),body:O,signal:U}).catch(me=>{throw new Yd(me)}),H=N.headers.get("x-relay-error");if(H&&H==="true")throw new ra(N);if(!N.ok)throw new sa(N);let B=((n=N.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),M;return B==="application/json"?M=yield N.json():B==="application/octet-stream"||B==="application/pdf"?M=yield N.blob():B==="text/event-stream"?M=N:B==="multipart/form-data"?M=yield N.formData():M=yield N.text(),{data:M,error:null,response:N}}catch(l){return{data:null,error:l,response:l instanceof sa||l instanceof ra?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var Zd=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},Qd=class{constructor(t){var e,r,s;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(s=t.urlLengthLimit)!==null&&s!==void 0?s:8e3,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,l=null,c=null,f=i.status,p=i.statusText;if(i.ok){var y,w;if(r.method!=="HEAD"){var _;const N=await i.text();N===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((_=r.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?l=N:l=JSON.parse(N))}const O=(y=r.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),U=(w=i.headers.get("content-range"))===null||w===void 0?void 0:w.split("/");O&&U&&U.length>1&&(c=parseInt(U[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,f=406,p="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var C;const O=await i.text();try{o=JSON.parse(O),Array.isArray(o)&&i.status===404&&(l=[],o=null,f=200,p="OK")}catch{i.status===404&&O===""?(f=204,p="No Content"):o={message:O}}if(o&&r.isMaybeSingle&&(!(o==null||(C=o.details)===null||C===void 0)&&C.includes("0 rows"))&&(o=null,f=200,p="OK"),o&&r.shouldThrowOnError)throw new Zd(o)}return{error:o,data:l,count:c,status:f,statusText:p}});return this.shouldThrowOnError||(n=n.catch(i=>{var o;let l="",c="",f="";const p=i?.cause;if(p){var y,w,_,C;const N=(y=p?.message)!==null&&y!==void 0?y:"",H=(w=p?.code)!==null&&w!==void 0?w:"";l=`${(_=i?.name)!==null&&_!==void 0?_:"FetchError"}: ${i?.message}`,l+=`

Caused by: ${(C=p?.name)!==null&&C!==void 0?C:"Error"}: ${N}`,H&&(l+=` (${H})`),p?.stack&&(l+=`
${p.stack}`)}else{var O;l=(O=i?.stack)!==null&&O!==void 0?O:""}const U=this.url.toString().length;return i?.name==="AbortError"||i?.code==="ABORT_ERR"?(f="",c="Request was aborted (timeout or manual cancellation)",U>this.urlLengthLimit&&(c+=`. Note: Your request URL is ${U} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(p?.name==="HeadersOverflowError"||p?.code==="UND_ERR_HEADERS_OVERFLOW")&&(f="",c="HTTP headers exceeded server limits (typically 16KB)",U>this.urlLengthLimit&&(c+=`. Your request URL is ${U} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(o=i?.name)!==null&&o!==void 0?o:"FetchError"}: ${i?.message}`,details:l,hint:c,code:f},data:null,count:null,status:0,statusText:""}})),n.then(t,e)}returns(){return this}overrideTypes(){return this}},eh=class extends Qd{select(t){let e=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const i=n?`${n}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,e?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const na=new RegExp("[,()]");var vs=class extends eh{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&na.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&na.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${n}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},th=class{constructor(t,{headers:e={},schema:r,fetch:s,urlLengthLimit:n=8e3}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=s,this.urlLengthLimit=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:r=!1,count:s}=e??{},n=r?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(f=>/\s/.test(f)&&!i?"":(f==='"'&&(i=!i),f)).join(""),{url:l,headers:c}=this.cloneRequestState();return l.searchParams.set("select",o),s&&c.append("Prefer",`count=${s}`),new vs({method:n,url:l,headers:c,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(t,{count:e,defaultToNull:r=!0}={}){var s;const n="POST",{url:i,headers:o}=this.cloneRequestState();if(e&&o.append("Prefer",`count=${e}`),r||o.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,f)=>c.concat(Object.keys(f)),[]);if(l.length>0){const c=[...new Set(l)].map(f=>`"${f}"`);i.searchParams.set("columns",c.join(","))}}return new vs({method:n,url:i,headers:o,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){var i;const o="POST",{url:l,headers:c}=this.cloneRequestState();if(c.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&l.searchParams.set("on_conflict",e),s&&c.append("Prefer",`count=${s}`),n||c.append("Prefer","missing=default"),Array.isArray(t)){const f=t.reduce((p,y)=>p.concat(Object.keys(y)),[]);if(f.length>0){const p=[...new Set(f)].map(y=>`"${y}"`);l.searchParams.set("columns",p.join(","))}}return new vs({method:o,url:l,headers:c,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}update(t,{count:e}={}){var r;const s="PATCH",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new vs({method:s,url:n,headers:i,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:t}={}){var e;const r="DELETE",{url:s,headers:n}=this.cloneRequestState();return t&&n.append("Prefer",`count=${t}`),new vs({method:r,url:s,headers:n,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function sn(t){"@babel/helpers - typeof";return sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sn(t)}function rh(t,e){if(sn(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(sn(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sh(t){var e=rh(t,"string");return sn(e)=="symbol"?e:e+""}function nh(t,e,r){return(e=sh(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ia(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function wn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ia(Object(r),!0).forEach(function(s){nh(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ia(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}var ih=class Bl{constructor(e,{headers:r={},schema:s,fetch:n,timeout:i,urlLengthLimit:o=8e3}={}){this.url=e,this.headers=new Headers(r),this.schemaName=s,this.urlLengthLimit=o;const l=n??globalThis.fetch;i!==void 0&&i>0?this.fetch=(c,f)=>{const p=new AbortController,y=setTimeout(()=>p.abort(),i),w=f?.signal;if(w){if(w.aborted)return clearTimeout(y),l(c,f);const _=()=>{clearTimeout(y),p.abort()};return w.addEventListener("abort",_,{once:!0}),l(c,wn(wn({},f),{},{signal:p.signal})).finally(()=>{clearTimeout(y),w.removeEventListener("abort",_)})}return l(c,wn(wn({},f),{},{signal:p.signal})).finally(()=>clearTimeout(y))}:this.fetch=l}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new th(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new Bl(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,r={},{head:s=!1,get:n=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let f;const p=_=>_!==null&&typeof _=="object"&&(!Array.isArray(_)||_.some(p)),y=s&&Object.values(r).some(p);y?(l="POST",f=r):s||n?(l=s?"HEAD":"GET",Object.entries(r).filter(([_,C])=>C!==void 0).map(([_,C])=>[_,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([_,C])=>{c.searchParams.append(_,C)})):(l="POST",f=r);const w=new Headers(this.headers);return y?w.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&w.set("Prefer",`count=${i}`),new vs({method:l,url:c,headers:w,schema:this.schemaName,body:f,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}};class oh{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const s=r.versions;if(s&&s.node){const n=s.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const ah="2.95.3",lh=`realtime-js/${ah}`,ch="1.0.0",Ml="2.0.0",oa=Ml,Ki=1e4,uh=1e3,fh=100;var Hr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Hr||(Hr={}));var It;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(It||(It={}));var dr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(dr||(dr={}));var qi;(function(t){t.websocket="websocket"})(qi||(qi={}));var rs;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(rs||(rs={}));class dh{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,r,s){var n,i;const o=e.topic,l=(n=e.ref)!==null&&n!==void 0?n:"",c=(i=e.join_ref)!==null&&i!==void 0?i:"",f=e.payload.event,p=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},y=Object.keys(p).length===0?"":JSON.stringify(p);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`metadata length ${y.length} exceeds maximum of 255`);const w=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+f.length+y.length,_=new ArrayBuffer(this.HEADER_LENGTH+w);let C=new DataView(_),O=0;C.setUint8(O++,this.KINDS.userBroadcastPush),C.setUint8(O++,c.length),C.setUint8(O++,l.length),C.setUint8(O++,o.length),C.setUint8(O++,f.length),C.setUint8(O++,y.length),C.setUint8(O++,r),Array.from(c,N=>C.setUint8(O++,N.charCodeAt(0))),Array.from(l,N=>C.setUint8(O++,N.charCodeAt(0))),Array.from(o,N=>C.setUint8(O++,N.charCodeAt(0))),Array.from(f,N=>C.setUint8(O++,N.charCodeAt(0))),Array.from(y,N=>C.setUint8(O++,N.charCodeAt(0)));var U=new Uint8Array(_.byteLength+s.byteLength);return U.set(new Uint8Array(_),0),U.set(new Uint8Array(s),_.byteLength),U.buffer}decode(e,r){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return r(s)}if(typeof e=="string"){const s=JSON.parse(e),[n,i,o,l,c]=s;return r({join_ref:n,ref:i,topic:o,event:l,payload:c})}return r({})}_binaryDecode(e){const r=new DataView(e),s=r.getUint8(0),n=new TextDecoder;if(s===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,r,n)}_decodeUserBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const f=s.decode(e.slice(c,c+n));c=c+n;const p=s.decode(e.slice(c,c+i));c=c+i;const y=s.decode(e.slice(c,c+o));c=c+o;const w=e.slice(c,e.byteLength),_=l===this.JSON_ENCODING?JSON.parse(s.decode(w)):w,C={type:this.BROADCAST_EVENT,event:p,payload:_};return o>0&&(C.meta=JSON.parse(y)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:C}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>r.includes(s)))}}class Fl{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var gt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(gt||(gt={}));const aa=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=hh(o,t,e,n),i),{}):{}},hh=(t,e,r,s)=>{const n=e.find(l=>l.name===t),i=n?.type,o=r[t];return i&&!s.includes(i)?Kl(i,o):Hi(o)},Kl=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return vh(e,r)}switch(t){case gt.bool:return ph(e);case gt.float4:case gt.float8:case gt.int2:case gt.int4:case gt.int8:case gt.numeric:case gt.oid:return gh(e);case gt.json:case gt.jsonb:return yh(e);case gt.timestamp:return bh(e);case gt.abstime:case gt.date:case gt.daterange:case gt.int4range:case gt.int8range:case gt.money:case gt.reltime:case gt.text:case gt.time:case gt.timestamptz:case gt.timetz:case gt.tsrange:case gt.tstzrange:return Hi(e);default:return Hi(e)}},Hi=t=>t,ph=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},gh=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},yh=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},vh=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Kl(e,l))}return t},bh=t=>typeof t=="string"?t.replace(" ","T"):t,ql=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class ki{constructor(e,r,s={},n=Ki){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var la;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(la||(la={}));class zs{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=zs.syncState(this.state,n,i,o),this.pendingDiffs.forEach(c=>{this.state=zs.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=zs.syncDiff(this.state,n,i,o),l())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),l={},c={};return this.map(i,(f,p)=>{o[f]||(c[f]=p)}),this.map(o,(f,p)=>{const y=i[f];if(y){const w=p.map(U=>U.presence_ref),_=y.map(U=>U.presence_ref),C=p.filter(U=>_.indexOf(U.presence_ref)<0),O=y.filter(U=>w.indexOf(U.presence_ref)<0);C.length>0&&(l[f]=C),O.length>0&&(c[f]=O)}else l[f]=p}),this.syncDiff(i,{joins:l,leaves:c},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(l,c)=>{var f;const p=(f=e[l])!==null&&f!==void 0?f:[];if(e[l]=this.cloneDeep(c),p.length>0){const y=e[l].map(_=>_.presence_ref),w=p.filter(_=>y.indexOf(_.presence_ref)<0);e[l].unshift(...w)}s(l,p,c)}),this.map(o,(l,c)=>{let f=e[l];if(!f)return;const p=c.map(y=>y.presence_ref);f=f.filter(y=>p.indexOf(y.presence_ref)<0),e[l]=f,n(l,f,c),f.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ca;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(ca||(ca={}));var Js;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Js||(Js={}));var Or;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Or||(Or={}));class ws{constructor(e,r={config:{}},s){var n,i;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=It.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ki(this,dr.join,this.params,this.timeout),this.rejoinTimer=new Fl(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=It.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=It.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this._on(dr.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new zs(this),this.broadcastEndpointURL=ql(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==It.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,f=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(_=>_.filter))!==null&&n!==void 0?n:[],p=!!this.bindings[Js.PRESENCE]&&this.bindings[Js.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,y={},w={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:p}),postgres_changes:f,private:c};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(_=>e?.(Or.CHANNEL_ERROR,_)),this._onClose(()=>e?.(Or.CLOSED)),this.updateJoinPayload(Object.assign({config:w},y)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var C;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){e?.(Or.SUBSCRIBED);return}else{const O=this.bindings.postgres_changes,U=(C=O?.length)!==null&&C!==void 0?C:0,N=[];for(let H=0;H<U;H++){const B=O[H],{filter:{event:M,schema:me,table:ge,filter:Te}}=B,it=_&&_[H];if(it&&it.event===M&&ws.isFilterValueEqual(it.schema,me)&&ws.isFilterValueEqual(it.table,ge)&&ws.isFilterValueEqual(it.filter,Te))N.push(Object.assign(Object.assign({},B),{id:it.id}));else{this.unsubscribe(),this.state=It.errored,e?.(Or.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=N,e&&e(Or.SUBSCRIBED);return}}).receive("error",_=>{this.state=It.errored,e?.(Or.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{e?.(Or.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===It.joined&&e===Js.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const f=await l.json();c=f.error||f.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=f.body)===null||n===void 0?void 0:n.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const f=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),f.receive("ok",()=>i("ok")),f.receive("error",()=>i("error")),f.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=It.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(dr.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new ki(this,dr.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=It.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new ki(this,e,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>fh){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:f,join:p}=dr;if(s&&[l,c,f,p].indexOf(o)>=0&&s!==this._joinRef())return;let w=this._onMessage(o,r,s);if(r&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(_=>{var C,O,U;return((C=_.filter)===null||C===void 0?void 0:C.event)==="*"||((U=(O=_.filter)===null||O===void 0?void 0:O.event)===null||U===void 0?void 0:U.toLocaleLowerCase())===o}).map(_=>_.callback(w,s)):(i=this.bindings[o])===null||i===void 0||i.filter(_=>{var C,O,U,N,H,B;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in _){const M=_.id,me=(C=_.filter)===null||C===void 0?void 0:C.event;return M&&((O=r.ids)===null||O===void 0?void 0:O.includes(M))&&(me==="*"||me?.toLocaleLowerCase()===((U=r.data)===null||U===void 0?void 0:U.type.toLocaleLowerCase()))}else{const M=(H=(N=_?.filter)===null||N===void 0?void 0:N.event)===null||H===void 0?void 0:H.toLocaleLowerCase();return M==="*"||M===((B=r?.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===o}).map(_=>{if(typeof w=="object"&&"ids"in w){const C=w.data,{schema:O,table:U,commit_timestamp:N,type:H,errors:B}=C;w=Object.assign(Object.assign({},{schema:O,table:U,commit_timestamp:N,eventType:H,new:{},old:{},errors:B}),this._getPayloadRecords(C))}_.callback(w,s)})}_isClosed(){return this.state===It.closed}_isJoined(){return this.state===It.joined}_isJoining(){return this.state===It.joining}_isLeaving(){return this.state===It.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&ws.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(dr.close,{},e)}_onError(e){this._on(dr.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=It.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=aa(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=aa(e.columns,e.old_record)),r}}const Ti=()=>{},xn={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},mh=[1e3,2e3,5e3,1e4],_h=1e4,wh=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class xh{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ki,this.transport=null,this.heartbeatIntervalMs=xn.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ti,this.ref=0,this.reconnectTimer=null,this.vsn=oa,this.logger=Ti,this.conn=null,this.sendBuffer=[],this.serializer=new dh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),!(!((s=r?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${qi.websocket}`,this.httpEndpoint=ql(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=oh.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return r==="ok"&&this._remove(e),this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Hr.connecting:return rs.Connecting;case Hr.open:return rs.Open;case Hr.closing:return rs.Closing;default:return rs.Closed}}isConnected(){return this.connectionState()===rs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new ws(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(uh,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},xn.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const f=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",f)}catch(p){this.log("error","error in heartbeat callback",p)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:n,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),i),this.channels.filter(f=>f._isMember(s)).forEach(f=>f._trigger(n,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Hr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Hr.open||this.conn.readyState===Hr.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(dr.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([wh],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,s=!1;if(e)r=e,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:lh};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(dr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Fl(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},xn.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,n,i,o,l,c,f,p,y,w,_;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:Ki,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:xn.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:Ti,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:oa,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(C=>mh[C-1]||_h),this.vsn){case ch:this.encode=(p=e?.encode)!==null&&p!==void 0?p:((C,O)=>O(JSON.stringify(C))),this.decode=(y=e?.decode)!==null&&y!==void 0?y:((C,O)=>O(JSON.parse(C)));break;case Ml:this.encode=(w=e?.encode)!==null&&w!==void 0?w:this.serializer.encode.bind(this.serializer),this.decode=(_=e?.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var nn=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Sh(t,e,r){const s=new URL(e,t);if(r)for(const[n,i]of Object.entries(r))i!==void 0&&s.searchParams.set(n,i);return s.toString()}async function Eh(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function kh(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:n,body:i,headers:o}){const l=Sh(t.baseUrl,s,n),c=await Eh(t.auth),f=await e(l,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...c,...o},body:i?JSON.stringify(i):void 0}),p=await f.text(),y=(f.headers.get("content-type")||"").includes("application/json"),w=y&&p?JSON.parse(p):p;if(!f.ok){const _=y?w:void 0,C=_?.error;throw new nn(C?.message??`Request failed with status ${f.status}`,{status:f.status,icebergType:C?.type,icebergCode:C?.code,details:_})}return{status:f.status,headers:f.headers,data:w}}}}function Sn(t){return t.join("")}var Th=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Sn(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Sn(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Sn(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Sn(t.namespace)}`}),!0}catch(e){if(e instanceof nn&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof nn&&r.status===409)return;throw r}}};function cs(t){return t.join("")}var Ah=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${cs(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${cs(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${cs(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${cs(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${cs(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${cs(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof nn&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof nn&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},Ch=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=kh({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new Th(this.client,e),this.tableOps=new Ah(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},ii=class extends Error{constructor(t,e="storage",r,s){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=s}};function oi(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var En=class extends ii{constructor(t,e,r,s="storage"){super(t,s,e,r),this.name=s==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Hl=class extends ii{constructor(t,e,r="storage"){super(t,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const Rh=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Oh=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Wi=t=>{if(Array.isArray(t))return t.map(r=>Wi(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=Wi(s)}),e},$h=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function on(t){"@babel/helpers - typeof";return on=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},on(t)}function Ph(t,e){if(on(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(on(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ih(t){var e=Ph(t,"string");return on(e)=="symbol"?e:e+""}function jh(t,e,r){return(e=Ih(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ua(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function ke(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ua(Object(r),!0).forEach(function(s){jh(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ua(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const fa=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},Uh=async(t,e,r,s)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const n=t,i=n.status||500;if(typeof n.json=="function")n.json().then(o=>{const l=o?.statusCode||o?.code||i+"";e(new En(fa(o),i,l,s))}).catch(()=>{if(s==="vectors"){const o=i+"";e(new En(n.statusText||`HTTP ${i} error`,i,o,s))}else{const o=i+"";e(new En(n.statusText||`HTTP ${i} error`,i,o,s))}});else{const o=i+"";e(new En(n.statusText||`HTTP ${i} error`,i,o,s))}}else e(new Hl(fa(t),t,s))},Dh=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"||t==="HEAD"||!s?ke(ke({},n),r):(Oh(s)?(n.headers=ke({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(s)):n.body=s,e?.duplex&&(n.duplex=e.duplex),ke(ke({},n),r))};async function Ls(t,e,r,s,n,i,o){return new Promise((l,c)=>{t(r,Dh(e,s,n,i)).then(f=>{if(!f.ok)throw f;if(s?.noResolveJson)return f;if(o==="vectors"){const p=f.headers.get("content-type");if(f.headers.get("content-length")==="0"||f.status===204)return{};if(!p||!p.includes("application/json"))return{}}return f.json()}).then(f=>l(f)).catch(f=>Uh(f,c,s,o))})}function Wl(t="storage"){return{get:async(e,r,s,n)=>Ls(e,"GET",r,s,n,void 0,t),post:async(e,r,s,n,i)=>Ls(e,"POST",r,n,i,s,t),put:async(e,r,s,n,i)=>Ls(e,"PUT",r,n,i,s,t),head:async(e,r,s,n)=>Ls(e,"HEAD",r,ke(ke({},s),{},{noResolveJson:!0}),n,void 0,t),remove:async(e,r,s,n,i)=>Ls(e,"DELETE",r,n,i,s,t)}}const Lh=Wl("storage"),{get:an,post:fr,put:Vi,head:Nh,remove:po}=Lh,ir=Wl("vectors");var Ps=class{constructor(t,e={},r,s="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=Rh(r),this.namespace=s}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(oi(r))return{data:null,error:r};throw r}}},Bh=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(oi(e))return{data:null,error:e};throw e}}};let Vl;Vl=Symbol.toStringTag;var Mh=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[Vl]="BlobDownloadBuilder",this.promise=null}asStream(){return new Bh(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(oi(e))return{data:null,error:e};throw e}}};const Fh={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},da={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Kh=class extends Ps{constructor(t,e={},r,s){super(t,e,s,"storage"),this.bucketId=r}async uploadOrUpdate(t,e,r,s){var n=this;return n.handleOperation(async()=>{let i;const o=ke(ke({},da),s);let l=ke(ke({},n.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",n.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",n.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=n.toBase64(n.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s?.headers&&(l=ke(ke({},l),s.headers));const f=n._removeEmptyFolders(e),p=n._getFinalPath(f),y=await(t=="PUT"?Vi:fr)(n.fetch,`${n.url}/object/${p}`,i,ke({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{path:f,id:y.Id,fullPath:y.Key}})}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,s){var n=this;const i=n._removeEmptyFolders(t),o=n._getFinalPath(i),l=new URL(n.url+`/object/upload/sign/${o}`);return l.searchParams.set("token",e),n.handleOperation(async()=>{let c;const f=ke({upsert:da.upsert},s),p=ke(ke({},n.headers),{"x-upsert":String(f.upsert)});return typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",f.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",f.cacheControl)):(c=r,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType),{path:i,fullPath:(await Vi(n.fetch,l.toString(),c,{headers:p})).Key}})}async createSignedUploadUrl(t,e){var r=this;return r.handleOperation(async()=>{let s=r._getFinalPath(t);const n=ke({},r.headers);e?.upsert&&(n["x-upsert"]="true");const i=await fr(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(r.url+i.url),l=o.searchParams.get("token");if(!l)throw new ii("No token returned by API");return{signedUrl:o.toString(),path:t,token:l}})}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var s=this;return s.handleOperation(async()=>await fr(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:s.headers}))}async copy(t,e,r){var s=this;return s.handleOperation(async()=>({path:(await fr(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:s.headers})).Key}))}async createSignedUrl(t,e,r){var s=this;return s.handleOperation(async()=>{let n=s._getFinalPath(t),i=await fr(s.fetch,`${s.url}/object/sign/${n}`,ke({expiresIn:e},r?.transform?{transform:r.transform}:{}),{headers:s.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${s.url}${i.signedURL}${o}`)}})}async createSignedUrls(t,e,r){var s=this;return s.handleOperation(async()=>{const n=await fr(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return n.map(o=>ke(ke({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${i}`):null}))})}download(t,e,r){const s=typeof e?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(e?.transform||{}),i=n?`?${n}`:"",o=this._getFinalPath(t),l=()=>an(this.fetch,`${this.url}/${s}/${o}${i}`,{headers:this.headers,noResolveJson:!0},r);return new Mh(l,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);return e.handleOperation(async()=>Wi(await an(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})))}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await Nh(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(oi(s)&&s instanceof Hl){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const r=this._getFinalPath(t),s=[],n=e?.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);const i=typeof e?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(e?.transform||{});o!==""&&s.push(o);let l=s.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${l}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await po(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,r){var s=this;return s.handleOperation(async()=>{const n=ke(ke(ke({},Fh),e),{},{prefix:t||""});return await fr(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},r)})}async listV2(t,e){var r=this;return r.handleOperation(async()=>{const s=ke({},t);return await fr(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const qh="2.95.3",pn={"X-Client-Info":`storage-js/${qh}`};var Hh=class extends Ps{constructor(t,e={},r,s){const n=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase."));const i=n.href.replace(/\/$/,""),o=ke(ke({},pn),e);super(i,o,r,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const r=e.listBucketOptionsToQueryString(t);return await an(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await an(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var r=this;return r.handleOperation(async()=>await fr(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}))}async updateBucket(t,e){var r=this;return r.handleOperation(async()=>await Vi(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await fr(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await po(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},Wh=class extends Ps{constructor(t,e={},r){const s=t.replace(/\/$/,""),n=ke(ke({},pn),e);super(s,n,r,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await fr(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const s=r.toString(),n=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return await an(e.fetch,n,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await po(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!$h(t))throw new ii("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Ch({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(n,i){const o=n[i];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(n,l),error:null}}catch(c){if(s)throw c;return{data:null,error:c}}}}})}},Vh=class extends Ps{constructor(t,e={},r){const s=t.replace(/\/$/,""),n=ke(ke({},pn),{},{"Content-Type":"application/json"},e);super(s,n,r,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var r=this;return r.handleOperation(async()=>await ir.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var r=this;return r.handleOperation(async()=>await ir.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{})}},zh=class extends Ps{constructor(t,e={},r){const s=t.replace(/\/$/,""),n=ke(ke({},pn),{},{"Content-Type":"application/json"},e);super(s,n,r,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},Jh=class extends Ps{constructor(t,e={},r){const s=t.replace(/\/$/,""),n=ke(ke({},pn),{},{"Content-Type":"application/json"},e);super(s,n,r,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},Gh=class extends Jh{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new Yh(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},Yh=class extends Vh{constructor(t,e,r,s){super(t,e,s),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,ke(ke({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,ke(ke({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new Xh(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Xh=class extends zh{constructor(t,e,r,s,n){super(t,e,n),this.vectorBucketName=r,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,ke(ke({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,ke(ke({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,ke(ke({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,ke(ke({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,ke(ke({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Zh=class extends Hh{constructor(t,e={},r,s){super(t,e,r,s)}from(t){return new Kh(this.url,this.headers,t,this.fetch)}get vectors(){return new Gh(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Wh(this.url+"/iceberg",this.headers,this.fetch)}};const zl="2.95.3",bs=30*1e3,zi=3,Ai=zi*bs,Qh="http://localhost:9999",e0="supabase.auth.token",t0={"X-Client-Info":`gotrue-js/${zl}`},Ji="X-Supabase-Api-Version",Jl={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},r0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,s0=600*1e3;class ln extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function de(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class n0 extends ln{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function i0(t){return de(t)&&t.name==="AuthApiError"}class ss extends ln{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Br extends ln{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class nr extends Br{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ci(t){return de(t)&&t.name==="AuthSessionMissingError"}class us extends Br{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class kn extends Br{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Tn extends Br{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function o0(t){return de(t)&&t.name==="AuthImplicitGrantRedirectError"}class ha extends Br{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class a0 extends Br{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Gi extends Br{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ri(t){return de(t)&&t.name==="AuthRetryableFetchError"}class pa extends Br{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Yi extends Br{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ga=` 	
\r=`.split(""),l0=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ga.length;e+=1)t[ga[e].charCodeAt(0)]=-2;for(let e=0;e<Kn.length;e+=1)t[Kn[e].charCodeAt(0)]=e;return t})();function ya(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Kn[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Kn[s]),e.queuedBits-=6}}function Gl(t,e,r){const s=l0[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function va(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{f0(o,s,r)};for(let o=0;o<t.length;o+=1)Gl(t.charCodeAt(o),n,i);return e.join("")}function c0(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function u0(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}c0(s,e)}}function f0(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Rs(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)Gl(t.charCodeAt(n),r,s);return new Uint8Array(e)}function d0(t){const e=[];return u0(t,r=>e.push(r)),new Uint8Array(e)}function ns(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>ya(n,r,s)),ya(null,r,s),e.join("")}function h0(t){return Math.round(Date.now()/1e3)+t}function p0(){return Symbol("auth-callback")}const Bt=()=>typeof window<"u"&&typeof document<"u",Zr={tested:!1,writable:!1},Yl=()=>{if(!Bt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zr.tested)return Zr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Zr.tested=!0,Zr.writable=!0}catch{Zr.tested=!0,Zr.writable=!1}return Zr.writable};function g0(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const Xl=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),y0=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ms=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Qr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Nt=async(t,e)=>{await t.removeItem(e)};class ai{constructor(){this.promise=new ai.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}ai.promiseConstructor=Promise;function An(t){const e=t.split(".");if(e.length!==3)throw new Yi("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!r0.test(e[s]))throw new Yi("JWT not in base64url format");return{header:JSON.parse(va(e[0])),payload:JSON.parse(va(e[1])),signature:Rs(e[2]),raw:{header:e[0],payload:e[1]}}}async function v0(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function b0(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function m0(t){return("0"+t.toString(16)).substr(-2)}function _0(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,m0).join("")}async function w0(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function x0(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await w0(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function fs(t,e,r=!1){const s=_0();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await ms(t,`${e}-code-verifier`,n);const i=await x0(s);return[i,s===i?"plain":"s256"]}const S0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function E0(t){const e=t.headers.get(Ji);if(!e||!e.match(S0))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function k0(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function T0(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const A0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ds(t){if(!A0.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Oi(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function C0(t,e){return new Proxy(t,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,n)}})}function ba(t){return JSON.parse(JSON.stringify(t))}const ts=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),R0=[502,503,504];async function ma(t){var e;if(!y0(t))throw new Gi(ts(t),0);if(R0.includes(t.status))throw new Gi(ts(t),t.status);let r;try{r=await t.json()}catch(i){throw new ss(ts(i),i)}let s;const n=E0(t);if(n&&n.getTime()>=Jl["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new pa(ts(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new nr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new pa(ts(r),t.status,r.weak_password.reasons);throw new n0(ts(r),t.status||500,s)}const O0=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function xe(t,e,r,s){var n;const i=Object.assign({},s?.headers);i[Ji]||(i[Ji]=Jl["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await $0(t,e,r+l,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(c):{data:Object.assign({},c),error:null}}async function $0(t,e,r,s,n,i){const o=O0(e,s,n,i);let l;try{l=await t(r,Object.assign({},o))}catch(c){throw console.error(c),new Gi(ts(c),0)}if(l.ok||await ma(l),s?.noResolveJson)return l;try{return await l.json()}catch(c){await ma(c)}}function ur(t){var e;let r=null;j0(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=h0(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function _a(t){const e=ur(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Wr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function P0(t){return{data:t,error:null}}function I0(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=ni(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function wa(t){return t}function j0(t){return t.access_token&&t.refresh_token&&t.expires_in}const $i=["global","local","others"];class U0{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=Xl(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=$i[0]){if($i.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$i.join(", ")}`);try{return await xe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(de(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await xe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Wr})}catch(s){if(de(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=ni(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await xe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:I0,redirectTo:r?.redirectTo})}catch(r){if(de(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await xe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Wr})}catch(r){if(de(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,l,c;try{const f={nextPage:null,lastPage:0,total:0},p=await xe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:wa});if(p.error)throw p.error;const y=await p.json(),w=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(c=(l=p.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return _.length>0&&(_.forEach(C=>{const O=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),U=JSON.parse(C.split(";")[1].split("=")[1]);f[`${U}Page`]=O}),f.total=parseInt(w)),{data:Object.assign(Object.assign({},y),f),error:null}}catch(f){if(de(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){ds(e);try{return await xe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Wr})}catch(r){if(de(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){ds(e);try{return await xe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Wr})}catch(s){if(de(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){ds(e);try{return await xe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Wr})}catch(s){if(de(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){ds(e.userId);try{const{data:r,error:s}=await xe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(de(r))return{data:null,error:r};throw r}}async _deleteFactor(e){ds(e.userId),ds(e.id);try{return{data:await xe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,n,i,o,l,c;try{const f={nextPage:null,lastPage:0,total:0},p=await xe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:wa});if(p.error)throw p.error;const y=await p.json(),w=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(c=(l=p.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return _.length>0&&(_.forEach(C=>{const O=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),U=JSON.parse(C.split(";")[1].split("=")[1]);f[`${U}Page`]=O}),f.total=parseInt(w)),{data:Object.assign(Object.assign({},y),f),error:null}}catch(f){if(de(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(e){try{return await xe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(de(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await xe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(de(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await xe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(de(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await xe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await xe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(de(r))return{data:null,error:r};throw r}}}function xa(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const hs={debug:!!(globalThis&&Yl()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Zl extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class D0 extends Zl{}async function L0(t,e,r){hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),hs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new D0(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(hs.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function N0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Ql(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function B0(t){return parseInt(t,16)}function M0(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function F0(t){var e;const{chainId:r,domain:s,expirationTime:n,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:f,scheme:p,uri:y,version:w}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!y)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(w!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${w}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const _=Ql(t.address),C=p?`${p}://${s}`:s,O=t.statement?`${t.statement}
`:"",U=`${C} wants you to sign in with your Ethereum account:
${_}

${O}`;let N=`URI: ${y}
Version: ${w}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(n&&(N+=`
Expiration Time: ${n.toISOString()}`),l&&(N+=`
Not Before: ${l.toISOString()}`),c&&(N+=`
Request ID: ${c}`),f){let H=`
Resources:`;for(const B of f){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);H+=`
- ${B}`}N+=H}return`${U}
${N}`}class Ot extends Error{constructor({message:e,code:r,cause:s,name:n}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=n??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class qn extends Ot{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function K0({error:t,options:e}){var r,s,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ot({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ot({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Ot({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ot({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Ot({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Ot({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Ot({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Ot({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(ec(o)){if(i.rp.id!==o)return new Ot({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ot({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Ot({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Ot({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ot({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function q0({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ot({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Ot({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(ec(s)){if(r.rpId!==s)return new Ot({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ot({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Ot({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ot({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class H0{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const W0=new H0;function V0(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,n=ni(t,["challenge","user","excludeCredentials"]),i=Rs(e).buffer,o=Object.assign(Object.assign({},r),{id:Rs(r.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:i,user:o});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const f=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},f),{id:Rs(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return l}function z0(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=ni(t,["challenge","allowCredentials"]),n=Rs(e).buffer,i=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:Rs(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function J0(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:ns(new Uint8Array(t.response.attestationObject)),clientDataJSON:ns(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function G0(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:ns(new Uint8Array(n.authenticatorData)),clientDataJSON:ns(new Uint8Array(n.clientDataJSON)),signature:ns(new Uint8Array(n.signature)),userHandle:n.userHandle?ns(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function ec(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Sa(){var t,e;return!!(Bt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Y0(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qn("Browser returned unexpected credential type",e)}:{data:null,error:new qn("Empty credential response",e)}}catch(e){return{data:null,error:K0({error:e,options:t})}}}async function X0(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qn("Browser returned unexpected credential type",e)}:{data:null,error:new qn("Empty credential response",e)}}catch(e){return{data:null,error:q0({error:e,options:t})}}}const Z0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Q0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Hn(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of t)if(n)for(const i in n){const o=n[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(r(o))s[i]=o;else if(e(o)){const l=s[i];e(l)?s[i]=Hn(l,o):s[i]=Hn(o)}else s[i]=o}return s}function ep(t,e){return Hn(Z0,t,e||{})}function tp(t,e){return Hn(Q0,t,e||{})}class rp{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:n},i){var o;try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!l)return{data:null,error:c};const f=n??W0.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:p}=l.webauthn.credential_options.publicKey;if(!p.name){const y=s;if(y)p.name=`${p.id}:${y}`;else{const _=(await this.client.getUser()).data.user,C=((o=_?.user_metadata)===null||o===void 0?void 0:o.name)||_?.email||_?.id||"User";p.name=`${p.id}:${C}`}}p.displayName||(p.displayName=p.name)}switch(l.webauthn.type){case"create":{const p=ep(l.webauthn.credential_options.publicKey,i?.create),{data:y,error:w}=await Y0({publicKey:p,signal:f});return y?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:y}},error:null}:{data:null,error:w}}case"request":{const p=tp(l.webauthn.credential_options.publicKey,i?.request),{data:y,error:w}=await X0(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:p,signal:f}));return y?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:y}},error:null}:{data:null,error:w}}}}catch(l){return de(l)?{data:null,error:l}:{data:null,error:new ss("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new ln("rpId is required for WebAuthn authentication")};try{if(!Sa())return{data:null,error:new ss("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(o){return de(o)?{data:null,error:o}:{data:null,error:new ss("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new ln("rpId is required for WebAuthn registration")};try{if(!Sa())return{data:null,error:new ss("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(p=>{var y;return(y=p.data)===null||y===void 0?void 0:y.all.find(w=>w.factor_type==="webauthn"&&w.friendly_name===e&&w.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:l};const{data:c,error:f}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:f}}catch(o){return de(o)?{data:null,error:o}:{data:null,error:new ss("Unexpected error in register",o)}}}}N0();const sp={url:Qh,storageKey:e0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:t0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Ea(t,e,r){return await r()}const ps={};class cn{get jwks(){var e,r;return(r=(e=ps[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){ps[this.storageKey]=Object.assign(Object.assign({},ps[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=ps[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ps[this.storageKey]=Object.assign(Object.assign({},ps[this.storageKey]),{cachedAt:e})}constructor(e){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},sp),e);if(this.storageKey=i.storageKey,this.instanceID=(r=cn.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,cn.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Bt()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new U0({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Xl(i.fetch),this.lock=i.lock||Ea,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&Bt()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=L0:this.lock=Ea,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new rp(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Yl()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=xa(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=xa(this.memoryStorage)),Bt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o);try{await this._notifyAllSubscribers(o.data.event,o.data.session,!1)}catch(l){this._debug("#broadcastChannel","error",l)}})}this.initialize().catch(o=>{this._debug("#initialize()","error",o)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${zl}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(Bt()&&(r=g0(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),Bt()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),o0(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return de(r)?this._returnResult({error:r}):this._returnResult({error:new ss("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:ur}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:f,session:c},error:null})}catch(i){if(de(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:p,password:y,options:w}=e;let _=null,C=null;this.flowType==="pkce"&&([_,C]=await fs(this.storage,this.storageKey)),i=await xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:w?.emailRedirectTo,body:{email:p,password:y,data:(r=w?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:w?.captchaToken},code_challenge:_,code_challenge_method:C},xform:ur})}else if("phone"in e){const{phone:p,password:y,options:w}=e;i=await xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:y,data:(s=w?.data)!==null&&s!==void 0?s:{},channel:(n=w?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:w?.captchaToken}},xform:ur})}else throw new kn("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return await Nt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:f,session:c},error:null})}catch(i){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),de(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:l}=e;r=await xe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:_a})}else if("phone"in e){const{phone:i,password:o,options:l}=e;r=await xe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:_a})}else throw new kn("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const i=new us;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(de(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,n,i,o,l,c,f,p,y,w;let _,C;if("message"in e)_=e.message,C=e.signature;else{const{chain:O,wallet:U,statement:N,options:H}=e;let B;if(Bt())if(typeof U=="object")B=U;else{const ot=window;if("ethereum"in ot&&typeof ot.ethereum=="object"&&"request"in ot.ethereum&&typeof ot.ethereum.request=="function")B=ot.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof U!="object"||!H?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=U}const M=new URL((r=H?.url)!==null&&r!==void 0?r:window.location.href),me=await B.request({method:"eth_requestAccounts"}).then(ot=>ot).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!me||me.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const ge=Ql(me[0]);let Te=(s=H?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!Te){const ot=await B.request({method:"eth_chainId"});Te=B0(ot)}const it={domain:M.host,address:ge,statement:N,uri:M.href,version:"1",chainId:Te,nonce:(n=H?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(o=(i=H?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=H?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=H?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(f=H?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(p=H?.signInWithEthereum)===null||p===void 0?void 0:p.resources};_=F0(it),C=await B.request({method:"personal_sign",params:[M0(_),ge]})}try{const{data:O,error:U}=await xe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:C},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:ur});if(U)throw U;if(!O||!O.session||!O.user){const N=new us;return this._returnResult({data:{user:null,session:null},error:N})}return O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),this._returnResult({data:Object.assign({},O),error:U})}catch(O){if(de(O))return this._returnResult({data:{user:null,session:null},error:O});throw O}}async signInWithSolana(e){var r,s,n,i,o,l,c,f,p,y,w,_;let C,O;if("message"in e)C=e.message,O=e.signature;else{const{chain:U,wallet:N,statement:H,options:B}=e;let M;if(Bt())if(typeof N=="object")M=N;else{const ge=window;if("solana"in ge&&typeof ge.solana=="object"&&("signIn"in ge.solana&&typeof ge.solana.signIn=="function"||"signMessage"in ge.solana&&typeof ge.solana.signMessage=="function"))M=ge.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!B?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=N}const me=new URL((r=B?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in M&&M.signIn){const ge=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B?.signInWithSolana),{version:"1",domain:me.host,uri:me.href}),H?{statement:H}:null));let Te;if(Array.isArray(ge)&&ge[0]&&typeof ge[0]=="object")Te=ge[0];else if(ge&&typeof ge=="object"&&"signedMessage"in ge&&"signature"in ge)Te=ge;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Te&&"signature"in Te&&(typeof Te.signedMessage=="string"||Te.signedMessage instanceof Uint8Array)&&Te.signature instanceof Uint8Array)C=typeof Te.signedMessage=="string"?Te.signedMessage:new TextDecoder().decode(Te.signedMessage),O=Te.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");C=[`${me.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...H?["",H,""]:[""],"Version: 1",`URI: ${me.href}`,`Issued At: ${(n=(s=B?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=B?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((o=B?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((l=B?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((c=B?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((f=B?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((y=(p=B?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||y===void 0)&&y.length?["Resources",...B.signInWithSolana.resources.map(Te=>`- ${Te}`)]:[]].join(`
`);const ge=await M.signMessage(new TextEncoder().encode(C),"utf8");if(!ge||!(ge instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");O=ge}}try{const{data:U,error:N}=await xe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:C,signature:ns(O)},!((w=e.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:ur});if(N)throw N;if(!U||!U.session||!U.user){const H=new us;return this._returnResult({data:{user:null,session:null},error:H})}return U.session&&(await this._saveSession(U.session),await this._notifyAllSubscribers("SIGNED_IN",U.session)),this._returnResult({data:Object.assign({},U),error:N})}catch(U){if(de(U))return this._returnResult({data:{user:null,session:null},error:U});throw U}}async _exchangeCodeForSession(e){const r=await Qr(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new a0;const{data:i,error:o}=await xe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ur});if(await Nt(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new us;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),de(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,l=await xe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:ur}),{data:c,error:f}=l;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!c||!c.session||!c.user){const p=new us;return this._returnResult({data:{user:null,session:null},error:p})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:f})}catch(r){if(de(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if("email"in e){const{email:l,options:c}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await fs(this.storage,this.storageKey));const{error:y}=await xe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(s=c?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:y})}if("phone"in e){const{phone:l,options:c}=e,{data:f,error:p}=await xe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c?.data)!==null&&n!==void 0?n:{},create_user:(i=c?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:p})}throw new kn("You must provide either an email or phone number.")}catch(l){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),de(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await xe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:ur});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,f=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:f,session:c},error:null})}catch(n){if(de(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,s,n,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await fs(this.storage,this.storageKey));const f=await xe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:P0});return!((i=f.data)===null||i===void 0)&&i.url&&Bt()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(l){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),de(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new nr;const{error:n}=await xe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(de(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await xe(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:l}=await xe(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new kn("You must provide either an email or phone number and a type")}catch(r){if(de(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Qr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Ai:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Qr(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Oi()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=C0(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await xe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Wr}):await this._useSession(async r=>{var s,n,i;const{data:o,error:l}=r;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new nr}:await xe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Wr})})}catch(r){if(de(r))return Ci(r)&&(await this._removeSession(),await Nt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new nr;const o=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await fs(this.storage,this.storageKey));const{data:f,error:p}=await xe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Wr});if(p)throw p;return o.user=f.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),de(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new nr;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:o}=An(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(de(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:l}=r;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new nr;const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(de(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!Bt())throw new Tn("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Tn(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ha("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Tn("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ha("No code detected.");const{data:H,error:B}=await this._exchangeCodeForSession(e.code);if(B)throw B;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:H.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:f}=e;if(!i||!l||!o||!f)throw new Tn("No session defined in URL");const p=Math.round(Date.now()/1e3),y=parseInt(l);let w=p+y;c&&(w=parseInt(c));const _=w-p;_*1e3<=bs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${y}s`);const C=w-y;p-C>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",C,w,p):p-C<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",C,w,p);const{data:O,error:U}=await this._getUser(i);if(U)throw U;const N={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:y,expires_at:w,refresh_token:o,token_type:f,user:O.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:N,redirectType:e.type},error:null})}catch(s){if(de(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Qr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i&&!Ci(i))return this._returnResult({error:i});const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(i0(l)&&(l.status===404||l.status===401||l.status===403)||Ci(l)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await Nt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=p0(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await fs(this.storage,this.storageKey,!0));try{return await xe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),de(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(de(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,l,c,f,p;const{data:y,error:w}=i;if(w)throw w;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await xe(this.fetch,"GET",_,{headers:this.headers,jwt:(p=(f=y.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(n)throw n;return Bt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:e.provider,url:s?.url},error:null})}catch(s){if(de(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:i}}=r;if(n)throw n;const{options:o,provider:l,token:c,access_token:f,nonce:p}=e,y=await xe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:f,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:ur}),{data:w,error:_}=y;return _?this._returnResult({data:{user:null,session:null},error:_}):!w||!w.session||!w.user?this._returnResult({data:{user:null,session:null},error:new us}):(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("USER_UPDATED",w.session)),this._returnResult({data:w,error:_}))}catch(n){if(await Nt(this.storage,`${this.storageKey}-code-verifier`),de(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await xe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(de(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await b0(async n=>(n>0&&await v0(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await xe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ur})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Ri(i)&&Date.now()+o-s<bs})}catch(s){if(this._debug(r,"error",s),de(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),Bt()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Qr(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Qr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await ms(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o?.user)!==null&&e!==void 0?e:Oi()}else if(n&&!n.user&&!n.user){const o=await Qr(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await Nt(this.storage,this.storageKey+"-user"),await ms(this.storage,this.storageKey,n)):n.user=Oi()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ai;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Ai}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),Ri(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(n.access_token);!l&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new nr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new ai;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new nr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(n,"error",i),de(i)){const o={data:null,error:i};return Ri(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Nt(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await ms(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=ba(n);await ms(this.storage,this.storageKey,i)}else{const n=ba(r);await ms(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Nt(this.storage,this.storageKey),await Nt(this.storage,this.storageKey+"-code-verifier"),await Nt(this.storage,this.storageKey+"-user"),this.userStorage&&await Nt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Bt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),bs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/bs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${bs}ms, refresh threshold is ${zi} ticks`),n<=zi&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Zl)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Bt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await fs(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(l.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?this._returnResult({data:null,error:i}):await xe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(de(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:f}=await xe(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return f?this._returnResult({data:null,error:f}):(e.factorType==="totp"&&c.type==="totp"&&(!((n=c?.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(de(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?J0(e.webauthn.credential_response):G0(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await xe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(de(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await xe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:V0(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:z0(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(de(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=r?.factors)!==null&&e!==void 0?e:[])n.all.push(i),i.status==="verified"&&n[i.factor_type].push(i);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(e){var r,s,n,i;if(e)try{const{payload:_}=An(e);let C=null;_.aal&&(C=_.aal);let O=C;const{data:{user:U},error:N}=await this.getUser(e);if(N)return this._returnResult({data:null,error:N});((s=(r=U?.factors)===null||r===void 0?void 0:r.filter(M=>M.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(O="aal2");const B=_.amr||[];return{data:{currentLevel:C,nextLevel:O,currentAuthenticationMethods:B},error:null}}catch(_){if(de(_))return this._returnResult({data:null,error:_});throw _}const{data:{session:o},error:l}=await this.getSession();if(l)return this._returnResult({data:null,error:l});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=An(o.access_token);let f=null;c.aal&&(f=c.aal);let p=f;((i=(n=o.user.factors)===null||n===void 0?void 0:n.filter(_=>_.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(p="aal2");const w=c.amr||[];return{data:{currentLevel:f,nextLevel:p,currentAuthenticationMethods:w},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await xe(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new nr})})}catch(r){if(de(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new nr});const o=await xe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Bt()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new nr});const o=await xe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Bt()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;return s?this._returnResult({data:null,error:s}):r?await xe(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new nr})})}catch(e){if(de(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?(await xe(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new nr})})}catch(r){if(de(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(l=>l.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+s0>n)return s;const{data:i,error:o}=await xe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:_,error:C}=await this.getSession();if(C||!_.session)return this._returnResult({data:null,error:C});s=_.session.access_token}const{header:n,payload:i,signature:o,raw:{header:l,payload:c}}=An(s);r?.allowExpired||k0(i.exp);const f=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!f){const{error:_}=await this.getUser(s);if(_)throw _;return{data:{claims:i,header:n,signature:o},error:null}}const p=T0(n.alg),y=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,y,o,d0(`${l}.${c}`)))throw new Yi("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}}}cn.nextInstanceID={};const np=cn,ip="2.95.3";let Bs="";typeof Deno<"u"?Bs="deno":typeof document<"u"?Bs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bs="react-native":Bs="node";const op={"X-Client-Info":`supabase-js-${Bs}/${ip}`},ap={headers:op},lp={schema:"public"},cp={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},up={};function un(t){"@babel/helpers - typeof";return un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},un(t)}function fp(t,e){if(un(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(un(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dp(t){var e=fp(t,"string");return un(e)=="symbol"?e:e+""}function hp(t,e,r){return(e=dp(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ka(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function Tt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ka(Object(r),!0).forEach(function(s){hp(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ka(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const pp=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),gp=()=>Headers,yp=(t,e,r)=>{const s=pp(r),n=gp();return async(i,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let f=new n(o?.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${c}`),s(i,Tt(Tt({},o),{},{headers:f}))}};function vp(t){return t.endsWith("/")?t:t+"/"}function bp(t,e){var r,s;const{db:n,auth:i,realtime:o,global:l}=t,{db:c,auth:f,realtime:p,global:y}=e,w={db:Tt(Tt({},c),n),auth:Tt(Tt({},f),i),realtime:Tt(Tt({},p),o),storage:{},global:Tt(Tt(Tt({},y),l),{},{headers:Tt(Tt({},(r=y?.headers)!==null&&r!==void 0?r:{}),(s=l?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?w.accessToken=t.accessToken:delete w.accessToken,w}function mp(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(vp(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var _p=class extends np{constructor(t){super(t)}},wp=class{constructor(t,e,r){var s,n;this.supabaseUrl=t,this.supabaseKey=e;const i=mp(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,l={db:lp,realtime:up,auth:Tt(Tt({},cp),{},{storageKey:o}),global:ap},c=bp(r??{},l);if(this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=c.global.headers)!==null&&n!==void 0?n:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(p,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}});else{var f;this.auth=this._initSupabaseAuthClient((f=c.auth)!==null&&f!==void 0?f:{},this.headers,c.global.fetch)}this.fetch=yp(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Tt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new ih(new URL("rest/v1",i).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch,timeout:c.db.timeout,urlLengthLimit:c.db.urlLengthLimit}),this.storage=new Zh(this.storageUrl.href,this.headers,this.fetch,r?.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new Xd(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:i,flowType:o,lock:l,debug:c,throwOnError:f},p,y){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new _p({url:this.authUrl.href,headers:Tt(Tt({},w),p),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,flowType:o,lock:l,debug:c,throwOnError:f,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new xh(this.realtimeUrl.href,Tt(Tt({},t),{},{params:Tt(Tt({},{apikey:this.supabaseKey}),t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e?.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const xp=(t,e,r)=>new wp(t,e,r);function Sp(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const r=e.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Sp()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ta=300*1e3,Cn=75e4,Ep=300*1e3,kp={url:"",anonKey:"",table:"",column:"",idColumn:"id",senderColumn:"sender",pollInterval:3e4};function Tp(t){const e=In("xchat-db-settings",{...kp}),r=tt("disconnected"),s=tt(""),n=tt([]),i=tt([]);let o=null,l=null,c=null;const f=mr(()=>r.value==="connected"),p=mr(()=>f.value&&e.value.table!==""&&e.value.column!==""&&e.value.idColumn!==""),y=tt(!1),w=tt(!1),_=tt(null),C=new Map;function O(){const ne=Date.now();for(const[re,Ie]of C)if(ne-Ie.receivedAt>Ep){console.warn(`[Supabase] Chunk buffer expired for mid=${re} (${Ie.chunks.size}/${Ie.total} received)`);for(const qe of Ie.pks)ot(qe);C.delete(re)}}async function U(){r.value="connecting",s.value="";try{const ne=new URL(e.value.url),re=ne.pathname.split("/").filter(Boolean);re.length>0&&(e.value.table||(e.value.table=re[0]),e.value.url=ne.origin,console.log(`[Supabase] Auto-parsed URL  base: ${e.value.url}, table: ${e.value.table}`)),o&&(await o.auth.signOut().catch(()=>{}),o=null),o=xp(e.value.url,e.value.anonKey,{auth:{storageKey:`xchat-${Math.random().toString(36).slice(2,8)}`,persistSession:!1}});const{error:Ie}=await o.auth.getSession();if(Ie)throw new Error(Ie.message);return r.value="connected",console.log("[Supabase] Connected to",e.value.url),await H(),!0}catch(ne){return r.value="error",s.value=ne.message,o=null,console.error("[Supabase] Connection failed:",ne.message),!1}}function N(){Se(),o=null,r.value="disconnected",s.value="",n.value=[],i.value=[],C.clear(),console.log("[Supabase] Disconnected")}async function H(){if(o)try{const{data:ne,error:re}=await o.rpc("list_tables");if(re)throw re;n.value=ne.map(Ie=>Ie.table_name),console.log(`[Supabase] Found ${n.value.length} tables`)}catch{n.value=[],console.log("[Supabase] list_tables() RPC not available  use manual table name input")}}async function B(ne){if(o){i.value=[];try{const{data:re,error:Ie}=await o.rpc("list_columns",{p_table:ne});if(Ie)throw Ie;i.value=re.map(qe=>qe.column_name),console.log(`[Supabase] Table "${ne}" columns:`,i.value)}catch{try{const{data:re}=await o.from(ne).select("*").limit(1);re&&re.length>0?(i.value=Object.keys(re[0]),console.log("[Supabase] Discovered columns from data:",i.value)):console.log("[Supabase] Table is empty  type column name manually")}catch(re){console.error("[Supabase] Failed to fetch columns:",re.message)}}}}async function M(ne,re){return!o||!p.value||!t.fingerprint.value?!1:ne.length<=Cn?(re?.(1,1),me(ne)):ge(ne,re)}async function me(ne){const re={s:t.fingerprint.value,d:ne},Ie={[e.value.column]:JSON.stringify(re)};e.value.senderColumn&&(Ie[e.value.senderColumn]=t.fingerprint.value);const{error:qe}=await o.from(e.value.table).insert(Ie);return qe?(console.error("[Supabase] Insert failed:",qe.message),!1):(console.log("[Supabase] Message sent to DB"),!0)}async function ge(ne,re){const Ie=Math.random().toString(36).slice(2,8),qe=Math.ceil(ne.length/Cn),ft=10;console.log(`[Supabase] Sending chunked message: mid=${Ie}, ${qe} chunks, total ${ne.length} chars`);const ze=[];for(let Ee=0;Ee<qe;Ee++){const ye=Ee*Cn,st=ne.slice(ye,ye+Cn),mt={s:t.fingerprint.value,t:"chunk",mid:Ie,seq:Ee,total:qe,d:st},rr={[e.value.column]:JSON.stringify(mt)};e.value.senderColumn&&(rr[e.value.senderColumn]=t.fingerprint.value),ze.push(rr)}let bt=0;for(let Ee=0;Ee<ze.length;Ee+=ft){const ye=ze.slice(Ee,Ee+ft),{error:st}=await o.from(e.value.table).insert(ye);if(st)return console.error(`[Supabase] Chunked insert failed at batch ${Math.floor(Ee/ft)+1}:`,st.message),!1;bt+=ye.length,re?.(bt,qe),console.log(`[Supabase] Chunks sent: ${bt}/${qe} (mid=${Ie})`)}return console.log(`[Supabase] All ${qe} chunks sent (mid=${Ie})`),!0}function Te(ne){const{column:re,idColumn:Ie}=e.value,qe=ne[re];if(!qe)return null;const ft=typeof qe=="string"?JSON.parse(qe):qe;if(!t.peerFingerprint.value||ft.s!==t.peerFingerprint.value)return null;if(ft.t==="chunk"){const ze=ft,bt=ne[Ie];let Ee=C.get(ze.mid);if(Ee||(Ee={total:ze.total,receivedAt:Date.now(),chunks:new Map,pks:[]},C.set(ze.mid,Ee)),Ee.chunks.set(ze.seq,ze.d),Ee.pks.push(bt),Ee.receivedAt=Date.now(),console.log(`[Supabase] Chunk ${ze.seq+1}/${ze.total} for mid=${ze.mid}`),_.value={mid:ze.mid,received:Ee.chunks.size,total:Ee.total},Ee.chunks.size===Ee.total){let ye="";for(let mt=0;mt<Ee.total;mt++)ye+=Ee.chunks.get(mt)||"";const st=[...Ee.pks];return C.delete(ze.mid),_.value=null,console.log(`[Supabase] All chunks received for mid=${ze.mid}  assembled ${ye.length} chars`),{type:"assembled",data:ye,pks:st}}return null}return ft.s&&ft.d?{type:"message",row:{pk:ne[Ie],data:qe}}:null}async function it(){if(!o||!p.value||!t.fingerprint.value||!t.peerFingerprint.value)return;O();const{table:ne,column:re,idColumn:Ie,senderColumn:qe}=e.value;let ft=o.from(ne).select(`${Ie}, ${re}`).order(Ie,{ascending:!0});qe&&t.peerFingerprint.value&&(ft=ft.eq(qe,t.peerFingerprint.value));const{data:ze,error:bt}=await ft;if(bt){console.error("[Supabase] Poll failed:",bt.message);return}if(!ze||ze.length===0)return;const Ee=[];for(const ye of ze)try{const mt=Te(ye);if(!mt)continue;if(mt.type==="message")Ee.push(mt.row);else if(mt.type==="assembled"){const rr={s:"",d:mt.data};Ee.push({pk:mt.pks[0],data:JSON.stringify(rr)});for(const Qt of mt.pks)ot(Qt)}}catch{}Ee.length>0&&(console.log(`[Supabase] Polled ${Ee.length} new message(s)`),t.onMessages(Ee))}async function ot(ne){if(!o||!p.value)return;const{error:re}=await o.from(e.value.table).delete().eq(e.value.idColumn,ne);re?console.error("[Supabase] Delete failed:",re.message):console.log(`[Supabase] Deleted message ${e.value.idColumn}=${ne}`)}function At(ne){y.value&&(l=setTimeout(async()=>{await it();const re=w.value?Ta:e.value.pollInterval;At(re)},ne))}function vt(ne){ut(),console.log(`[Supabase] Poll loop started (interval: ${Math.round(ne/1e3)}s)`),it(),At(ne)}function ut(){l&&(clearTimeout(l),l=null)}function zt(){if(!o||!p.value||!t.fingerprint.value)return;const{table:ne}=e.value;c=o.channel(`xchat-${ne}`).on("postgres_changes",{event:"INSERT",schema:"public",table:ne},re=>{try{const Ie=re.new,qe=Te(Ie);if(!qe)return;if(qe.type==="message")console.log("[Supabase] Realtime: new message received"),t.onMessages([qe.row]);else if(qe.type==="assembled"){console.log("[Supabase] Realtime: chunked message fully assembled");const ft={s:"",d:qe.data};t.onMessages([{pk:qe.pks[0],data:JSON.stringify(ft)}]);for(const ze of qe.pks)ot(ze)}}catch{}}).subscribe(re=>{re==="SUBSCRIBED"?(w.value=!0,console.log("[Supabase] Realtime active  switching poll to backup (5 min)"),ut(),vt(Ta)):re==="CHANNEL_ERROR"&&(console.warn("[Supabase] Realtime unavailable  polling at configured interval"),w.value=!1,ut(),vt(e.value.pollInterval))})}function _e(){c&&o&&(o.removeChannel(c),c=null),w.value=!1}function Pe(){p.value&&(y.value=!0,console.log("[Supabase] Starting sync..."),vt(e.value.pollInterval),zt())}function Se(){y.value=!1,_e(),ut(),C.clear(),console.log("[Supabase] Sync stopped")}return{settings:e,connectionState:r,connectionError:s,isConnected:f,isConfigured:p,isSyncing:y,isListening:w,chunkProgress:_,tables:n,columns:i,connect:U,disconnect:N,fetchTables:H,fetchColumns:B,sendMessage:M,pollOnce:it,deleteMessage:ot,startSync:Pe,stopSync:Se}}const Ap=["src"],Cp={class:"flex items-center justify-between px-4 py-2 border-b border-gray-800 shrink-0"},Rp={class:"flex items-center gap-3"},Op={key:0,class:"text-xs text-emerald-400"},$p={key:1,class:"text-xs text-yellow-400"},Pp={class:"flex items-center gap-2"},Ip=["title"],jp={key:0,class:"text-sm"},Up={key:1,class:"text-sm opacity-40"},Dp=["title"],Lp={key:0,class:"text-sm"},Np={key:1,class:"text-sm opacity-40"},Bp={key:1,class:"flex-1 flex items-center justify-center p-4"},Mp={class:"w-full max-w-lg space-y-4 bg-gray-900 rounded-xl p-5 border border-gray-800"},Fp={class:"flex items-center gap-2"},Kp={key:0,class:"space-y-4"},qp={class:"flex rounded-lg bg-gray-800 p-0.5"},Hp={key:0,class:"border-t border-gray-700 pt-3 mt-1"},Wp={class:"space-y-1"},Vp=["value"],zp={class:"space-y-1"},Jp=["value"],Gp={key:0,class:"text-xs text-red-400 bg-red-900/20 rounded-lg p-2"},Yp=["disabled"],Xp={class:"flex items-center justify-between"},Zp={class:"space-y-1"},Qp=["value"],eg=["value"],tg=["value"],rg={class:"space-y-1"},sg=["value"],ng=["value"],ig=["value"],og={class:"space-y-1"},ag=["value"],lg={class:"flex items-center justify-between"},cg={class:"flex items-center gap-2 text-sm text-green-400"},ug={key:0,class:"border-t border-gray-700 pt-3 mt-1"},fg={key:1,class:"space-y-4"},dg={class:"space-y-1.5"},hg={class:"flex gap-2"},pg=["value"],gg={class:"space-y-1.5"},yg={class:"flex gap-2"},vg=["disabled"],bg={key:0,class:"h-full flex items-center justify-center"},mg=["onClick"],_g={key:0,class:"text-sm whitespace-pre-wrap"},wg={key:0,class:"space-y-1"},xg={class:"flex items-center gap-2.5 min-w-[200px]"},Sg=["src","onLoadedmetadata","onTimeupdate","onEnded"],Eg=["onClick"],kg={key:0,class:"text-sm leading-none"},Tg={key:1,class:"text-[10px] leading-none ml-0.5"},Ag={class:"flex-1 min-w-0 space-y-1"},Cg={class:"text-[10px] opacity-60"},Rg=["onClick"],Og={key:1,class:"space-y-1"},$g=["src","onClick"],Pg=["onClick"],Ig={key:2,class:"flex items-center gap-2.5 min-w-[180px] py-1"},jg={class:"flex-1 min-w-0"},Ug={class:"text-sm truncate"},Dg={class:"text-[10px] opacity-50"},Lg=["onClick"],Ng={key:0,class:"flex gap-2 px-4 py-2 border-t border-gray-800 overflow-x-auto shrink-0"},Bg=["onClick"],Mg={class:"text-xs text-gray-300"},Fg=["src"],Kg={class:"text-xs text-gray-400"},qg={class:"text-xs text-gray-300 max-w-[120px] truncate"},Hg={class:"text-xs text-gray-500"},Wg={key:1,class:"px-4 py-2 border-t border-gray-800 bg-gray-900/50 shrink-0"},Vg={class:"flex items-center justify-between text-xs text-gray-400 mb-1"},zg={class:"h-1.5 bg-gray-800 rounded-full overflow-hidden"},Jg={key:2,class:"px-4 py-2 border-t border-gray-800 bg-gray-900/50 shrink-0"},Gg={class:"flex items-center justify-between text-xs text-gray-400 mb-1"},Yg={class:"h-1.5 bg-gray-800 rounded-full overflow-hidden"},Xg={class:"flex items-center justify-center w-10 h-10 rounded-full hover:bg-gray-800 transition-colors cursor-pointer shrink-0"},Zg={key:0,class:"text-xs font-medium text-white"},Qg={key:1,class:"text-lg text-gray-400"},ey=["disabled"],ty={key:0,class:"w-full lg:w-1/2 flex flex-col min-h-0 border-t lg:border-t-0 lg:border-l border-gray-800 h-[40vh] lg:h-auto"},ry={class:"flex-1 overflow-y-auto p-4 space-y-4"},sy={class:"bg-gray-900 rounded-xl p-4 border border-gray-800 space-y-3"},ny={class:"flex gap-2"},iy=["value"],oy=["disabled"],ay={class:"bg-gray-900 rounded-xl p-4 border border-gray-800 space-y-3"},ly={class:"flex gap-2"},cy=["disabled"],uy={key:0,class:"space-y-2"},fy={key:0,class:"bg-gray-800 border border-gray-700 rounded-lg p-3 text-sm whitespace-pre-wrap"},dy={key:0,class:"space-y-2"},hy={class:"flex items-center justify-between text-sm"},py=["onClick"],gy=["src"],yy={key:1,class:"space-y-2"},vy={class:"flex items-center justify-between text-sm"},by=["onClick"],my=["src","onClick"],_y={key:2,class:"flex items-center justify-between"},wy={class:"flex items-center gap-2 text-sm min-w-0"},xy={class:"font-medium truncate"},Sy={class:"text-xs text-gray-500 shrink-0"},Ey=["onClick"],ky={class:"flex items-center justify-between text-xs text-gray-500 pt-2"},Aa=100*1024*1024,Ty=al({__name:"App",setup(t){const e=tt("idle"),r=tt(null),s=tt(null),n=tt(null),i=tt(null),o=tt(null),l=tt(null),c=tt(0),f=tt(0),p=tt(""),y=tt(""),w=tt(""),_=tt(""),C=tt("manual"),O=In("xchat-sound-enabled",!0),U=In("xchat-autosave",!0),N=In("xchat-session",null,{serializer:{read:R=>{try{return JSON.parse(R)}catch{return null}},write:R=>JSON.stringify(R)}}),H=mr(()=>N.value!==null);let B=0;const M=ks([]),me=tt(!1),ge=tt(0);let Te=null,it=[],ot=null;const At=tt(!1),vt=tt(null),ut=tt(null);let zt=0;const _e=ks([]),Pe=ks({}),Se={};function ne(R,m){Se[R]=m,Pe[R]||(Pe[R]={playing:!1,currentTime:0,duration:isFinite(m.duration)?m.duration:0})}function re(R,m){Pe[R]&&isFinite(m.duration)&&(Pe[R].duration=m.duration)}function Ie(R){const m=Se[R];if(!m)return;const A=Pe[R];if(A)if(A.playing)m.pause(),A.playing=!1;else{for(const[He,be]of Object.entries(Pe))be.playing&&He!==R&&(Se[He]?.pause(),be.playing=!1);m.play(),A.playing=!0}}function qe(R,m){Pe[R]&&(Pe[R].currentTime=m.currentTime)}function ft(R){Pe[R]&&(Pe[R].playing=!1,Pe[R].currentTime=0)}function ze(R){const m=Pe[R];return!m||!m.duration?0:m.currentTime/m.duration*100}function bt(R){const m=_e[R];if(m){if(m.attachments)for(const A of m.attachments)URL.revokeObjectURL(A.blobUrl);m.attachments&&m.attachments.forEach((A,He)=>{const be=`${m.id}-${He}`;Se[be]&&(Se[be].pause(),delete Se[be]),delete Pe[be]}),_e.splice(R,1)}}const Ee=[];function ye(R){const m=URL.createObjectURL(R);return Ee.push(m),m}const st=tt(null);jr(()=>_e.length,()=>{Qn(()=>{st.value&&(st.value.scrollTop=st.value.scrollHeight)})});function mt(R){R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),Mr())}const rr=mr(()=>{switch(e.value){case"idle":return"Create or join a chat";case"waiting":return"Send invite code to your peer";case"ready":return"Secure channel established  send encrypted messages"}}),Qt=tt(!1),_t=tt(null),as=mr(()=>!Qt.value&&(M.length>0||y.value.trim().length>0));function b(){return new Promise(R=>setTimeout(R,0))}let S=null;function I(){if(O.value)try{S||(S=new AudioContext);const R=S,m=R.createOscillator(),A=R.createOscillator(),He=R.createGain();m.type="sine",m.frequency.setValueAtTime(880,R.currentTime),m.frequency.setValueAtTime(1047,R.currentTime+.08),A.type="sine",A.frequency.setValueAtTime(1320,R.currentTime+.08),He.gain.setValueAtTime(.15,R.currentTime),He.gain.exponentialRampToValueAtTime(.01,R.currentTime+.25),m.connect(He),A.connect(He),He.connect(R.destination),m.start(R.currentTime),A.start(R.currentTime+.08),m.stop(R.currentTime+.25),A.stop(R.currentTime+.25)}catch{}}const W=mr(()=>r.value?Le.encodeBase64(r.value.publicKey).slice(0,8):""),F=mr(()=>s.value?Le.encodeBase64(s.value).slice(0,8):""),E=Tp({fingerprint:W,peerFingerprint:F,onMessages:Z});function Z(R){if(!(!i.value||!o.value))for(const m of R)try{const He=JSON.parse(typeof m.data=="string"?m.data:JSON.stringify(m.data)).d,be=f.value+1;console.log(""),console.log(`[DB-Recv #${be}] Auto-decrypting from Supabase...`),console.log("");const{nextChainKey:xt,messageKey:u}=Si(i.value),h=ea(u,He);if(!h){console.error(`[DB-Recv #${be}] Decryption FAILED  skipping`),E.deleteMessage(m.pk);continue}console.log("[DB-Recv] Decrypted JSON payload:",JSON.stringify(h,null,2));const d=Le.decodeBase64(h.ratchetKey);i.value=Ei(xt,o.value.secretKey,d),l.value=d,f.value=be;const a=h.attachments?.map(g=>{const k=ta(g.data),T=new Blob([k.buffer.slice(k.byteOffset,k.byteOffset+k.byteLength)],{type:g.mime});return{type:g.type,blobUrl:ye(T),name:g.name,size:k.byteLength}});_e.push({id:++zt,direction:"received",text:h.text,attachments:a}),console.log(`[DB-Recv #${be}] Decrypted and added to history`),I(),ve(),E.deleteMessage(m.pk)}catch(A){console.error("[DB-Recv] Error processing message:",A.message),E.deleteMessage(m.pk)}}function G(){e.value==="waiting"?(r.value=null,p.value="",e.value="idle"):e.value==="idle"&&C.value==="supabase"&&(E.isConfigured.value?(E.settings.value.table="",E.settings.value.column=""):E.isConnected.value&&E.disconnect())}function J(){console.log(""),console.log("[Phase 1] Generating ECDH key pair (Curve25519)..."),console.log(""),r.value=Qo(),e.value="waiting",console.log("[Phase 1] Key pair generated. Waiting for peer public key.")}function K(){if(!(!r.value||!p.value.trim())){console.log(""),console.log("[Phase 2] Completing ECDH handshake..."),console.log("");try{const R=Le.decodeBase64(p.value.trim());s.value=R;const m=ad(r.value.secretKey,R);console.log(""),console.log("[Phase 3] Deriving chain keys for Forward Secrecy..."),console.log("");const A=cd(m,r.value.publicKey,R);n.value=A.sendChain,i.value=A.recvChain,o.value={publicKey:r.value.publicKey,secretKey:r.value.secretKey},l.value=R,e.value="ready",console.log("[Phase 3] Secure channel established!"),console.log("[Phase 3] DH ratchet initialized with identity keys."),E.isConfigured.value&&!E.isSyncing.value&&E.startSync(),ve()}catch(R){console.error("[Handshake] Error:",R),alert("Invalid public key format.")}}}function he(){return!r.value||!s.value||!n.value||!i.value||!o.value||!l.value?null:{v:1,kp:{pub:Le.encodeBase64(r.value.publicKey),sec:Le.encodeBase64(r.value.secretKey)},peer:Le.encodeBase64(s.value),sc:Le.encodeBase64(n.value),rc:Le.encodeBase64(i.value),rkp:{pub:Le.encodeBase64(o.value.publicKey),sec:Le.encodeBase64(o.value.secretKey)},rp:Le.encodeBase64(l.value),sn:c.value,rn:f.value,cm:C.value}}function Q(R){r.value={publicKey:Le.decodeBase64(R.kp.pub),secretKey:Le.decodeBase64(R.kp.sec)},s.value=Le.decodeBase64(R.peer),n.value=Le.decodeBase64(R.sc),i.value=Le.decodeBase64(R.rc),o.value={publicKey:Le.decodeBase64(R.rkp.pub),secretKey:Le.decodeBase64(R.rkp.sec)},l.value=Le.decodeBase64(R.rp),c.value=R.sn,f.value=R.rn,C.value=R.cm,e.value="ready",E.isConfigured.value&&!E.isSyncing.value&&E.startSync(),console.log("[Session] Restored")}function fe(){const R=he();R&&(N.value=R,console.log("[Session] Saved to localStorage"))}function ve(){U.value&&fe()}jr(U,R=>{R&&e.value==="ready"&&fe()});function Ne(){N.value&&Q(N.value)}function rt(){N.value=null,console.log("[Session] Deleted from localStorage")}async function Je(){const R=he();R&&(await js(JSON.stringify(R)),console.log("[Session] Exported to clipboard"))}async function Rt(){const R=await navigator.clipboard.readText();try{const m=JSON.parse(R.trim());if(m.v!==1||!m.kp||!m.peer)throw new Error("Invalid format");Q(m),N.value=m}catch{alert("Invalid session data")}}function Ut(){const R=["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus"];for(const m of R)if(MediaRecorder.isTypeSupported(m))return m;return""}async function Ft(){me.value?Jt():await Kt()}async function Kt(){console.log("[Audio] Requesting microphone access...");try{const R=await navigator.mediaDevices.getUserMedia({audio:!0}),m=Ut();console.log(`[Audio] Recording started (MIME: ${m||"default"})`),Te=m?new MediaRecorder(R,{mimeType:m}):new MediaRecorder(R),it=[],Te.ondataavailable=A=>{A.data.size>0&&it.push(A.data)},Te.onstop=async()=>{const A=Te?.mimeType||"audio/webm",He=new Blob(it,{type:A}),be=await He.arrayBuffer();console.log(`[Audio] Recording complete: ${be.byteLength} bytes, MIME: ${A}`),M.push({id:++B,type:"audio",data:new Uint8Array(be),mime:A,name:"voice.webm",previewUrl:ye(He)}),R.getTracks().forEach(xt=>xt.stop())},Te.start(),me.value=!0,ge.value=0,ot=setInterval(()=>{ge.value++,ge.value>=60&&(console.log("[Audio] Max 60s reached, stopping..."),Jt())},1e3)}catch(R){console.error("[Audio] Microphone access denied:",R),alert("Microphone access denied.")}}function Jt(){Te&&Te.state!=="inactive"&&Te.stop(),me.value=!1,ot&&(clearInterval(ot),ot=null)}function lr(R){if(R.size>Aa){alert(`File "${R.name}" is too large (${Gt(R.size)}). Maximum size is ${Gt(Aa)}.`);return}const m=R.type.startsWith("image/")?"image":R.type.startsWith("audio/")?"audio":"file";console.log(`[File] Attaching: ${R.name} (${R.type||"unknown"}, ${R.size} bytes, type: ${m})`);const A=new FileReader;A.onload=()=>{M.push({id:++B,type:m,data:new Uint8Array(A.result),mime:R.type||"application/octet-stream",name:R.name,previewUrl:ye(R)}),console.log(`[File] Attached: ${R.name} (${A.result.byteLength} bytes)`)},A.readAsArrayBuffer(R)}function wt(R){R.preventDefault(),At.value=!1;const m=R.dataTransfer?.files;if(m)for(let A=0;A<m.length;A++)lr(m[A])}function Dt(R){const m=R.clipboardData?.items;if(m){for(const A of m)if(A.type.startsWith("image/")){R.preventDefault();const He=A.getAsFile();He&&lr(He);return}}}function kr(R){const m=R.target,A=m.files;if(A)for(let He=0;He<A.length;He++)lr(A[He]);m.value=""}function gr(R){const m=M.findIndex(A=>A.id===R);m!==-1&&M.splice(m,1),console.log("[Attachment] Removed")}async function Mr(){if(!n.value||!l.value||!as.value)return;Qt.value=!0;const R=c.value+1,A=M.reduce((j,V)=>j+V.data.length,0)>512*1024;console.log(""),console.log(`[Send #${R}] Encrypting with Double Ratchet...`),console.log("");const He=n.value,be=o.value,xt=c.value;A&&(_t.value={text:"Preparing...",percent:0},await b());const{nextChainKey:u,messageKey:h}=Si(n.value),d=Qo();console.log(`[Send #${R}] New ephemeral ratchet key generated`),A&&(_t.value={text:"Encoding...",percent:5},await b());const a=M.map(j=>({type:j.type,mime:j.mime,data:fd(j.data),name:j.type==="file"||j.type==="image"?j.name:void 0})),g={ratchetKey:Le.encodeBase64(d.publicKey)};y.value.trim()&&(g.text=y.value),a.length>0&&(g.attachments=a),A&&(_t.value={text:"Encrypting...",percent:20},await b()),console.log("[Send] JSON payload before encryption:",JSON.stringify(g,null,2));const k=ud(h,g);if(w.value=k,n.value=Ei(u,d.secretKey,l.value),o.value=d,c.value=R,console.log(`[Send #${R}] Send chain updated with DH ratchet (post-compromise security)`),E.isConfigured.value){if(A&&(_t.value={text:"Uploading...",percent:30},await b()),!await E.sendMessage(k,(V,le)=>{const te=30+Math.round(V/le*70);_t.value={text:`Uploading ${V}/${le}...`,percent:te}})){console.error(`[Send #${R}] Supabase send failed  rolling back ratchet`),n.value=He,o.value=be,c.value=xt,w.value="",Qt.value=!1,_t.value=null;return}console.log(`[Send #${R}] Auto-sent to Supabase`)}const T=M.map(j=>({type:j.type,blobUrl:j.previewUrl,name:j.name,size:j.data.length}));_e.push({id:++zt,direction:"sent",text:y.value.trim()||void 0,attachments:T.length>0?T:void 0}),y.value="",M.length=0,Qt.value=!1,_t.value=null,ve(),console.log(`[Send #${R}] Done  copy the encrypted output`)}function Is(){if(!i.value||!o.value||!_.value.trim())return;vt.value=null;const R=f.value+1;console.log(""),console.log(`[Recv #${R}] Decrypting with Double Ratchet...`),console.log("");const{nextChainKey:m,messageKey:A}=Si(i.value),He=ea(A,_.value.trim());if(!He){vt.value={text:"Decryption failed  wrong key or tampered data"},console.error(`[Recv #${R}] Decryption FAILED`);return}console.log("[Recv] Decrypted JSON payload:",JSON.stringify(He,null,2));const be=Le.decodeBase64(He.ratchetKey);i.value=Ei(m,o.value.secretKey,be),l.value=be,f.value=R,console.log(`[Recv #${R}] Recv chain updated with DH ratchet`),console.log(`[Recv #${R}] Peer ratchet public key updated`);const xt=He.attachments?.map(u=>{const h=ta(u.data),d=new Blob([h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength)],{type:u.mime});return{type:u.type,blobUrl:ye(d),name:u.name,size:h.byteLength}});vt.value={text:He.text,attachments:xt},_e.push({id:++zt,direction:"received",text:He.text,attachments:xt}),_.value="",I(),ve(),console.log(`[Recv #${R}] Done`)}function Tr(R,m){const A=document.createElement("a");A.href=R,A.download=m,document.body.appendChild(A),A.click(),document.body.removeChild(A)}async function js(R){await navigator.clipboard.writeText(R),console.log("[Clipboard] Copied to clipboard")}async function gn(R){const m=await navigator.clipboard.readText();R==="peerKey"?p.value=m:_.value=m,console.log("[Clipboard] Pasted from clipboard")}function sr(R){const m=Math.floor(R),A=Math.floor(m/60),He=m%60;return`${A}:${He.toString().padStart(2,"0")}`}function Gt(R){return R<1024?`${R} B`:R<1024*1024?`${(R/1024).toFixed(1)} KB`:`${(R/1024/1024).toFixed(1)} MB`}function Ar(){e.value="idle",r.value=null,s.value=null,n.value=null,i.value=null,o.value=null,l.value=null,c.value=0,f.value=0,p.value="",y.value="",w.value="",_.value="",vt.value=null,C.value="manual",ut.value=null,M.length=0;for(const[R,m]of Object.entries(Se))m.pause(),delete Se[R];for(const R of Object.keys(Pe))delete Pe[R];_e.length=0,Jt(),E.stopSync(),Ee.forEach(R=>URL.revokeObjectURL(R)),Ee.length=0,rt(),console.log("[Reset] All state cleared")}return dl(()=>{Jt(),E.stopSync(),Ee.forEach(R=>URL.revokeObjectURL(R))}),(R,m)=>(Y(),X("div",{class:"h-screen bg-gray-950 text-gray-100 flex flex-col overflow-hidden",onKeydown:m[28]||(m[28]=Tf(A=>ut.value=null,["escape"]))},[ut.value?(Y(),X("div",{key:0,class:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 cursor-pointer",onClick:m[2]||(m[2]=A=>ut.value=null)},[x("img",{src:ut.value,class:"max-w-[90vw] max-h-[90vh] object-contain rounded-lg shadow-2xl",onClick:m[0]||(m[0]=zo(()=>{},["stop"]))},null,8,Ap),x("button",{onClick:m[1]||(m[1]=A=>ut.value=null),class:"absolute top-4 right-4 w-10 h-10 flex items-center justify-center rounded-full bg-gray-900/80 hover:bg-gray-800 text-xl transition-colors cursor-pointer"},"  ")])):dt("",!0),wr(zd,{settings:ee(E).settings.value,"connection-state":ee(E).connectionState.value,"connection-error":ee(E).connectionError.value,"is-connected":ee(E).isConnected.value,"is-configured":ee(E).isConfigured.value,"is-syncing":ee(E).isSyncing.value,"is-listening":ee(E).isListening.value,tables:ee(E).tables.value,columns:ee(E).columns.value,"can-sync":e.value==="ready"||e.value==="waiting",onConnect:ee(E).connect,onDisconnect:ee(E).disconnect,onStartSync:ee(E).startSync,onStopSync:ee(E).stopSync,"onUpdate:settings":m[3]||(m[3]=A=>Object.assign(ee(E).settings.value,A)),onFetchColumns:ee(E).fetchColumns},null,8,["settings","connection-state","connection-error","is-connected","is-configured","is-syncing","is-listening","tables","columns","can-sync","onConnect","onDisconnect","onStartSync","onStopSync","onFetchColumns"]),x("div",Cp,[x("div",Rp,[m[29]||(m[29]=x("h1",{class:"text-lg font-bold tracking-tight"},"XChat",-1)),m[30]||(m[30]=x("span",{class:"text-xs text-gray-500"},"E2E  Curve25519  Double Ratchet",-1)),ee(E).isListening.value?(Y(),X("span",Op," Realtime")):ee(E).isSyncing.value?(Y(),X("span",$p," Polling")):dt("",!0)]),x("div",Pp,[x("div",{class:Lt(["px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-gray-800 text-gray-400":e.value==="idle","bg-yellow-900/50 text-yellow-400":e.value==="waiting","bg-green-900/50 text-green-400":e.value==="ready"}])},et(rr.value),3),e.value==="ready"?(Y(),X("button",{key:0,onClick:m[4]||(m[4]=A=>O.value=!ee(O)),class:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-gray-800 transition-colors cursor-pointer",title:ee(O)?"Mute notifications":"Unmute notifications"},[ee(O)?(Y(),X("span",jp,"")):(Y(),X("span",Up,""))],8,Ip)):dt("",!0),e.value==="ready"?(Y(),X("button",{key:1,onClick:m[5]||(m[5]=A=>U.value=!ee(U)),title:ee(U)?"Auto-save on (click to disable)":"Auto-save off (click to enable)",class:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-gray-800 transition-colors cursor-pointer"},[ee(U)?(Y(),X("span",Lp,"")):(Y(),X("span",Np,""))],8,Dp)):dt("",!0),e.value==="ready"?(Y(),X("button",{key:2,onClick:Je,title:"Export session to clipboard",class:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-gray-800 transition-colors cursor-pointer"},[...m[31]||(m[31]=[x("span",{class:"text-sm"},"",-1)])])):dt("",!0),e.value==="ready"?(Y(),X("button",{key:3,onClick:Ar,class:"text-xs text-red-400 hover:text-red-300 transition-colors cursor-pointer"}," Reset ")):dt("",!0)])]),e.value!=="ready"?(Y(),X("div",Bp,[x("div",Mp,[x("div",Fp,[e.value==="waiting"||e.value==="idle"&&C.value==="supabase"&&ee(E).isConnected.value?(Y(),X("button",{key:0,onClick:G,class:"text-gray-400 hover:text-gray-200 transition-colors cursor-pointer text-lg leading-none"},"  ")):dt("",!0),m[32]||(m[32]=x("h2",{class:"text-lg font-semibold"},"Key Exchange (ECDH  Curve25519)",-1))]),e.value==="idle"?(Y(),X("div",Kp,[x("div",qp,[x("button",{onClick:m[6]||(m[6]=A=>C.value="manual"),class:Lt([C.value==="manual"?"bg-gray-700 text-white":"text-gray-400 hover:text-gray-200","flex-1 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer"])}," Copy / Paste ",2),x("button",{onClick:m[7]||(m[7]=A=>C.value="supabase"),class:Lt([C.value==="supabase"?"bg-gray-700 text-white":"text-gray-400 hover:text-gray-200","flex-1 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer"])}," Supabase ",2)]),C.value==="manual"?(Y(),X(ht,{key:0},[x("button",{onClick:J,class:"w-full py-2.5 px-4 bg-blue-600 hover:bg-blue-500 rounded-lg font-medium transition-colors cursor-pointer"}," Create New Chat "),m[33]||(m[33]=x("div",{class:"text-center text-sm text-gray-500"},"or",-1)),x("button",{onClick:J,class:"w-full py-2.5 px-4 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium transition-colors cursor-pointer"}," Join Existing Chat "),H.value?(Y(),X("div",Hp,[x("button",{onClick:Ne,class:"w-full py-2 px-4 bg-emerald-700 hover:bg-emerald-600 rounded-lg text-sm font-medium transition-colors cursor-pointer"}," Resume Saved Session ")])):dt("",!0),x("button",{onClick:Rt,class:"w-full py-2 px-4 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-lg text-sm font-medium transition-colors cursor-pointer"}," Import Session ")],64)):(Y(),X(ht,{key:1},[ee(E).isConnected.value?ee(E).isConfigured.value?(Y(),X(ht,{key:2},[x("div",lg,[x("div",cg,[m[42]||(m[42]=x("span",{class:"w-2 h-2 rounded-full bg-green-500"},null,-1)),en(" "+et(ee(E).settings.value.table)+"  "+et(ee(E).settings.value.column),1)]),x("button",{onClick:m[18]||(m[18]=(...A)=>ee(E).disconnect&&ee(E).disconnect(...A)),class:"text-xs text-gray-500 hover:text-gray-300 transition-colors cursor-pointer"}," Disconnect ")]),x("button",{onClick:J,class:"w-full py-2.5 px-4 bg-blue-600 hover:bg-blue-500 rounded-lg font-medium transition-colors cursor-pointer"}," Create New Chat "),m[43]||(m[43]=x("div",{class:"text-center text-sm text-gray-500"},"or",-1)),x("button",{onClick:J,class:"w-full py-2.5 px-4 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium transition-colors cursor-pointer"}," Join Existing Chat "),m[44]||(m[44]=x("p",{class:"text-center text-xs text-gray-500"},"Messages will be delivered via Supabase after key exchange",-1)),H.value?(Y(),X("div",ug,[x("button",{onClick:Ne,class:"w-full py-2 px-4 bg-emerald-700 hover:bg-emerald-600 rounded-lg text-sm font-medium transition-colors cursor-pointer"}," Resume Saved Session ")])):dt("",!0),x("button",{onClick:Rt,class:"w-full py-2 px-4 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-lg text-sm font-medium transition-colors cursor-pointer"}," Import Session ")],64)):(Y(),X(ht,{key:1},[x("div",Xp,[m[36]||(m[36]=x("div",{class:"flex items-center gap-2 text-sm text-green-400"},[x("span",{class:"w-2 h-2 rounded-full bg-green-500"}),en(" Connected ")],-1)),x("button",{onClick:m[11]||(m[11]=(...A)=>ee(E).disconnect&&ee(E).disconnect(...A)),class:"text-xs text-gray-500 hover:text-gray-300 transition-colors cursor-pointer"}," Disconnect ")]),x("div",Zp,[m[38]||(m[38]=x("label",{class:"block text-xs text-gray-400"},"Table",-1)),ee(E).tables.value.length>0?(Y(),X("select",{key:0,value:ee(E).settings.value.table,onChange:m[12]||(m[12]=A=>{ee(E).settings.value.table=A.target.value,ee(E).fetchColumns(ee(E).settings.value.table)}),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},[m[37]||(m[37]=x("option",{value:""},"-- select table --",-1)),(Y(!0),X(ht,null,qr(ee(E).tables.value,A=>(Y(),X("option",{key:A,value:A},et(A),9,eg))),128))],40,Qp)):(Y(),X("input",{key:1,type:"text",value:ee(E).settings.value.table,onInput:m[13]||(m[13]=A=>ee(E).settings.value.table=A.target.value),onChange:m[14]||(m[14]=A=>ee(E).fetchColumns(ee(E).settings.value.table)),placeholder:"messages",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},null,40,tg))]),x("div",rg,[m[40]||(m[40]=x("label",{class:"block text-xs text-gray-400"},"Message column",-1)),ee(E).columns.value.length>0?(Y(),X("select",{key:0,value:ee(E).settings.value.column,onChange:m[15]||(m[15]=A=>ee(E).settings.value.column=A.target.value),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},[m[39]||(m[39]=x("option",{value:""},"-- select column --",-1)),(Y(!0),X(ht,null,qr(ee(E).columns.value,A=>(Y(),X("option",{key:A,value:A},et(A),9,ng))),128))],40,sg)):(Y(),X("input",{key:1,type:"text",value:ee(E).settings.value.column,onInput:m[16]||(m[16]=A=>ee(E).settings.value.column=A.target.value),placeholder:"payload",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},null,40,ig))]),x("div",og,[m[41]||(m[41]=x("label",{class:"block text-xs text-gray-400"},"ID column",-1)),x("input",{type:"text",value:ee(E).settings.value.idColumn,onInput:m[17]||(m[17]=A=>ee(E).settings.value.idColumn=A.target.value),placeholder:"id",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},null,40,ag)])],64)):(Y(),X(ht,{key:0},[x("div",Wp,[m[34]||(m[34]=x("label",{class:"block text-xs text-gray-400"},"Supabase URL",-1)),x("input",{type:"text",value:ee(E).settings.value.url,onInput:m[8]||(m[8]=A=>ee(E).settings.value.url=A.target.value),placeholder:"https://xxx.supabase.co",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"},null,40,Vp)]),x("div",zp,[m[35]||(m[35]=x("label",{class:"block text-xs text-gray-400"},"Anon Key",-1)),x("input",{type:"password",value:ee(E).settings.value.anonKey,onInput:m[9]||(m[9]=A=>ee(E).settings.value.anonKey=A.target.value),placeholder:"eyJhbGciOiJIUzI1NiIs...",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm font-mono focus:outline-none focus:border-blue-500"},null,40,Jp)]),ee(E).connectionError.value?(Y(),X("div",Gp,et(ee(E).connectionError.value),1)):dt("",!0),x("button",{onClick:m[10]||(m[10]=(...A)=>ee(E).connect&&ee(E).connect(...A)),disabled:!ee(E).settings.value.url||!ee(E).settings.value.anonKey||ee(E).connectionState.value==="connecting",class:"w-full py-2.5 px-4 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-700 disabled:text-gray-500 rounded-lg font-medium transition-colors cursor-pointer disabled:cursor-not-allowed"},et(ee(E).connectionState.value==="connecting"?"Connecting...":"Connect"),9,Yp)],64))],64))])):dt("",!0),e.value==="waiting"?(Y(),X("div",fg,[x("div",dg,[m[45]||(m[45]=x("label",{class:"block text-sm text-gray-400"},"Your Invite Code",-1)),x("div",hg,[x("textarea",{readonly:"",value:r.value?ee(Le.encodeBase64)(r.value.publicKey):"",class:"flex-1 bg-gray-800 border border-gray-700 rounded-lg p-3 text-sm font-mono resize-none h-16 focus:outline-none"},null,8,pg),x("button",{onClick:m[19]||(m[19]=A=>js(ee(Le.encodeBase64)(r.value.publicKey))),class:"px-4 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-medium transition-colors shrink-0 cursor-pointer"}," Copy ")]),m[46]||(m[46]=x("p",{class:"text-xs text-gray-500"},"Send this invite code to your chat partner",-1))]),x("div",gg,[m[47]||(m[47]=x("label",{class:"block text-sm text-gray-400"},"Paste Partner's Response",-1)),x("div",yg,[hi(x("textarea",{"onUpdate:modelValue":m[20]||(m[20]=A=>p.value=A),placeholder:"Paste response code from your partner...",class:"flex-1 bg-gray-800 border border-gray-700 rounded-lg p-3 text-sm font-mono resize-none h-16 focus:outline-none focus:border-blue-500"},null,512),[[_i,p.value]]),x("button",{onClick:m[21]||(m[21]=A=>gn("peerKey")),class:"px-4 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-medium transition-colors shrink-0 cursor-pointer"}," Paste ")])]),x("button",{onClick:K,disabled:!p.value.trim(),class:"w-full py-2.5 px-4 bg-green-600 hover:bg-green-500 disabled:bg-gray-700 disabled:text-gray-500 rounded-lg font-medium transition-colors cursor-pointer disabled:cursor-not-allowed"}," Complete Handshake ",8,vg)])):dt("",!0)])])):(Y(),X("div",{key:2,class:Lt(["flex-1 flex flex-col lg:flex-row min-h-0",C.value==="supabase"?"justify-center":""])},[x("div",{class:Lt(["flex flex-col min-h-0",C.value==="supabase"?"w-full max-w-2xl mx-auto h-full":"w-full lg:w-1/2 h-[60vh] lg:h-auto"])},[x("div",{ref_key:"messageListRef",ref:st,class:"flex-1 overflow-y-auto min-h-0 p-4 space-y-2 bg-gray-900"},[_e.length===0?(Y(),X("div",bg,[...m[48]||(m[48]=[x("span",{class:"text-sm text-gray-600"},"No messages yet",-1)])])):dt("",!0),(Y(!0),X(ht,null,qr(_e,(A,He)=>(Y(),X("div",{key:A.id,class:Lt(["flex group",A.direction==="sent"?"justify-end":"justify-start"])},[x("div",{class:Lt(["relative max-w-[75%] px-3.5 py-2.5 space-y-2",A.direction==="sent"?"bg-blue-600 rounded-2xl rounded-br-md":"bg-gray-800 rounded-2xl rounded-bl-md"])},[x("button",{onClick:be=>bt(He),class:Lt(["absolute -top-2 opacity-0 group-hover:opacity-100 w-5 h-5 flex items-center justify-center rounded-full bg-gray-900 border border-gray-700 hover:bg-red-600 hover:border-red-600 text-[10px] transition-all cursor-pointer z-10",A.direction==="sent"?"-left-2":"-right-2"])},"  ",10,mg),A.text?(Y(),X("div",_g,et(A.text),1)):dt("",!0),A.attachments?(Y(!0),X(ht,{key:1},qr(A.attachments,(be,xt)=>(Y(),X("div",{key:xt},[be.type==="audio"?(Y(),X("div",wg,[x("div",xg,[x("audio",{src:be.blobUrl,ref_for:!0,ref:u=>{u&&ne(`${A.id}-${xt}`,u)},onLoadedmetadata:u=>re(`${A.id}-${xt}`,u.target),onTimeupdate:u=>qe(`${A.id}-${xt}`,u.target),onEnded:u=>ft(`${A.id}-${xt}`),preload:"metadata",class:"hidden"},null,40,Sg),x("button",{onClick:u=>Ie(`${A.id}-${xt}`),class:Lt(["w-8 h-8 flex items-center justify-center rounded-full shrink-0 cursor-pointer transition-colors",A.direction==="sent"?"bg-blue-500 hover:bg-blue-400":"bg-gray-700 hover:bg-gray-600"])},[Pe[`${A.id}-${xt}`]?.playing?(Y(),X("span",kg,"")):(Y(),X("span",Tg,""))],10,Eg),x("div",Ag,[x("div",{class:Lt(["h-1 rounded-full overflow-hidden",A.direction==="sent"?"bg-blue-500/40":"bg-gray-600"])},[x("div",{class:Lt(["h-full rounded-full transition-[width] duration-200",A.direction==="sent"?"bg-white/70":"bg-gray-400"]),style:Es({width:ze(`${A.id}-${xt}`)+"%"})},null,6)],2),x("span",Cg,et(sr(Pe[`${A.id}-${xt}`]?.currentTime??0))+" / "+et(sr(Pe[`${A.id}-${xt}`]?.duration??0)),1)])]),x("button",{onClick:u=>Tr(be.blobUrl,be.name||"audio.webm"),class:"text-[10px] opacity-50 hover:opacity-80 transition-opacity cursor-pointer"},"  Save ",8,Rg)])):be.type==="image"?(Y(),X("div",Og,[x("img",{src:be.blobUrl,class:"max-h-48 rounded-lg object-contain cursor-pointer hover:opacity-90 transition-opacity",onClick:u=>ut.value=be.blobUrl},null,8,$g),x("button",{onClick:u=>Tr(be.blobUrl,be.name||"image.png"),class:"text-[10px] opacity-50 hover:opacity-80 transition-opacity cursor-pointer"},"  Save ",8,Pg)])):(Y(),X("div",Ig,[m[50]||(m[50]=x("span",{class:"text-2xl shrink-0"},"",-1)),x("div",jg,[x("div",Ug,et(be.name||"file"),1),x("div",Dg,et(be.size?Gt(be.size):""),1)]),x("button",{onClick:u=>Tr(be.blobUrl,be.name||"file"),class:Lt(["w-7 h-7 flex items-center justify-center rounded-full shrink-0 cursor-pointer transition-colors",A.direction==="sent"?"bg-blue-500 hover:bg-blue-400":"bg-gray-700 hover:bg-gray-600"])},[...m[49]||(m[49]=[x("span",{class:"text-xs"},"",-1)])],10,Lg)]))]))),128)):dt("",!0)],2)],2))),128))],512),M.length?(Y(),X("div",Ng,[(Y(!0),X(ht,null,qr(M,A=>(Y(),X("div",{key:A.id,class:"relative flex items-center gap-2 bg-gray-800 rounded-lg px-2.5 py-1.5 shrink-0 border border-gray-700"},[x("button",{onClick:He=>gr(A.id),class:"absolute -top-1.5 -right-1.5 w-5 h-5 flex items-center justify-center rounded-full bg-gray-700 hover:bg-red-600 text-xs transition-colors cursor-pointer z-10"},"  ",8,Bg),A.type==="audio"?(Y(),X(ht,{key:0},[m[51]||(m[51]=x("span",{class:"text-sm"},"",-1)),x("span",Mg,"Voice  "+et(Gt(A.data.length)),1)],64)):A.type==="image"?(Y(),X(ht,{key:1},[x("img",{src:A.previewUrl,class:"h-12 rounded object-contain"},null,8,Fg),x("span",Kg,et(Gt(A.data.length)),1)],64)):(Y(),X(ht,{key:2},[m[52]||(m[52]=x("span",{class:"text-sm"},"",-1)),x("span",qg,et(A.name),1),x("span",Hg,et(Gt(A.data.length)),1)],64))]))),128))])):dt("",!0),_t.value?(Y(),X("div",Wg,[x("div",Vg,[x("span",null,et(_t.value.text),1),x("span",null,et(_t.value.percent)+"%",1)]),x("div",zg,[x("div",{class:"h-full bg-blue-500 rounded-full transition-[width] duration-300",style:Es({width:_t.value.percent+"%"})},null,4)])])):dt("",!0),ee(E).chunkProgress.value?(Y(),X("div",Jg,[x("div",Gg,[x("span",null,"Receiving file "+et(ee(E).chunkProgress.value.received)+"/"+et(ee(E).chunkProgress.value.total)+"...",1),x("span",null,et(Math.round(ee(E).chunkProgress.value.received/ee(E).chunkProgress.value.total*100))+"%",1)]),x("div",Yg,[x("div",{class:"h-full bg-emerald-500 rounded-full transition-[width] duration-300",style:Es({width:ee(E).chunkProgress.value.received/ee(E).chunkProgress.value.total*100+"%"})},null,4)])])):dt("",!0),x("div",{class:Lt(["flex items-end gap-2 p-3 border-t border-gray-800 bg-gray-900 shrink-0",At.value?"ring-2 ring-blue-500 ring-inset":""]),onDragover:m[23]||(m[23]=zo(A=>At.value=!0,["prevent"])),onDragleave:m[24]||(m[24]=A=>At.value=!1),onDrop:wt},[x("label",Xg,[m[53]||(m[53]=x("span",{class:"text-lg text-gray-400"},"",-1)),x("input",{type:"file",multiple:"",class:"hidden",onChange:kr},null,32)]),hi(x("textarea",{"onUpdate:modelValue":m[22]||(m[22]=A=>y.value=A),onPaste:Dt,onKeydown:mt,placeholder:"Message...",rows:"1",class:"flex-1 bg-gray-800 border border-gray-700 rounded-2xl px-4 py-2.5 text-sm resize-none max-h-32 focus:outline-none focus:border-blue-500 overflow-y-auto"},null,544),[[_i,y.value]]),x("button",{onClick:Ft,class:Lt(["flex items-center justify-center w-10 h-10 rounded-full transition-colors cursor-pointer shrink-0",me.value?"bg-red-600 hover:bg-red-500":"hover:bg-gray-800"])},[me.value?(Y(),X("span",Zg,et(sr(ge.value)),1)):(Y(),X("span",Qg,""))],2),x("button",{onClick:Mr,disabled:!as.value,class:"flex items-center justify-center w-10 h-10 rounded-full bg-blue-600 hover:bg-blue-500 disabled:bg-gray-700 disabled:text-gray-500 transition-colors cursor-pointer disabled:cursor-not-allowed shrink-0"},[...m[54]||(m[54]=[x("span",{class:"text-sm"},"",-1)])],8,ey)],34)],2),C.value!=="supabase"?(Y(),X("div",ty,[x("div",ry,[x("div",sy,[m[55]||(m[55]=x("h2",{class:"text-sm font-semibold text-blue-400"},"Encrypted output",-1)),x("div",ny,[x("textarea",{readonly:"",value:w.value,placeholder:"Encrypted output will appear here...",class:"flex-1 bg-gray-800 border border-gray-700 rounded-lg p-3 text-xs font-mono resize-none h-24 focus:outline-none"},null,8,iy),x("button",{onClick:m[25]||(m[25]=A=>js(w.value)),disabled:!w.value,class:"px-3 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:text-gray-600 rounded-lg text-sm font-medium transition-colors shrink-0 self-start cursor-pointer disabled:cursor-not-allowed"}," Copy ",8,oy)])]),x("div",ay,[m[60]||(m[60]=x("h2",{class:"text-sm font-semibold text-emerald-400"},"Receive & Decrypt",-1)),x("div",ly,[hi(x("textarea",{"onUpdate:modelValue":m[26]||(m[26]=A=>_.value=A),placeholder:"Paste encrypted message from peer...",class:"flex-1 bg-gray-800 border border-gray-700 rounded-lg p-3 text-xs font-mono resize-none h-24 focus:outline-none focus:border-emerald-500"},null,512),[[_i,_.value]]),x("button",{onClick:m[27]||(m[27]=A=>gn("peerMessage")),class:"px-3 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-medium transition-colors shrink-0 self-start cursor-pointer"}," Paste ")]),x("button",{onClick:Is,disabled:!_.value.trim(),class:"w-full py-2 px-4 bg-emerald-600 hover:bg-emerald-500 disabled:bg-gray-700 disabled:text-gray-500 rounded-lg text-sm font-medium transition-colors cursor-pointer disabled:cursor-not-allowed"}," Decrypt ",8,cy),vt.value?(Y(),X("div",uy,[m[59]||(m[59]=x("label",{class:"block text-xs text-gray-400"},"Decrypted",-1)),vt.value.text?(Y(),X("div",fy,et(vt.value.text),1)):dt("",!0),(Y(!0),X(ht,null,qr(vt.value.attachments,(A,He)=>(Y(),X("div",{key:He,class:"bg-gray-800 border border-gray-700 rounded-lg p-3"},[A.type==="audio"?(Y(),X("div",dy,[x("div",hy,[m[56]||(m[56]=x("div",{class:"flex items-center gap-2"},[x("span",null,""),x("span",{class:"font-medium"},"Voice message")],-1)),x("button",{onClick:be=>Tr(A.blobUrl,A.name||"audio.webm"),class:"text-xs text-gray-400 hover:text-gray-200 cursor-pointer"}," Save",8,py)]),x("audio",{src:A.blobUrl,controls:"",class:"w-full"},null,8,gy)])):A.type==="image"?(Y(),X("div",yy,[x("div",vy,[m[57]||(m[57]=x("div",{class:"flex items-center gap-2"},[x("span",null,""),x("span",{class:"font-medium"},"Image")],-1)),x("button",{onClick:be=>Tr(A.blobUrl,A.name||"image.png"),class:"text-xs text-gray-400 hover:text-gray-200 cursor-pointer"}," Save",8,by)]),x("img",{src:A.blobUrl,class:"max-h-80 rounded-lg object-contain cursor-pointer hover:opacity-90",onClick:be=>ut.value=A.blobUrl},null,8,my)])):(Y(),X("div",_y,[x("div",wy,[m[58]||(m[58]=x("span",null,"",-1)),x("span",xy,et(A.name||"file"),1),x("span",Sy,et(A.size?Gt(A.size):""),1)]),x("button",{onClick:be=>Tr(A.blobUrl,A.name||"file"),class:"text-xs text-gray-400 hover:text-gray-200 cursor-pointer shrink-0 ml-2"}," Save",8,Ey)]))]))),128))])):dt("",!0)]),x("div",ky,[x("span",null,"Sent: "+et(c.value)+"  Received: "+et(f.value),1),x("button",{onClick:Ar,class:"text-red-400 hover:text-red-300 transition-colors cursor-pointer"}," Reset Session ")])])])):dt("",!0)],2))],32))}});Rf(Ty).mount("#app");
